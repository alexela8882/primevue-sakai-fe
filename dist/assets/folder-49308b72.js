import{r as f,J as O,s as R,A as U,z as E,c as d,o as v,d as N,w as _,i as x,f as c,e,t as m,j as k,k as V,n as $,F as q,C as D,_ as G}from"./index-abf1872b.js";import{u as J,U as H}from"./index-212fdf0b.js";const K={class:"flex flex-column gap-3 m-3"},Q={class:"flex align-items-center justify-content-between"},W={class:"flex align-items-center gap-1"},X=e("div",{class:"text-2xl text-primary font-bold"},"Mailbox",-1),Y={class:"font-bold"},Z={class:"p-input-icon-left w-full"},ee=e("i",{class:"pi pi-search"},null,-1),se=["onClick"],te={class:"flex align-items-start justify-content-between gap-6"},oe={class:"flex flex-column gap-1"},ae={class:"font-bold"},le={class:"flex flex-column gap-2"},ne={class:"text-xs text-700"},ie={key:1,class:"p-4 white-space-nowrap overflow-hidden text-overflow-ellipsis"},pe={__name:"folder",setup(ce){const C=D(()=>G(()=>import("./MailboxMessage-6b8af243.js"),["assets/MailboxMessage-6b8af243.js","assets/index-abf1872b.js","assets/index-86c8a9da.css","assets/index-212fdf0b.js"])),h=f(),a=f(),u=f(),l=f(),A=O(),w=J(),{mailFolderLoading:S,getMailFolder:b,getMailFolderMessages:p}=R(w),{fetchMailFolder:F,fetchMailFolderMessages:I}=w,B={auth:{clientId:"393bd73e-ac09-4f31-a723-f4e981a027ce"}},r=new H(B);r.handleRedirectCallback((s,t)=>{});const L=async()=>{var s={scopes:["user.read","mail.send"]};await r.loginPopup(s).then(t=>{g()}).catch(t=>{})},P=s=>{console.log(s),u.value=s},g=async()=>{if(r.getAccount()){var s={scopes:["user.read","mail.send"]};await r.acquireTokenSilent(s).then(t=>{l.value=t.accessToken,console.log(t.accessToken),M()}).catch(t=>{if(t.name==="InteractionRequiredAuthError")return r.acquireTokenPopup(s).then(n=>{l.value=n.accessToken}).catch(n=>{})})}},M=async()=>{await F(l.value,A.params.id),await I(l.value,b.value),p.value.map((s,t)=>{t===0&&(u.value=s)}),a.value=p.value};return U(()=>h.value,(s,t)=>{if(s){let n=p.value.filter(i=>{if(i.subject.toLowerCase().indexOf(s)>-1||i.from.emailAddress.name.toLowerCase().indexOf(s)>-1||i.from.emailAddress.address.toLowerCase().indexOf(s)>-1)return i});a.value=n}else a.value=p.value}),E(async()=>{await g(),l.value||await L(),M()}),(s,t)=>{const n=d("InputText"),i=d("Tag"),T=d("SplitterPanel"),j=d("Splitter"),z=d("BlockUI");return v(),N(z,{blocked:x(S)},{default:_(()=>[c(j,{class:"mb-5"},{default:_(()=>[c(T,{class:"flex",size:5},{default:_(()=>[e("div",null,[e("div",K,[e("div",Q,[e("div",W,[X,e("div",Y,"("+m(x(b).displayName)+")",1)]),e("div",null,[e("i",{onClick:t[0]||(t[0]=o=>g()),class:"cursor-pointer pi pi-refresh"})])]),e("div",null,[e("div",null,[e("span",Z,[ee,c(n,{modelValue:h.value,"onUpdate:modelValue":t[1]||(t[1]=o=>h.value=o),placeholder:"Search",class:"w-full"},null,8,["modelValue"])])])])]),a.value&&a.value.length>0?(v(!0),k(q,{key:0},V(a.value,(o,y)=>(v(),k("div",{key:y,onClick:re=>P(o),class:$(["p-4 cursor-pointer border-1 border-300 border-x-none white-space-nowrap overflow-hidden text-overflow-ellipsis",`${y!==0&&"border-top-none"} ${o.id===u.value.id&&"bg-primary-100"}`])},[e("div",te,[e("div",oe,[e("div",ae,m(o.from.emailAddress.name),1),e("div",null,m(o.subject),1)]),e("div",le,[e("div",ne,m(o.receivedDateTime),1),e("div",null,[c(i,{value:"Sample Tag"})])])])],10,se))),128)):(v(),k("div",ie," No messages found "))])]),_:1}),c(T,{class:"flex",size:75},{default:_(()=>[c(x(C),{token:l.value,message:u.value},null,8,["token","message"])]),_:1})]),_:1})]),_:1},8,["blocked"])}}};export{pe as default};
