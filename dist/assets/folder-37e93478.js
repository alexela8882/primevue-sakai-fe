import{r as m,J as U,s as V,A,z as E,c as f,o as h,d as q,w as x,i as n,f as i,e,t as v,j as b,k as D,n as w,F as G,C as J,_ as H}from"./index-f5812723.js";import{u as K,U as Q}from"./index-32a44eed.js";const W={class:"flex flex-column gap-3 m-3"},X={class:"flex align-items-center justify-content-between"},Y={class:"flex align-items-center gap-1"},Z=e("div",{class:"text-2xl text-primary font-bold"},"Mailbox",-1),ee={class:"font-bold"},te={class:"p-input-icon-left w-full"},le=e("i",{class:"pi pi-search"},null,-1),oe={class:"flex align-items-center gap-3 m-3"},se=["onClick"],ae={class:"flex align-items-start justify-content-between gap-6"},ne={class:"flex flex-column gap-1"},ie={class:"font-bold"},de={class:"flex flex-column gap-2"},ce={key:1,class:"p-4 white-space-nowrap overflow-hidden text-overflow-ellipsis"},re={class:"flex align-items-center gap-3 m-3"},_e={__name:"folder",setup(ue){const T=J(()=>H(()=>import("./MailboxMessage-e5ffe772.js"),["assets/MailboxMessage-e5ffe772.js","assets/index-f5812723.js","assets/index-86c8a9da.css","assets/index-32a44eed.js"])),g=m(),d=m(),_=m(),c=m(),I=U(),M=K(),{mailFolderLoading:S,getMailFolder:r,getMailFolderMessages:s}=V(M),{fetchMailFolder:B,fetchMailFolderMessages:F,folderMailMessagesNavigate:R}=M,$={auth:{clientId:"393bd73e-ac09-4f31-a723-f4e981a027ce"}},p=new Q($);p.handleRedirectCallback((t,l)=>{});const P=async()=>{var t={scopes:["user.read","mail.send"]};await p.loginPopup(t).then(l=>{k()}).catch(l=>{})},j=t=>{console.log(t),_.value=t},k=async()=>{if(p.getAccount()){var t={scopes:["user.read","mail.send"]};await p.acquireTokenSilent(t).then(l=>{c.value=l.accessToken,console.log(l.accessToken),C()}).catch(l=>{if(l.name==="InteractionRequiredAuthError")return p.acquireTokenPopup(t).then(u=>{c.value=u.accessToken}).catch(u=>{})})}},C=async()=>{await B(c.value,I.params.id),await F(c.value,r.value),s.value.value.map((t,l)=>{l===0&&(_.value=t)}),d.value=s.value.value},z=()=>{console.log(s.value["@odata.nextLink"]),R(c.value,s.value["@odata.nextLink"])};return A(()=>g.value,(t,l)=>{if(t){let u=s.value.value.filter(a=>{if(a.subject.toLowerCase().indexOf(t)>-1||a.from.emailAddress.name.toLowerCase().indexOf(t)>-1||a.from.emailAddress.address.toLowerCase().indexOf(t)>-1)return a});d.value=u}else d.value=s.value.value}),A(()=>s.value,(t,l)=>{d.value=t.value}),E(async()=>{await k(),c.value||await P(),C()}),(t,l)=>{const u=f("InputText"),a=f("Button"),y=f("SplitterPanel"),N=f("Splitter"),O=f("BlockUI");return h(),q(O,{blocked:n(S)},{default:x(()=>[i(N,{class:"mb-5"},{default:x(()=>[i(y,{class:"flex",size:5},{default:x(()=>[e("div",null,[e("div",null,[e("div",W,[e("div",X,[e("div",Y,[Z,e("div",ee,"("+v(n(r).displayName)+")",1)]),e("div",null,[e("i",{onClick:l[0]||(l[0]=o=>k()),class:"cursor-pointer pi pi-refresh"})])]),e("div",null,[e("div",null,[e("span",te,[le,i(u,{modelValue:g.value,"onUpdate:modelValue":l[1]||(l[1]=o=>g.value=o),placeholder:"Search",class:"w-full"},null,8,["modelValue"])])])])]),e("div",oe,[e("div",null,"1 - 10 of ("+v(n(r).totalItemCount)+")",1),e("div",null,[i(a,{disabled:!n(r).previousLink,icon:"pi pi-chevron-left",text:"",rounded:""},null,8,["disabled"]),i(a,{onClick:l[2]||(l[2]=o=>z()),disabled:!n(s)["@odata.nextLink"],icon:"pi pi-chevron-right",text:"",rounded:""},null,8,["disabled"])])]),e("div",null,[d.value&&d.value.length>0?(h(!0),b(G,{key:0},D(d.value,(o,L)=>(h(),b("div",{key:L,onClick:ve=>j(o),class:w(["p-4 cursor-pointer border-1 border-300 border-x-none white-space-nowrap overflow-hidden text-overflow-ellipsis",`${L!==0&&"border-top-none"} ${o.id===_.value.id&&"bg-primary-100"}`])},[e("div",ae,[e("div",ne,[e("div",ie,v(o.from.emailAddress.name),1),e("div",{class:w(`${!o.isRead&&"font-bold"}`)},v(o.subject),3)]),e("div",de,[e("div",{class:w(["text-xs text-700",`${!o.isRead&&"font-bold"}`])},v(o.receivedDateTime),3)])])],10,se))),128)):(h(),b("div",ce," No messages found "))]),e("div",re,[e("div",null,"1 - 10 of ("+v(n(r).totalItemCount)+")",1),e("div",null,[i(a,{disabled:!n(r).previousLink,icon:"pi pi-chevron-left",text:"",rounded:""},null,8,["disabled"]),i(a,{disabled:!n(s)["@odata.nextLink"],icon:"pi pi-chevron-right",text:"",rounded:""},null,8,["disabled"])])])])])]),_:1}),i(y,{class:"flex",size:75},{default:x(()=>[i(n(T),{token:c.value,message:_.value},null,8,["token","message"])]),_:1})]),_:1})]),_:1},8,["blocked"])}}};export{_e as default};
