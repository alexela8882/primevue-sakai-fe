import{r as m,B as X,s as B,E as Y,c as $,o as l,j as t,e as o,F as y,k as g,f as v,ab as Z,i as a,t as F,m as p,n as C,d as T,w as V,S as j,I as ee,J as le}from"./index-c4eb5734.js";import{u as te,c as h,a as L}from"./index.esm-0feae17f.js";import{u as ae}from"./index-f4b41b5b.js";import{T as O}from"./TwoColumnList-e381468b.js";const oe={class:"relative mt-4"},se=o("div",{class:"text-l text-700 font-bold bg-primary-50 p-2 mb-4"},"All required fields",-1),ne={class:"grid"},ie={class:"p-float-label"},ue={key:0,class:"text-red-600"},de=o("h5",null,"Detailed add",-1),re={key:0},ce={class:"text-l text-700 font-bold bg-primary-50 p-2"},me={class:"flex flex-column mt-4"},ve={key:0},pe={key:1},xe={__name:"GeneralForm",props:{tabStyle:String,name:String,module:Object},emits:["update-timeout"],setup(E,{emit:D}){const I=ee(()=>le(()=>import("./SectionFields-44e42fba.js"),["assets/SectionFields-44e42fba.js","assets/index-c4eb5734.js","assets/index-40ff91a8.css","assets/index-f4b41b5b.js"])),M=E,A=D,P=m(!0),_=m({}),r=m({}),q=m([]),N=m([]),c=m([]),{values:be,errors:b,setErrors:_e,setFieldError:R,ErrorBag:fe,defineComponentBinds:z,isSubmitting:ye,setFieldValue:G,handleSubmit:J,meta:S}=te({}),U=X(),H=ae();B(U),B(H);const K=async()=>{(await f()).inner?console.log("error"):console.log("passed")},Q=async()=>{c.value=M.module.fields,c.value.map(e=>Object.assign(e,{...e,data:{value:null}}));const s={};c.value.map(e=>{if(e.rules&&e.rules.required){s[e.uniqueName]=h().label(e.label).required();let n=Object.assign({},{[e.uniqueName]:h().label(e.label).required()});console.log(n)}else s[e.uniqueName]=h().label(e.label).nullable();r.value[e.uniqueName]=z(`${e.uniqueName}`),G(`${e.uniqueName}`,null)}),_.value=s,_.value=L(s),console.log(_.value),N.value=c.value.filter(e=>e.rules&&e.rules.required),L().shape({field_1:h().label("Field 1").required()}),q.value=M.module.panels.filter(e=>e.controllerMethod.includes("@index")),setTimeout(()=>{P.value=!1,A("update-timeout")},100)},f=J((s,e)=>{Object.keys(r.value).forEach((n,d)=>{r.value[n].modelValue!==null&&R(n,null)});try{return _.value.validateSync(s,{abortEarly:!1}),s}catch(n){return n.inner.map(d=>{d.path+"",d.message,e.setFieldError(d.path,d.message)}),n}});return Y(async()=>{await Q()}),(s,e)=>{const n=$("InputText"),d=$("Button");return l(),t("div",oe,[o("div",null,[se,o("div",ne,[(l(!0),t(y,null,g(N.value,(i,k)=>(l(),t("div",{key:k,class:"col-6"},[o("span",ie,[v(n,Z({"onUpdate:modelValue":e[0]||(e[0]=u=>a(f)())},r.value[i.uniqueName],{class:["w-full border-left-3",`${!a(b)[i.uniqueName]&&a(S).touched?"border-green-600":"border-red-600"}`]}),null,16,["class"]),o("label",null,F(i.label),1)]),a(b)[i.uniqueName]?(l(),t("small",ue,F(a(b)[i.uniqueName]),1)):p("",!0)]))),128))])]),de,(l(!0),t(y,null,g(q.value,(i,k)=>(l(),t("div",{key:k,class:"flex flex-column gap-1"},[(l(!0),t(y,null,g(i.sections,(u,w)=>(l(),t("div",{key:w,class:C(`${w!==0&&"mt-4"}`)},[o("div",null,[o("div",null,[u.sectionLabel?(l(),t("div",re,[o("div",ce,F(u.sectionLabel),1)])):p("",!0)]),o("div",me,[i.controllerMethod.indexOf("@index")>-1?(l(),t("div",ve,[u.field_ids.length>0?(l(),T(j,{key:0},{fallback:V(()=>[v(O)]),default:V(()=>[v(a(I),{mode:"edit",source:"Form",fieldIds:u.field_ids,newModuleFields:c.value,moduleValidationInputs:r.value,moduleValidationErrors:a(b),moduleValidationMeta:a(S),onValidateSyncFunc:e[1]||(e[1]=x=>a(f)())},null,8,["fieldIds","newModuleFields","moduleValidationInputs","moduleValidationErrors","moduleValidationMeta"])]),_:2},1024)):p("",!0),u.additional_fields&&u.additional_fields.length>0?(l(),t("div",pe,[(l(!0),t(y,null,g(u.additional_fields,(x,W)=>(l(),t("div",{key:W},[x.ids.length>0?(l(),T(j,{key:0},{fallback:V(()=>[v(O)]),default:V(()=>[v(a(I),{mode:"edit",source:"Form",fieldIds:x.ids,newModuleFields:c.value,moduleValidationInputs:r.value,moduleValidationErrors:a(b),moduleValidationMeta:a(S),onValidateSyncFunc:e[2]||(e[2]=ge=>a(f)())},null,8,["fieldIds","newModuleFields","moduleValidationInputs","moduleValidationErrors","moduleValidationMeta"])]),_:2},1024)):p("",!0)]))),128))])):p("",!0)])):p("",!0)])])],2))),128))]))),128)),o("div",{class:C(["sticky bottom-0 right-0 py-2",`${E.tabStyle==="tab"?"mb-7 pb-7 surface-50":"surface-0"}`])},[v(d,{onClick:K,label:"Save"})],2)])}}};export{xe as default};
