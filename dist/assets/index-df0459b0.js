import{D as B,c as $,o as C,j as M,e as v,f as o,H as k,a as D,r as d,K as E,v as G,s as L,I as l,q as g}from"./index-37e7027c.js";const K={},V={class:"grid"},P={class:"col"},q={class:"col"};function F(i,c){const a=$("Skeleton");return C(),M("div",V,[v("div",P,[o(a,{class:"mb-2",borderRadius:"16px"}),o(a,{width:"10rem",class:"mb-2",borderRadius:"16px"}),o(a,{width:"5rem",borderRadius:"16px",class:"mb-2"}),o(a,{height:"2rem",class:"mb-2",borderRadius:"16px"}),o(a,{class:"w-6",height:"4rem",borderRadius:"16px"})]),v("div",q,[o(a,{class:"mb-2",borderRadius:"16px"}),o(a,{width:"10rem",class:"mb-2",borderRadius:"16px"}),o(a,{width:"5rem",borderRadius:"16px",class:"mb-2"}),o(a,{height:"2rem",class:"mb-2",borderRadius:"16px"}),o(a,{class:"w-6",height:"4rem",borderRadius:"16px"})])])}const W=B(K,[["render",F]]),X=k("moduleDetailStore",()=>{D();const i=d(!0),c=d(!0),a=E(),R=G(),{jsonDbUrl:h}=L(a),{getBaseModule:H,getModule:x}=L(R),u=d({}),n=d([]),m=d([]),w=l(()=>u.value),O=l(()=>{const s=x.value.panels,e=s.map((t,p)=>Object.assign({},{_id:t._id,controllerMethod:t.controllerMethod,entityName:t.entityName,highlight:t.highlight,label:t.label,mutable:t.mutable,panelName:t.panelName,sections:[],tabKey:t.tabKey}));return s.map((t,p)=>{t.sections.filter((r,J)=>{if(r.sectionLabel){let b=Object.assign({},{sectionLabel:r.sectionLabel,row:r.row,field_ids:r.field_ids,additional_fields:[]});e[p].sections.push(b)}else{const b=e[p].sections.slice(-1).pop();let N=Object.assign({},{ids:r.field_ids});b.additional_fields.push(N)}})}),console.log(e),e}),j=l(()=>s=>u.value[s]),f=l(()=>n.value),y=l(()=>n.value.sort((e,t)=>e.panelOrder-t.panelOrder)),I=l(()=>s=>f.value.find(t=>t.cname===s)),_=l(()=>m.value),S=l(()=>m.value.sort((e,t)=>e.panelOrder-t.panelOrder)),T=l(()=>s=>_.value.find(t=>t.cname===s));return{itemLoading:i,relatedListLoading:c,item:u,getItem:w,_getRelatedLists:f,_getRelatedOrderedLists:y,_getRelatedListsByCname:I,getRelatedLists:_,getRelatedOrderedLists:S,getRelatedListsByCname:T,getItemPanels:O,getItemValueByName:j,fetchItem:async s=>{i.value=!0;const e=await g(`${h.value}/${s.name}-item?_id=${s.pageid}`,{method:"GET",headers:{"Content-Type":"application/json"}});e.status===200&&(u.value=e.data&&e.data.length>0?e.data[0]:e.data),i.value=!1},fetchItemRelatedList:async s=>{const e=await g(`${h.value}/${s.moduleName}-related?cname=${s.panelName}`,{method:"GET",headers:{"Content-Type":"application/json"}}).catch(t=>{console.log(t)});e&&e.status===200?e.data&&m.value.push(e.data[0]):m.value=[]},fetchItemRelatedLists:async s=>{c.value=!0;const e=await g(`${h.value}/${s.name}-related`,{method:"GET",headers:{"Content-Type":"application/json"}}).catch(t=>{console.log(t)});e&&e.status===200?n.value=e.data:(console.log("err"),n.value=[]),console.log(n.value),c.value=!1}}});export{W as T,X as u};
