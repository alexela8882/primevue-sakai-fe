import{u as M,r as c,s as P,z as A,c as g,o as r,j as u,e as a,f as h,t as m,w as R,g as C,C as S,_ as B}from"./index-f25c6ab6.js";import{u as E,U as I}from"./index-678329c4.js";const b={class:"flex justify-content-center",style:{height:"60vh !important"}},N={class:"flex flex-column align-items-center justify-content-center text-center mt-n6"},V={key:0},j=a("div",null,"Please wait...",-1),q={key:1},O={__name:"index",setup(F){S(()=>B(()=>import("./mailbox-ed32c677.js"),["assets/mailbox-ed32c677.js","assets/index-f25c6ab6.js","assets/index-d1288d3d.css","assets/index-678329c4.js"]));const v=M(),t=c();c();const i=c(),l=c(),d=E(),{getMailFolders:f,mailFoldersLoading:L}=P(d),{fetchProfile:y,fetchMailFolders:k}=d,x={auth:{clientId:"393bd73e-ac09-4f31-a723-f4e981a027ce"}},s=new I(x);s.handleRedirectCallback((o,e)=>{});const w=async()=>{i.value="Trying to sign you in";var o={scopes:["user.read","mail.send"]};await s.loginPopup(o).then(e=>{p()}).catch(e=>{console.log(e),l.value=e})},p=async()=>{if(s.getAccount()){var o={scopes:["user.read","mail.send"]};await s.acquireTokenSilent(o).then(e=>{t.value=e.accessToken,console.log(e.accessToken),_()}).catch(e=>{if(e.name==="InteractionRequiredAuthError")return s.acquireTokenPopup(o).then(n=>{t.value=n.accessToken}).catch(n=>{console.log(n)});console.log(e)})}},_=async()=>{i.value="Redirecting to your inbox",await y(t.value),await k(t.value),f.value.map(o=>{o.displayName==="Inbox"&&v.push(`/outlook-mail/folder/${o.id}`)})};return A(async()=>{await p(),t.value||await w(),_()}),(o,e)=>{const n=g("ProgressSpinner"),T=g("Button");return r(),u("div",b,[a("div",N,[l.value?(r(),u("div",q,[a("div",null,m(l.value),1),a("div",null,[h(T,{link:""},{default:R(()=>[C("Refresh page to retry")]),_:1})])])):(r(),u("div",V,[h(n),a("div",null,m(i.value),1),j]))])])}}};export{O as default};
