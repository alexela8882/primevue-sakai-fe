import{_ as st,c as b,o as s,j as l,f as n,M as lt,a as Se,O as at,B as Ne,s as M,r as u,v as ee,N as ot,u as it,K as nt,a4 as dt,G as ct,E as rt,e,F as v,k as h,n as ut,t as r,i,m as p,g as xe,w as c,d as y,S as z,I,J as D,a5 as mt}from"./index-c4eb5734.js";import{R as _t}from"./RdBreadCrumbs-375676c4.js";import{D as pt}from"./DataTableLoader-a7637832.js";import{T as we}from"./TwoColumnList-e381468b.js";import{u as vt}from"./index-f4b41b5b.js";import{u as ft}from"./index-f647ee55.js";const gt={};function yt(J,P){const x=b("Skeleton");return s(),l("div",null,[n(x,{class:"mb-2",borderRadius:"16px"}),n(x,{width:"10rem",class:"mb-2",borderRadius:"16px"}),n(x,{width:"5rem",borderRadius:"16px",class:"mb-2"}),n(x,{height:"2rem",class:"mb-2",borderRadius:"16px"}),n(x,{width:"10rem",height:"4rem",borderRadius:"16px"})])}const Le=st(gt,[["render",yt]]),ht=lt("moduleFileStore",()=>{Se();const J=at(),P=Ne();M(J),M(P);const x=u(!1),R=u(!1),O=u(!1),B=u([]),G=u([{categoryValue:0,items:[{id:1,label:"Test 1",date:"Jan 23, 2023",size:"55kb",type:"jpg",selected:!1},{id:2,label:"Test 2",date:"Aug 01, 2023",size:"45kb",type:"jpg",selected:!1},{id:3,label:"Test 3",date:"Nov 23, 2023",size:"100kb",type:"jpg",selected:!1},{id:4,label:"Test 4",date:"Sept 23, 2023",size:"1mb",type:"png",selected:!1},{id:5,label:"Test 5",date:"Jan 06, 2023",size:"2.3mb",type:"jpg",selected:!1},{id:6,label:"Test 6",date:"March 24, 2023",size:"50kb",type:"jpeg",selected:!1},{id:7,label:"Test 7",date:"Nov 23, 2023",size:"1kb",type:"jpeg",selected:!1},{id:8,label:"Test 8",date:"Nov 23, 2023",size:"0kb",type:"png",selected:!1},{id:9,label:"Test 9",date:"Nov 23, 2023",size:"90kb",type:"png",selected:!1},{id:10,label:"Test 10",date:"Nov 23, 2023",size:"1.1mb",type:"jpg",selected:!1},{id:11,label:"Test 11",date:"Nov 23, 2023",size:"1.1mb",type:"jpg",selected:!1},{id:12,label:"Test 12",date:"Dec 23, 2023",size:"1.1mb",type:"jpg",selected:!1}]},{categoryValue:2,items:[{label:"Test 1",date:"Nov 23, 2023",size:"55kb",file_type:"jpg"}]}]),$=u({}),E=ee(()=>B.value),V=ee(()=>G.value),Q=ee(()=>$.value);return{fileLoading:x,fileDialog:R,fileDialogSwitch:O,getModuleFiles:E,getFiles:V,getFile:Q,addModuleFiles:async m=>{m.map(U=>B.value.push(U))}}});const bt={key:0,class:"flex align-items-center justify-content-center",style:{height:"60vh !important"}},kt={key:1},xt={style:{position:"sticky !important",top:"72px","z-index":"2 !important"},class:"bg-white px-5 py-3 mb-5 border-round-xl flex align-items-center justify-content-between shadow-2"},wt={class:"flex"},Lt={key:0,class:"flex flex-column text-md mr-4"},St={key:0},Nt={class:"flex"},Tt={class:"font-semibold text-md"},Mt={key:1},jt={class:"font-semibold text-md"},Ft={key:0,class:"flex flex-column text-md mx-4"},It={key:0,class:"font-semibold text-md"},Dt=["href"],Rt=["href"],Et={class:"grid"},Ct={class:"col-7"},zt={class:"p-3 bg-white border-round-xl shadow-2"},Pt={class:"flex flex-column gap-3"},Ot={key:0},Bt={class:"text-2xl font-bold"},$t={key:0},Vt=e("div",{class:"material-icons cursor-pointer"},"playlist_add",-1),At=[Vt],Ut={class:"flex flex-column px-3 mt-4"},Wt={key:0},qt={key:0},Jt=["id"],Gt=["onClick"],Qt=e("i",{class:"pi pi-eye"},null,-1),Ht={key:1},Kt={key:1},Xt={class:"my-4"},Yt={class:"my-4"},Zt={key:0},es=e("div",{class:"mt-4 text-600"},"No records found",-1),ts=[es],ss={class:"my-4"},ls={class:"col-5"},as={style:{position:"sticky !important",top:"145px !important",height:"75vh !important"},class:"flex flex-column gap-4 overflow-scroll p-1"},os={class:"bg-white border-round-xl shadow-2"},is={class:"p-3"},ns={class:"flex align-items-center justify-content-between"},ds=e("div",{class:"text-xl font-bold text-primary"},"Activity",-1),cs={class:"flex align-items-center gap-4"},rs={class:"flex flex-column gap-1 mb-6"},us=e("div",{class:"text-sm text-900"},null,-1),ms={class:"text-sm text-900 ml-2"},_s={class:"m-0 mt-3"},ps={class:"bg-white border-round-xl shadow-2"},vs={class:"p-3"},fs={class:"flex justify-content-between align-items-center text-xl font-bold text-primary"},gs=e("div",null,"Files",-1),ys={class:"mt-5 flex flex-column gap-2 text-700"},hs=e("div",{class:"text-lg font-bold"},"Upload files",-1),bs=e("div",{class:""},"only .jpg and .png files. 5 MB max file size.",-1),ks={key:0},xs={key:0},ws={class:"border-round border-1 border-orange-300 p-2 flex align-items-center justify-content-between"},Ls={class:"flex align-items-center gap-3"},Ss={href:"javascript: void(0);"},Ns={class:"text-700"},Ts=e("div",{class:"text-orange-500"},"Pending",-1),Ms=["onClick"],js={class:"border-round border-1 border-300 p-2 flex align-items-center justify-content-between"},Fs={class:"flex align-items-center gap-3"},Is={href:"javascript: void(0);"},Ds={class:"text-700"},Rs=["onClick"],Es=e("div",{class:"bg-white border-round-xl shadow-2"},[e("div",{class:"p-3 h-15rem"},[e("div",{class:"text-xl font-bold text-primary"},"Reminders")])],-1),Cs={__name:"ShowDetail",setup(J){const P=I(()=>D(()=>import("./MailboxThreads-f374743b.js"),["assets/MailboxThreads-f374743b.js","assets/index-c4eb5734.js","assets/index-40ff91a8.css","assets/ShowInquiryDetail-d2b44956.css"])),x=I(()=>D(()=>import("./DynamicDataTableMain-06b596a8.js"),["assets/DynamicDataTableMain-06b596a8.js","assets/index-c4eb5734.js","assets/index-40ff91a8.css","assets/Validate-674d7751.js","assets/DynamicDataTableMain-5df8962c.css"])),R=I(()=>D(()=>import("./RelatedListPanel-acf5ad1f.js"),["assets/RelatedListPanel-acf5ad1f.js","assets/index-c4eb5734.js","assets/index-40ff91a8.css","assets/RelatedListPanel-70fb7b80.css"])),O=I(()=>D(()=>import("./SectionFields-44e42fba.js"),["assets/SectionFields-44e42fba.js","assets/index-c4eb5734.js","assets/index-40ff91a8.css","assets/index-f4b41b5b.js"])),B=I(()=>D(()=>import("./UploadFileContent-5e3d80ea.js"),["assets/UploadFileContent-5e3d80ea.js","assets/index-c4eb5734.js","assets/index-40ff91a8.css","assets/RdBreadCrumbs-375676c4.js","assets/RdBreadCrumbs-d49d3125.css","assets/DataTableLoader-a7637832.js","assets/TwoColumnList-e381468b.js","assets/index-f4b41b5b.js","assets/index-f647ee55.js","assets/UploadFileContent-bb5410c6.css"])),G=I(()=>D(()=>import("./QuotePDFPreview-ce409539.js").then(o=>o.Q),["assets/QuotePDFPreview-ce409539.js","assets/index-c4eb5734.js","assets/index-40ff91a8.css","assets/index-f4b41b5b.js","assets/QuotePDFPreview-c8962474.css"])),$=u(),E=u(null),V=u(),Q=Se(),A=u(0),m=ot();it();const U=u(!0),w=u(),S=u(),te=u();u();const se=u(),le=u(),ae=u([]),oe=u([]),H=u([]),ie=new mt,ne=ft(),de=Ne(),ce=vt(),re=ht(),ue=nt(),{fetchActivityLogsByRecord:Te}=ne,{getActivityLogsByRecord:Me}=M(ne),{fetchModule:je,fetchLinkedModuleData:Fe,fetchBaseModule:Ie}=de,{getModule:K,getLinkedModuleData:De,getBaseModule:me,getFieldDetailsById:zs}=M(de),{itemLoading:Re,relatedListLoading:Ps,getItem:Os,_relatedLists:Bs,getRelatedLists:_e,_getRelatedOrderedLists:X,getRelatedListsByCname:L,_getItemPanels:Ee,getItemPanels:Ce,getItemValueByName:N}=M(ce),{fetchItem:ze,fetchItemRelatedList:Pe,fetchItemRelatedLists:Oe}=ce,{fileLoading:$s,fileDialogSwitch:Be,fileDialog:pe,getFiles:Y,getModuleFiles:W}=M(re),{addModuleFiles:$e}=re,{addTab:ve,toggleWindows:Ve}=ue,{getTabs:Z}=M(ue),{transformLookupDisplay:q,checkFieldIfMultipleSelect:Ae}=dt(),Ue=u([{label:`${m.params.name}`,to:`/modules/${m.params.name}/${m.params.id}`},{label:`${m.params.name} details`,to:null}]),We=u([{label:"Options",items:[{label:"Add files",icon:"pi pi-plus",command:()=>{Be.value=!0,pe.value=!0,console.log(pe.value)}}]}]),qe=u([{label:"Select",items:[{label:"Task",icon:"pi pi-calendar",command:async()=>{let o=Object.assign({},{});await ie.getTaskForm().then(d=>o=d);const a=Object.assign({},{icon:"pi pi-calendar",type:"task",form:o});fe(a)}},{label:"Event",icon:"pi pi-book",command:async()=>{let o=Object.assign({},{});await ie.getEventForm().then(d=>o=d);const a=Object.assign({},{icon:"pi pi-book",type:"event",form:o});fe(a)}}]}]),fe=o=>{let a=Object.assign({},{type:"static-form",style:"window",name:`${o.type}-window-sform`,label:`New ${o.type} (${w.value.label})`,icon:o.icon,form:{data:o.form,be_nec:{method:"POST",uri:"/activity-logs"},prevalue:{log_type:o.type,module_id:w.value._id,record_id:m.params.pageid}},expanded:!0,opened:!1,opened_order:null});Z.value.findIndex(k=>k.name===a.name)===-1&&ve(a,!0)},Je=o=>{A.value=o.index},ge=async o=>{const a={moduleName:m.params.name,panelName:o.panelName};await Pe(a)},Ge=o=>{if(o){const a=o.getBoundingClientRect();return a.top>=0&&a.left>=0&&a.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&a.right<=(window.innerWidth||document.documentElement.clientWidth)}},ye=()=>{Ee.value(K.value.panels).map(a=>{const d=document.getElementById(`rl-panel-${a._id}`);Ge(d)&&(console.log(`Element with ${a._id} id is visible`),ge(a))})},Qe=async o=>{const a=o.files,d=[],k=Y.value.length>0?Y.value[Y.value.length-1]:0;a.map(j=>{let T=Object.assign({},{id:k+1,label:j.name,date:Date.now(),size:j.size,type:j.type,selected:!1});d.push(T)}),$e(d),Q.add({severity:"info",summary:"Success",detail:"File Uploaded",life:3e3})},He=o=>{console.log(o)},Ke=o=>{const a=W.value.findIndex(d=>d.id===o.id);W.value.splice(a,1)},Xe=o=>{let a=Object.assign({},{type:"module-form",style:"window",name:`${o.name}-${m.params.pageid}-window-edit-form`,label:`${o.label} Form`,_module:o.name,expanded:!0,opened:!1,opened_order:null});const d=Z.value.findIndex(k=>k.name===a.name);d===-1?ve(a,!0):Ve(Z.value[d])};return ct(_e,(o,a)=>{o&&(se.value=o)}),rt(async()=>{await Ie(m.params.id),await je({moduleName:m.params.name});const o={module:"inquiries",link_field:"record_id",record_id:m.params.pageid};await Fe(o),await ze(m.params),await Te(m.params.pageid);const a=Object.assign({},{id:m.params.id,name:m.params.name,pageid:m.params.pageid,moduleName:m.params.name,base:m.params.pageid,relatedLists:K.value.relatedLists});await Oe(a),U.value=Re.value,w.value=me.value,S.value=K.value,te.value=Ce.value(null),se.value=_e.value,le.value=te.value.filter(d=>d.controllerMethod.includes("@index")),ae.value=X.value.filter(d=>d.entityName==="Contact"||d.entityName==="Unit"),oe.value=X.value.filter(d=>d.entityName==="SalesOpportunity"||d.entityName==="SalesOpportunity"),H.value=X.value.filter(d=>d.entityName==="DefectReport"||d.entityName==="ServiceJob"||d.entityName==="ServiceSchedule"||d.entityName==="BreakdownLog"||d.entityName==="ServiceReport"),E.value=De.value,window.addEventListener("scroll",ye),ye()}),(o,a)=>{const d=b("ProgressSpinner"),k=b("Button"),j=b("Panel"),T=b("TabPanel"),Ye=b("TabView"),Ze=b("Dropdown"),he=b("Menu"),be=b("font-awesome-icon"),ke=b("Image"),et=b("FileUpload");return s(),l("div",null,[n(_t,{bcrumbs:Ue.value},null,8,["bcrumbs"]),U.value?(s(),l("div",bt,[n(d)])):(s(),l("div",kt,[e("div",xt,[e("div",wt,[(s(!0),l(v,null,h(S.value.fields,(t,_)=>(s(),l("div",{key:_},[e("div",{class:ut(`${S.value.fields.length===_+1&&"mr-8"}`)},[t.title?(s(),l("div",Lt,[t.groupWith?(s(),l("div",St,[e("div",null,r(t.groupLabel),1),e("div",Nt,[(s(!0),l(v,null,h(t.groupWith,(f,C)=>(s(),l("div",{key:C},[e("div",Tt,r(i(N)(f))+r(t.fieldGlue===" "?" ":t.fieldGlue),1)]))),128))])])):(s(),l("div",Mt,[e("div",null,r(t.label),1),e("div",jt,r(i(N)(t.name)),1)]))])):p("",!0)],2)]))),128)),(s(!0),l(v,null,h(S.value.fields,(t,_)=>(s(),l("div",{key:_},[t.header?(s(),l("div",Ft,[e("div",null,r(t.label),1),i(N)(t.name)?(s(),l("div",It,[t.field_type.name=="lookupModel"?(s(),l(v,{key:0},[i(Ae)(t.rules)?(s(!0),l(v,{key:0},h(i(N)(t.name),f=>(s(),l("a",{key:f._id,href:i(q)(f,t).link,target:"_blank"},r(i(q)(f,t).label),9,Dt))),128)):(s(),l("a",{key:1,href:i(q)(i(N)(t.name),t).link,target:"_blank"},r(i(q)(i(N)(t.name),t).label),9,Rt))],64)):(s(),l(v,{key:1},[xe(r(i(N)(t.name)),1)],64))])):p("",!0)])):p("",!0)]))),128))]),e("div",null,[n(k,{label:"Edit",size:"large",onClick:a[0]||(a[0]=t=>Xe(i(me))),class:"px-6 border-round-xl"})])]),e("div",Et,[e("div",Ct,[e("div",zt,[n(Ye,{onTabChange:Je},{default:c(()=>[n(T,{header:"Details"},{default:c(()=>[e("div",null,[e("div",Pt,[(s(!0),l(v,null,h(le.value,(t,_)=>(s(),l("div",{key:_,class:"flex flex-column gap-1"},[(s(!0),l(v,null,h(t.sections,(f,C)=>(s(),l("div",{key:C,class:"shadow-1 mt-4"},[n(j,{class:"detail-page-panel"},{header:c(()=>[f.sectionLabel?(s(),l("div",Ot,[e("div",Bt,r(f.sectionLabel),1),i(L)(t.panelName)?(s(),l("div",$t,At)):p("",!0)])):p("",!0)]),default:c(()=>[e("div",Ut,[t.controllerMethod.indexOf("@show")>-1?(s(),l("div",Wt,[i(L)(t.panelName)?(s(),l("div",qt,[i(L)(t.panelName)?(s(),y(z,{key:0},{fallback:c(()=>[n(pt)]),default:c(()=>[(s(),y(i(x),{key:t._id,moduleId:t._id,moduleEntityName:t.entityName,moduleName:i(L)(t.panelName).link,moduleLabel:i(L)(t.panelName).label,fields:i(L)(t.panelName).fields.data,data:i(L)(t.panelName).collection.data,pagination:i(L)(t.panelName).collection.meta,collectionLoading:!1},null,8,["moduleId","moduleEntityName","moduleName","moduleLabel","fields","data","pagination"]))]),_:2},1024)):p("",!0)])):(s(),l("div",{key:1,id:`rl-panel-${t._id}`},[e("div",{onClick:g=>ge(t),class:"flex align-items-center gap-2 cursor-pointer text-700"},[Qt,xe(" View data ")],8,Gt)],8,Jt))])):(s(),l("div",Ht,[f.field_ids&&f.field_ids.length>0?(s(),y(z,{key:0},{fallback:c(()=>[n(we)]),default:c(()=>[n(i(O),{newModuleFields:S.value.fields,fieldIds:f.field_ids},null,8,["newModuleFields","fieldIds"])]),_:2},1024)):p("",!0),f.additional_fields.length>0?(s(),l("div",Kt,[(s(!0),l(v,null,h(f.additional_fields,(g,F)=>(s(),l("div",{key:F},[g.ids&&g.ids.length>0?(s(),y(z,{key:0},{fallback:c(()=>[n(we)]),default:c(()=>[n(i(O),{newModuleFields:S.value.fields,fieldIds:g.ids},null,8,["newModuleFields","fieldIds"])]),_:2},1024)):p("",!0)]))),128))])):p("",!0)]))])]),_:2},1024)]))),128))]))),128)),(s(!0),l(v,null,h(ae.value,(t,_)=>(s(),l("div",{key:_},[e("div",Xt,[(s(),y(i(R),{key:_,relatedList:t},null,8,["relatedList"]))])]))),128))])])]),_:1}),w.value&&w.value.name==="accounts"?(s(),y(T,{key:0,header:"Sales"},{default:c(()=>[e("div",null,[A.value===1?(s(),y(z,{key:0},{fallback:c(()=>[n(Le,{class:"mt-4"})]),default:c(()=>[(s(!0),l(v,null,h(oe.value,(t,_)=>(s(),l("div",{key:_},[e("div",Yt,[(s(),y(i(R),{key:_,relatedList:t},null,8,["relatedList"]))])]))),128))]),_:1})):p("",!0)])]),_:1})):p("",!0),w.value&&w.value.name==="accounts"?(s(),y(T,{key:1,header:"Services"},{default:c(()=>[e("div",null,[H.value.length<=0?(s(),l("div",Zt,ts)):p("",!0),A.value===2?(s(),y(z,{key:1},{fallback:c(()=>[n(Le,{class:"mt-4"})]),default:c(()=>[(s(!0),l(v,null,h(H.value,(t,_)=>(s(),l("div",{key:_},[e("div",ss,[(s(),y(i(R),{key:_,relatedList:t},null,8,["relatedList"]))])]))),128))]),_:1})):p("",!0)])]),_:1})):p("",!0),E.value?(s(),y(T,{key:2,header:"Email"},{default:c(()=>[e("div",null,[n(i(P),{threads:E.value.conversations.slice().reverse()},null,8,["threads"])])]),_:1})):p("",!0),w.value&&w.value.name==="salesquotes"?(s(),y(T,{key:3,header:"Quote PDF"},{default:c(()=>[n(i(G))]),_:1})):p("",!0)]),_:1})])]),e("div",ls,[e("div",as,[e("div",os,[e("div",is,[e("div",ns,[ds,e("div",cs,[n(Ze,{placeholder:"Filters",class:"border-round-xl border-primary w-full md:w-12rem"}),e("div",null,[n(k,{icon:"pi pi-plus",text:"",rounded:"",onClick:a[1]||(a[1]=t=>$.value.toggle(t)),"aria-haspopup":"true","aria-controls":"overlay_menu_activity"}),n(he,{ref_key:"activity_menu",ref:$,id:"overlay_menu_activity",model:qe.value,popup:!0},null,8,["model"])])])])]),e("div",rs,[(s(!0),l(v,null,h(i(Me),(t,_)=>(s(),y(j,{key:_,toggleable:"",collapsed:"",class:"activity-panel"},{header:c(()=>[us]),togglericon:c(()=>[n(be,{icon:"fa-solid fa-caret-down",style:{"font-size":"1.5rem"}})]),icons:c(()=>[e("div",ms,r(t.created_at),1)]),default:c(()=>[e("p",_s,[e("ul",null,[e("li",null,r(t.subject),1),e("li",null,r(t.status),1),e("li",null,r(t.remarks),1),e("li",null,r(t.date),1)])])]),_:2},1024))),128))])]),e("div",ps,[e("div",vs,[e("div",fs,[gs,e("div",null,[e("div",{onClick:a[2]||(a[2]=t=>V.value.toggle(t)),class:"cursor-pointer"},[n(be,{icon:"fa-regular fa-square-caret-down",style:{"font-size":"1.5rem"}})]),n(he,{ref_key:"fileMenu",ref:V,id:"overlay_menu",model:We.value,popup:!0},null,8,["model"])])]),e("div",ys,[hs,bs,e("div",null,[n(et,{name:"demo[]",url:"/api/upload",customUpload:"",onUploader:a[3]||(a[3]=t=>Qe(t)),onError:a[4]||(a[4]=t=>He(t)),multiple:!0,accept:"image/*",maxFileSize:5e6},{empty:c(()=>[i(W).length<=0?(s(),l("p",ks,"Drag and drop files to here to upload.")):p("",!0)]),content:c(({files:t,uploadedFiles:_,removeUploadedFileCallback:f,removeFileCallback:C})=>[t.length>0?(s(),l("div",xs,[(s(!0),l(v,null,h(t,(g,F)=>(s(),l("div",{key:F,class:"mb-2"},[e("div",ws,[e("div",Ls,[n(ke,{src:"/demo/images/galleria/galleria6s.jpg",alt:"dummy-img",width:"50",class:"cursor-pointer"}),e("div",null,[e("a",Ss,r(g.name),1),e("div",Ns,r(Date.now())+" • "+r(g.size)+" • "+r(g.type),1),Ts])]),e("div",{onClick:tt=>C(F),class:"cursor-pointer mr-2"},[n(k,{icon:"pi pi-times",severity:"danger",text:"",rounded:"","aria-label":"Cancel"})],8,Ms)])]))),128))])):p("",!0),(s(!0),l(v,null,h(i(W),(g,F)=>(s(),l("div",{key:F,class:"mb-2"},[e("div",js,[e("div",Fs,[n(ke,{src:"/demo/images/galleria/galleria6s.jpg",alt:"dummy-img",width:"50",class:"cursor-pointer"}),e("div",null,[e("a",Is,r(g.label),1),e("div",Ds,r(g.date)+" • "+r(g.size)+" • "+r(g.type),1)])]),e("div",{onClick:tt=>Ke(g),class:"cursor-pointer mr-2"},[n(k,{icon:"pi pi-times",severity:"danger",text:"",rounded:"","aria-label":"Cancel"})],8,Rs)])]))),128))]),_:1})])])])]),Es])])])])),n(i(B),{module:S.value},null,8,["module"])])}}},Gs=Object.freeze(Object.defineProperty({__proto__:null,default:Cs},Symbol.toStringTag,{value:"Module"}));export{Gs as S,ht as u};
