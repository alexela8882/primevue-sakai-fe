import{H as at,r as q,a as st,K as ct,v as ut,s as De,I as ee}from"./index-954446e7.js";/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ue=function(o,e){return Ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},Ue(o,e)};function Z(o,e){Ue(o,e);function t(){this.constructor=o}o.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var C=function(){return C=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},C.apply(this,arguments)};function oe(o,e,t,r){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function s(h){try{u(r.next(h))}catch(m){a(m)}}function c(h){try{u(r.throw(h))}catch(m){a(m)}}function u(h){h.done?i(h.value):n(h.value).then(s,c)}u((r=r.apply(o,e||[])).next())})}function ne(o,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,n,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(h){return c([u,h])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,n&&(i=u[0]&2?n.return:u[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,u[1])).done)return i;switch(n=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,n=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){t.label=u[1];break}if(u[0]===6&&t.label<i[1]){t.label=i[1],i=u;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(u);break}i[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(o,t)}catch(h){u=[6,h],n=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function j(){for(var o=0,e=0,t=arguments.length;e<t;e++)o+=arguments[e].length;for(var r=Array(o),n=0,e=0;e<t;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,n++)r[n]=i[a];return r}var _=function(){function o(){}return o.createNewGuid=function(){var e=window.crypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,o.decimalToHex(t[0])+o.decimalToHex(t[1])+o.decimalToHex(t[2])+o.decimalToHex(t[3])+"-"+o.decimalToHex(t[4])+o.decimalToHex(t[5])+"-"+o.decimalToHex(t[6])+o.decimalToHex(t[7])+"-"+o.decimalToHex(t[8])+o.decimalToHex(t[9])+"-"+o.decimalToHex(t[10])+o.decimalToHex(t[11])+o.decimalToHex(t[12])+o.decimalToHex(t[13])+o.decimalToHex(t[14])+o.decimalToHex(t[15])}else{for(var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n="0123456789abcdef",i=0,a="",s=0;s<36;s++)r[s]!=="-"&&r[s]!=="4"&&(i=Math.random()*16|0),r[s]==="x"?a+=n[i]:r[s]==="y"?(i&=3,i|=8,a+=n[i]):a+=r[s];return a}},o.isGuid=function(e){var t=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;return t.test(e)},o.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},o.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(r,n){return String.fromCharCode(+("0x"+n))}))},o.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join(""))},o.deserialize=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,i=function(s){return decodeURIComponent(s.replace(r," "))},a={};for(t=n.exec(e);t;)a[i(t[1])]=i(t[2]),t=n.exec(e);return a},o}(),l=function(){function o(){}return Object.defineProperty(o,"libraryName",{get:function(){return"Msal.js"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"claims",{get:function(){return"claims"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"clientId",{get:function(){return"clientId"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"cachePrefix",{get:function(){return"msal"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"scopes",{get:function(){return"scopes"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"upn",{get:function(){return"upn"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"domain_hint",{get:function(){return"domain_hint"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"prompt",{get:function(){return"prompt"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"resourceDelimiter",{get:function(){return"|"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"cacheDelimiter",{get:function(){return"."},enumerable:!1,configurable:!0}),Object.defineProperty(o,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!1,configurable:!0}),Object.defineProperty(o,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!1,configurable:!0}),Object.defineProperty(o,"login",{get:function(){return"LOGIN"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"unknown",{get:function(){return"UNKNOWN"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"ADFS",{get:function(){return"adfs"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"common",{get:function(){return"common"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"openidScope",{get:function(){return"openid"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"profileScope",{get:function(){return"profile"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"oidcScopes",{get:function(){return[this.openidScope,this.profileScope]},enumerable:!1,configurable:!0}),Object.defineProperty(o,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!1,configurable:!0}),Object.defineProperty(o,"inProgress",{get:function(){return"inProgress"},enumerable:!1,configurable:!0}),o._popUpWidth=483,o._popUpHeight=600,o}(),lt="sessionStorage",d;(function(o){o.SCOPE="scope",o.STATE="state",o.ERROR="error",o.ERROR_DESCRIPTION="error_description",o.ACCESS_TOKEN="access_token",o.ID_TOKEN="id_token",o.EXPIRES_IN="expires_in",o.SESSION_STATE="session_state",o.CLIENT_INFO="client_info"})(d||(d={}));var ie={id_token:"id_token",token:"token",id_token_token:"id_token token"},E;(function(o){o.AUTHORITY="authority",o.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",o.SESSION_STATE="session.state",o.STATE_LOGIN="state.login",o.STATE_ACQ_TOKEN="state.acquireToken",o.STATE_RENEW="state.renew",o.NONCE_IDTOKEN="nonce.idtoken",o.LOGIN_REQUEST="login.request",o.RENEW_STATUS="token.renew.status",o.URL_HASH="urlHash",o.INTERACTION_STATUS="interaction.status",o.REDIRECT_REQUEST="redirect_request"})(E||(E={}));var J;(function(o){o.IDTOKEN="idtoken",o.CLIENT_INFO="client.info"})(J||(J={}));var L;(function(o){o.LOGIN_ERROR="login.error",o.ERROR="error",o.ERROR_DESC="error.description"})(L||(L={}));var ht="https://login.microsoftonline.com/common/",dt=ht+"/discovery/instance?api-version=1.1&authorization_endpoint=",Fe=".well-known/openid-configuration",T;(function(o){o.ACCOUNT="account",o.SID="sid",o.LOGIN_HINT="login_hint",o.ORGANIZATIONS="organizations",o.CONSUMERS="consumers",o.ID_TOKEN="id_token",o.ACCOUNT_ID="accountIdentifier",o.HOMEACCOUNT_ID="homeAccountIdentifier"})(T||(T={}));var pt=[T.SID,T.LOGIN_HINT],Le={GET:"GET",POST:"POST"},Ee={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},Ke={ID_TOKEN_FRAME:"msalIdTokenFrame",TOKEN_FRAME:"msalRenewFrame"},Ie={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."},noWindowObjectError:{code:"no_window_object",desc:"No window object available. Details:"}},X=function(o){Z(e,o);function e(t,r){var n=o.call(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n.errorCode=t,n.errorMessage=r,n.name="AuthError",n}return e.createUnexpectedError=function(t){return new e(Ie.unexpectedError.code,Ie.unexpectedError.desc+": "+t)},e.createNoWindowObjectError=function(t){return new e(Ie.noWindowObjectError.code,Ie.noWindowObjectError.desc+" "+t)},e}(Error),S=function(){function o(){}return o.isEmpty=function(e){return typeof e>"u"||!e||e.length===0},o.validateAndParseJsonCacheKey=function(e){try{var t=JSON.parse(e);return t&&typeof t=="object"?t:null}catch{return null}},o}(),p={endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},tokenRenewalError:{code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},invalidIdToken:{code:"invalid_id_token",desc:"Invalid ID token format."},invalidStateError:{code:"invalid_state_error",desc:"Invalid state."},nonceMismatchError:{code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},loginProgressError:{code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},acquireTokenProgressError:{code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},callbackError:{code:"callback_error",desc:"Error occurred in token received callback function."},userLoginRequiredError:{code:"user_login_error",desc:"User login is required. For silent calls, request must contain either sid or login_hint"},userDoesNotExistError:{code:"user_non_existent",desc:"User object does not exist. Please call a login API."},clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoNotPopulatedError:{code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},nullOrEmptyIdToken:{code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},idTokenNotParsed:{code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},tokenEncodingError:{code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},invalidInteractionType:{code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},cacheParseError:{code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"},blockTokenRequestsInHiddenIframe:{code:"block_token_requests",desc:"Token calls are blocked in hidden iframes"}},b=function(o){Z(e,o);function e(t,r){var n=o.call(this,t,r)||this;return n.name="ClientAuthError",Object.setPrototypeOf(n,e.prototype),n}return e.createEndpointResolutionError=function(t){var r=p.endpointResolutionError.desc;return t&&!S.isEmpty(t)&&(r+=" Details: "+t),new e(p.endpointResolutionError.code,r)},e.createPopupWindowError=function(t){var r=p.popUpWindowError.desc;return t&&!S.isEmpty(t)&&(r+=" Details: "+t),new e(p.popUpWindowError.code,r)},e.createTokenRenewalTimeoutError=function(){return new e(p.tokenRenewalError.code,p.tokenRenewalError.desc)},e.createInvalidIdTokenError=function(t){return new e(p.invalidIdToken.code,p.invalidIdToken.desc+" Given token: "+t)},e.createInvalidStateError=function(t,r){return new e(p.invalidStateError.code,p.invalidStateError.desc+" "+t+", state expected : "+r+".")},e.createNonceMismatchError=function(t,r){return new e(p.nonceMismatchError.code,p.nonceMismatchError.desc+" "+t+", nonce expected : "+r+".")},e.createLoginInProgressError=function(){return new e(p.loginProgressError.code,p.loginProgressError.desc)},e.createAcquireTokenInProgressError=function(){return new e(p.acquireTokenProgressError.code,p.acquireTokenProgressError.desc)},e.createUserCancelledError=function(){return new e(p.userCancelledError.code,p.userCancelledError.desc)},e.createErrorInCallbackFunction=function(t){return new e(p.callbackError.code,p.callbackError.desc+" "+t+".")},e.createUserLoginRequiredError=function(){return new e(p.userLoginRequiredError.code,p.userLoginRequiredError.desc)},e.createUserDoesNotExistError=function(){return new e(p.userDoesNotExistError.code,p.userDoesNotExistError.desc)},e.createClientInfoDecodingError=function(t){return new e(p.clientInfoDecodingError.code,p.clientInfoDecodingError.desc+" Failed with error: "+t)},e.createClientInfoNotPopulatedError=function(t){return new e(p.clientInfoNotPopulatedError.code,p.clientInfoNotPopulatedError.desc+" Failed with error: "+t)},e.createIdTokenNullOrEmptyError=function(t){return new e(p.nullOrEmptyIdToken.code,p.nullOrEmptyIdToken.desc+" Raw ID Token Value: "+t)},e.createIdTokenParsingError=function(t){return new e(p.idTokenNotParsed.code,p.idTokenNotParsed.desc+" Failed with error: "+t)},e.createTokenEncodingError=function(t){return new e(p.tokenEncodingError.code,p.tokenEncodingError.desc+" Attempted to decode: "+t)},e.createInvalidInteractionTypeError=function(){return new e(p.invalidInteractionType.code,p.invalidInteractionType.desc)},e.createCacheParseError=function(t){var r="invalid key: "+t+", "+p.cacheParseError.desc;return new e(p.cacheParseError.code,r)},e.createBlockTokenRequestsInHiddenIframeError=function(){return new e(p.blockTokenRequestsInHiddenIframe.code,p.blockTokenRequestsInHiddenIframe.desc)},e}(X),g={configurationNotSet:{code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},storageNotSupported:{code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},scopesRequired:{code:"scopes_required",desc:"Scopes are required to obtain an access token."},emptyScopes:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},nonArrayScopes:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},invalidAuthorityType:{code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https."},authorityUriInvalidPath:{code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},unsupportedAuthorityValidation:{code:"unsupported_authority_validation",desc:"The authority validation is not supported for this authority type."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false."},b2cAuthorityUriInvalidPath:{code:"b2c_authority_uri_invalid_path",desc:"The given URI for the B2C authority is invalid."},b2cKnownAuthoritiesNotSet:{code:"b2c_known_authorities_not_set",desc:"Must set known authorities when validateAuthority is set to True and using B2C"},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},emptyRequestError:{code:"empty_request_error",desc:"Request object is required."},invalidCorrelationIdError:{code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},telemetryConfigError:{code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"},ssoSilentError:{code:"sso_silent_error",desc:"request must contain either sid or login_hint"},invalidAuthorityMetadataError:{code:"authority_metadata_error",desc:"Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."}},x=function(o){Z(e,o);function e(t,r){var n=o.call(this,t,r)||this;return n.name="ClientConfigurationError",Object.setPrototypeOf(n,e.prototype),n}return e.createNoSetConfigurationError=function(){return new e(g.configurationNotSet.code,""+g.configurationNotSet.desc)},e.createStorageNotSupportedError=function(t){return new e(g.storageNotSupported.code,g.storageNotSupported.desc+" Given location: "+t)},e.createRedirectCallbacksNotSetError=function(){return new e(g.noRedirectCallbacksSet.code,g.noRedirectCallbacksSet.desc)},e.createInvalidCallbackObjectError=function(t){return new e(g.invalidCallbackObject.code,g.invalidCallbackObject.desc+" Given value for callback function: "+t)},e.createEmptyScopesArrayError=function(t){return new e(g.emptyScopes.code,g.emptyScopes.desc+" Given value: "+t+".")},e.createScopesNonArrayError=function(t){return new e(g.nonArrayScopes.code,g.nonArrayScopes.desc+" Given value: "+t+".")},e.createScopesRequiredError=function(t){return new e(g.scopesRequired.code,g.scopesRequired.desc+" Given value: "+t)},e.createInvalidPromptError=function(t){return new e(g.invalidPrompt.code,g.invalidPrompt.desc+" Given value: "+t)},e.createClaimsRequestParsingError=function(t){return new e(g.claimsRequestParsingError.code,g.claimsRequestParsingError.desc+" Given value: "+t)},e.createEmptyRequestError=function(){var t=g.emptyRequestError,r=t.code,n=t.desc;return new e(r,n)},e.createInvalidCorrelationIdError=function(){return new e(g.invalidCorrelationIdError.code,g.invalidCorrelationIdError.desc)},e.createKnownAuthoritiesNotSetError=function(){return new e(g.b2cKnownAuthoritiesNotSet.code,g.b2cKnownAuthoritiesNotSet.desc)},e.createInvalidAuthorityTypeError=function(){return new e(g.invalidAuthorityType.code,g.invalidAuthorityType.desc)},e.createUntrustedAuthorityError=function(t){return new e(g.untrustedAuthority.code,g.untrustedAuthority.desc+" Provided Authority: "+t)},e.createTelemetryConfigError=function(t){var r=g.telemetryConfigError,n=r.code,i=r.desc,a={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"},s=Object.keys(a).reduce(function(c,u){return t[u]?c:c.concat([u+" ("+a[u]+")"])},[]);return new e(n,i+" mising values: "+s.join(","))},e.createSsoSilentError=function(){return new e(g.ssoSilentError.code,g.ssoSilentError.desc)},e.createInvalidAuthorityMetadataError=function(){return new e(g.invalidAuthorityMetadataError.code,g.invalidAuthorityMetadataError.desc)},e}(b),G=function(){function o(){}return o.isIntersectingScopes=function(e,t){for(var r=this.trimAndConvertArrayToLowerCase(j(e)),n=this.trimAndConvertArrayToLowerCase(j(t)),i=0;i<n.length;i++)if(r.indexOf(n[i].toLowerCase())>-1)return!0;return!1},o.containsScope=function(e,t){var r=this.trimAndConvertArrayToLowerCase(j(e)),n=this.trimAndConvertArrayToLowerCase(j(t));return n.every(function(i){return r.indexOf(i.toString().toLowerCase())>=0})},o.trimAndConvertToLowerCase=function(e){return e.trim().toLowerCase()},o.trimAndConvertArrayToLowerCase=function(e){var t=this;return e.map(function(r){return t.trimAndConvertToLowerCase(r)})},o.trimScopes=function(e){return e.map(function(t){return t.trim()})},o.removeElement=function(e,t){var r=this.trimAndConvertToLowerCase(t);return e.filter(function(n){return n!==r})},o.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},o.validateInputScope=function(e,t){if(!e){if(t)throw x.createScopesRequiredError(e);return}if(!Array.isArray(e))throw x.createScopesNonArrayError(e);if(e.length<1&&t)throw x.createEmptyScopesArrayError(e.toString())},o.getScopeFromState=function(e){if(e){var t=e.indexOf(l.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},o.appendScopes=function(e,t){if(e){var r=t?this.trimAndConvertArrayToLowerCase(j(t)):null,n=this.trimAndConvertArrayToLowerCase(j(e));return r?j(n,r):n}return null},o.onlyContainsOidcScopes=function(e){var t=e.length,r=0;return e.indexOf(l.openidScope)>-1&&(r+=1),e.indexOf(l.profileScope)>-1&&(r+=1),t>0&&t===r},o.containsAnyOidcScopes=function(e){var t=e.indexOf(l.openidScope)>-1,r=e.indexOf(l.profileScope)>-1;return t||r},o.onlyContainsClientId=function(e,t){return!!e&&e.indexOf(t)>-1&&e.length===1},o.appendDefaultScopes=function(e){var t=e;return t.indexOf(l.openidScope)===-1&&t.push(l.openidScope),t.indexOf(l.profileScope)===-1&&t.push(l.profileScope),t},o.removeDefaultScopes=function(e){return e.filter(function(t){return t!==l.openidScope&&t!==l.profileScope})},o.translateClientIdIfSingleScope=function(e,t){return this.onlyContainsClientId(e,t)?l.oidcScopes:e},o}(),v=function(){function o(){}return o.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;r.indexOf("?")<0?r+="?":r+="&";var n=""+r+t.join("&");return n},o.createNavigationUrlString=function(e){var t=G.appendDefaultScopes(e.scopes),r=[];return r.push("response_type="+e.responseType),r.push("scope="+encodeURIComponent(G.parseScope(t))),r.push("client_id="+encodeURIComponent(e.clientId)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),r.push("nonce="+encodeURIComponent(e.nonce)),r.push("client_info=1"),r.push("x-client-SKU="+e.xClientSku),r.push("x-client-Ver="+e.xClientVer),e.promptValue&&r.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&r.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&r.push(e.queryParameters),e.extraQueryParameters&&r.push(e.extraQueryParameters),r.push("client-request-id="+encodeURIComponent(e.correlationId)),r},o.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},o.removeHashFromUrl=function(e){return e.split("#")[0]},o.replaceTenantPath=function(e,t){var r=e.toLowerCase(),n=this.GetUrlComponents(r),i=n.PathSegments;return t&&i.length!==0&&(i[0]===l.common||i[0]===T.ORGANIZATIONS||i[0]===T.CONSUMERS)&&(i[0]=t),this.constructAuthorityUriFromObject(n,i)},o.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},o.isCommonAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return r.length!==0&&r[0]===l.common},o.isOrganizationsAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return r.length!==0&&r[0]===T.ORGANIZATIONS},o.isConsumersAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return r.length!==0&&r[0]===T.CONSUMERS},o.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},i=n.AbsolutePath.split("/");return i=i.filter(function(a){return a&&a.length>0}),n.PathSegments=i,r[6]&&(n.Search=r[6]),r[8]&&(n.Hash=r[8]),n},o.CanonicalizeUri=function(e){if(e){var t=e.toLowerCase();return o.endsWith(t,"/")||(t+="/"),t}return e},o.endsWith=function(e,t){return!e||!t?!1:e.indexOf(t,e.length-t.length)!==-1},o.urlRemoveQueryStringParameter=function(e,t){if(S.isEmpty(e))return e;var r=e,n=new RegExp("(\\&"+t+"=)[^&]+");return r=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),r=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),r=e.replace(n,""),r},o.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):e},o.urlContainsHash=function(e){var t=o.deserializeHash(e);return t.hasOwnProperty(d.ERROR_DESCRIPTION)||t.hasOwnProperty(d.ERROR)||t.hasOwnProperty(d.ACCESS_TOKEN)||t.hasOwnProperty(d.ID_TOKEN)},o.deserializeHash=function(e){var t=o.getHashFromUrl(e);return _.deserialize(t)},o.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0],t},o}(),ft=function(){function o(e,t,r,n,i){this.authority=v.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=_.base64Encode(n)+"."+_.base64Encode(i)}return o}(),gt=function(){function o(e,t,r,n){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=n}return o}(),Se="1.4.18",se=function(){function o(e,t,r,n,i,a,s){this.authorityInstance=e,this.clientId=t,this.nonce=_.createNewGuid(),this.scopes=i?j(i):l.oidcScopes,this.scopes=G.trimScopes(this.scopes),this.state=a,this.correlationId=s,this.xClientSku="MSAL.JS",this.xClientVer=Se,this.responseType=r,this.redirectUri=n}return Object.defineProperty(o.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!1,configurable:!0}),o.prototype.populateQueryParams=function(e,t,r,n){var i={};t&&(t.prompt&&(this.promptValue=t.prompt),t.claimsRequest&&(this.claimsValue=t.claimsRequest),o.isSSOParam(t)&&(i=this.constructUnifiedCacheQueryParameter(t,null))),r&&(i=this.constructUnifiedCacheQueryParameter(null,r)),i=this.addHintParameters(e,i);var a=t?t.extraQueryParameters:null;this.queryParameters=o.generateQueryParametersString(i),this.extraQueryParameters=o.generateQueryParametersString(a,n)},o.prototype.constructUnifiedCacheQueryParameter=function(e,t){var r,n,i,a={};if(e)if(e.account){var s=e.account;!((r=s.idTokenClaims)===null||r===void 0)&&r.login_hint?(n=T.LOGIN_HINT,i=s.idTokenClaims.login_hint):s.sid?(n=T.SID,i=s.sid):s.userName&&(n=T.LOGIN_HINT,i=s.userName)}else e.sid?(n=T.SID,i=e.sid):e.loginHint&&(n=T.LOGIN_HINT,i=e.loginHint);else t&&t.hasOwnProperty(l.upn)&&(n=T.ID_TOKEN,i=t.upn);return a=this.addSSOParameter(n,i),a},o.prototype.addHintParameters=function(e,t){var r,n,i=t;return e&&!i[T.SID]&&!i[T.LOGIN_HINT]&&(!((r=e.idTokenClaims)===null||r===void 0)&&r.login_hint?i=this.addSSOParameter(T.LOGIN_HINT,(n=e.idTokenClaims)===null||n===void 0?void 0:n.login_hint,i):e.sid&&this.promptValue===Ee.NONE?i=this.addSSOParameter(T.SID,e.sid,i):e.userName&&(i=this.addSSOParameter(T.LOGIN_HINT,e.userName,i))),i},o.prototype.addSSOParameter=function(e,t,r){var n=r||{};if(!t)return n;switch(e){case T.SID:{n[T.SID]=t;break}case T.ID_TOKEN:{n[T.LOGIN_HINT]=t;break}case T.LOGIN_HINT:{n[T.LOGIN_HINT]=t;break}}return n},o.generateQueryParametersString=function(e,t){var r=null;return e&&Object.keys(e).forEach(function(n){n===l.domain_hint&&(t||e[T.SID])||(r?r+="&"+n+"="+encodeURIComponent(e[n]):r=n+"="+encodeURIComponent(e[n]))}),r},o.isSSOParam=function(e){return!!(e&&(e.account||e.sid||e.loginHint))},o.determineResponseType=function(e,t){return G.onlyContainsOidcScopes(t)?ie.id_token:e?this.responseTypeForMatchingAccounts(t):ie.id_token_token},o.responseTypeForMatchingAccounts=function(e){return G.containsAnyOidcScopes(e)?ie.id_token_token:ie.token},o}(),Ve=function(){function o(){}return o.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise(function(i,a){var s=new XMLHttpRequest;if(s.open(t,e,!0),s.onload=function(){(s.status<200||s.status>=300)&&a(n.handleError(s.responseText));var c;try{c=JSON.parse(s.responseText)}catch{a(n.handleError(s.responseText))}var u={statusCode:s.status,body:c};i(u)},s.onerror=function(){a(s.status)},t===Le.GET)s.send();else throw"not implemented"})},o.prototype.handleError=function(e){var t;try{if(t=JSON.parse(e),t.error)return t.error;throw e}catch{return e}},o}(),be=function(){function o(){}return o.setTrustedAuthoritiesFromConfig=function(e,t){e&&!this.getTrustedHostList().length&&t.forEach(function(r){o.TrustedHostList.push(r.toLowerCase())})},o.getAliases=function(e,t,r){return oe(this,void 0,void 0,function(){var n,i,a,s;return ne(this,function(c){return n=new Ve,i=Le.GET,a=""+dt+e+"oauth2/v2.0/authorize",s=t.createAndStartHttpEvent(r,i,a,"getAliases"),[2,n.sendRequestAsync(a,i,!0).then(function(u){return s.httpResponseStatus=u.statusCode,t.stopEvent(s),u.body.metadata}).catch(function(u){throw s.serverErrorCode=u,t.stopEvent(s),u})]})})},o.setTrustedAuthoritiesFromNetwork=function(e,t,r){return oe(this,void 0,void 0,function(){var n,i;return ne(this,function(a){switch(a.label){case 0:return[4,this.getAliases(e,t,r)];case 1:return n=a.sent(),n.forEach(function(s){var c=s.aliases;c.forEach(function(u){o.TrustedHostList.push(u.toLowerCase())})}),i=v.GetUrlComponents(e).HostNameAndPort,o.getTrustedHostList().length&&!o.IsInTrustedHostList(i)&&o.TrustedHostList.push(i.toLowerCase()),[2]}})})},o.getTrustedHostList=function(){return this.TrustedHostList},o.IsInTrustedHostList=function(e){return this.TrustedHostList.indexOf(e.toLowerCase())>-1},o.TrustedHostList=[],o}(),ue;(function(o){o[o.Default=0]="Default",o[o.Adfs=1]="Adfs"})(ue||(ue={}));var Be=function(){function o(e,t,r){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri(),this.tenantDiscoveryResponse=r}return o.isAdfs=function(e){var t=v.GetUrlComponents(e),r=t.PathSegments;return r.length&&r[0].toLowerCase()===l.ADFS},Object.defineProperty(o.prototype,"AuthorityType",{get:function(){return o.isAdfs(this.canonicalAuthority)?ue.Adfs:ue.Default},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!1,configurable:!0}),o.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(o.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=v.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=v.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.AuthorityType===ue.Adfs?""+this.CanonicalAuthority+Fe:this.CanonicalAuthority+"v2.0/"+Fe},enumerable:!1,configurable:!0}),o.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch{throw g.invalidAuthorityType}if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw g.authorityUriInsecure;if(!e.PathSegments||e.PathSegments.length<1)throw g.authorityUriInvalidPath},o.prototype.DiscoverEndpoints=function(e,t,r){var n=new Ve,i=Le.GET,a=t.createAndStartHttpEvent(r,i,e,"openIdConfigurationEndpoint");return n.sendRequestAsync(e,i,!0).then(function(s){return a.httpResponseStatus=s.statusCode,t.stopEvent(a),{AuthorizationEndpoint:s.body.authorization_endpoint,EndSessionEndpoint:s.body.end_session_endpoint,Issuer:s.body.issuer}}).catch(function(s){throw a.serverErrorCode=s,t.stopEvent(a),s})},o.prototype.resolveEndpointsAsync=function(e,t){return oe(this,void 0,void 0,function(){var r,n,i;return ne(this,function(a){switch(a.label){case 0:return this.IsValidationEnabled?(r=this.canonicalAuthorityUrlComponents.HostNameAndPort,be.getTrustedHostList().length!==0?[3,2]:[4,be.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,e,t)]):[3,3];case 1:a.sent(),a.label=2;case 2:if(!be.IsInTrustedHostList(r))throw x.createUntrustedAuthorityError(r);a.label=3;case 3:return n=this.GetOpenIdConfigurationEndpoint(),i=this,[4,this.DiscoverEndpoints(n,e,t)];case 4:return i.tenantDiscoveryResponse=a.sent(),[2,this.tenantDiscoveryResponse]}})})},o.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},o.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},o}(),de=function(){function o(e,t){if(!e||S.isEmpty(e)){this.uid="",this.utid="";return}try{var r=_.base64Decode(e),n=JSON.parse(r);n&&(n.hasOwnProperty("uid")&&(this.uid=t?o.stripPolicyFromUid(n.uid,t):n.uid),n.hasOwnProperty("utid")&&(this.utid=n.utid))}catch(i){throw b.createClientInfoDecodingError(i)}}return Object.defineProperty(o.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!1,configurable:!0}),o.createClientInfoFromIdToken=function(e,t){var r={uid:e.subject,utid:""};return new o(_.base64Encode(JSON.stringify(r)),t)},o.stripPolicyFromUid=function(e,t){var r=e.split("-"),n=t.split("/").reverse(),i="";return S.isEmpty(n[0])?n.length>1&&(i=n[1]):i=n[0],r[r.length-1]===i?r.slice(0,r.length-1).join("-"):e},o.prototype.encodeClientInfo=function(){var e=JSON.stringify({uid:this.uid,utid:this.utid});return _.base64Encode(e)},o}(),ge=function(){function o(){}return o.parseExpiresIn=function(e){var t=e||"3599";return parseInt(t,10)},o.now=function(){return Math.round(new Date().getTime()/1e3)},o.relativeNowMs=function(){return window.performance.now()},o}(),we=function(){function o(){}return o.decodeJwt=function(e){if(S.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/,r=t.exec(e);if(!r||r.length<4)return null;var n={header:r[1],JWSPayload:r[2],JWSSig:r[3]};return n},o.validateExpirationIsWithinOffset=function(e,t){var r=t||300;return e&&e>ge.now()+r},o.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,n=_.base64Decode(r);return n?JSON.parse(n):null}catch{}return null},o}(),ce=function(){function o(e){if(S.isEmpty(e))throw b.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=we.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")?this.preferredName=this.claims.preferred_username:this.claims.hasOwnProperty("upn")&&(this.preferredName=this.claims.upn),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(t){throw b.createIdTokenParsingError(t)}}return o}(),vt=function(){function o(e,t){this.key=e,this.value=t}return o}(),qe=function(){function o(e){if(!window)throw X.createNoWindowObjectError("Browser storage class could not find window object");var t=typeof window[e]<"u"&&window[e]!==null;if(!t)throw x.createStorageNotSupportedError(e);this.cacheLocation=e}return o.prototype.setItem=function(e,t,r){window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},o.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},o.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},o.prototype.clear=function(){return window[this.cacheLocation].clear()},o.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";if(r){var i=this.getCookieExpirationTime(r);n+="expires="+i+";"}document.cookie=n},o.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var i=r[n];i.charAt(0)===" ";)i=i.substring(1);if(i.indexOf(t)===0)return decodeURIComponent(i.substring(t.length,i.length))}return""},o.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},o.prototype.getCookieExpirationTime=function(e){var t=new Date,r=new Date(t.getTime()+e*24*60*60*1e3);return r.toUTCString()},o}(),Q=function(){function o(){}return o.validateRequest=function(e,t,r,n){if(!t&&!e)throw x.createEmptyRequestError();var i,a;e&&(i=t?G.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,G.validateInputScope(i,!t),i=G.translateClientIdIfSingleScope(i,r),this.validatePromptParameter(e.prompt),a=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var s=this.validateAndGenerateState(e&&e.state,n),c=this.validateAndGenerateCorrelationId(e&&e.correlationId),u=C(C({},e),{extraQueryParameters:a,scopes:i,state:s,correlationId:c});return u},o.validatePromptParameter=function(e){if(e&&[Ee.LOGIN,Ee.SELECT_ACCOUNT,Ee.CONSENT,Ee.NONE].indexOf(e)<0)throw x.createInvalidPromptError(e)},o.validateEQParameters=function(e,t){var r=C({},e);return r?(t&&delete r[l.claims],pt.forEach(function(n){r[n]&&delete r[n]}),r):null},o.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(t){throw x.createClaimsRequestParsingError(t)}},o.validateAndGenerateState=function(e,t){return S.isEmpty(e)?o.generateLibraryState(t):""+o.generateLibraryState(t)+l.resourceDelimiter+e},o.generateLibraryState=function(e){var t={id:_.createNewGuid(),ts:ge.now(),method:e},r=JSON.stringify(t);return _.base64Encode(r)},o.parseLibraryState=function(e){var t=decodeURIComponent(e).split(l.resourceDelimiter)[0];if(_.isGuid(t))return{id:t,ts:ge.now(),method:l.interactionTypeRedirect};try{var r=_.base64Decode(t),n=JSON.parse(r);return n}catch{throw b.createInvalidStateError(e,null)}},o.validateAndGenerateCorrelationId=function(e){if(e&&!_.isGuid(e))throw x.createInvalidCorrelationIdError();return _.isGuid(e)?e:_.createNewGuid()},o.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+l.resourceDelimiter+e.authority},o}(),k=function(o){Z(e,o);function e(t,r,n){var i=o.call(this,r)||this;return i.temporaryCache=new qe(lt),i.clientId=t,i.rollbackEnabled=!0,i.migrateCacheEntries(n),i}return e.prototype.migrateCacheEntries=function(t){var r=this,n=l.cachePrefix+"."+J.IDTOKEN,i=l.cachePrefix+"."+J.CLIENT_INFO,a=l.cachePrefix+"."+L.ERROR,s=l.cachePrefix+"."+L.ERROR_DESC,c=o.prototype.getItem.call(this,n),u;if(c)try{u=new ce(c)}catch{return}if(u&&u.claims&&u.claims.aud===this.clientId){var h=o.prototype.getItem.call(this,i),m=o.prototype.getItem.call(this,a),y=o.prototype.getItem.call(this,s),I=[c,h,m,y],w=[J.IDTOKEN,J.CLIENT_INFO,L.ERROR,L.ERROR_DESC];w.forEach(function(O,H){return r.duplicateCacheEntry(O,I[H],t)})}},e.prototype.duplicateCacheEntry=function(t,r,n){r&&this.setItem(t,r,n)},e.prototype.generateCacheKey=function(t,r){try{return JSON.parse(t),t}catch{return t.indexOf(""+l.cachePrefix)===0||t.indexOf(l.adalIdToken)===0?t:r?l.cachePrefix+"."+this.clientId+"."+t:l.cachePrefix+"."+t}},e.prototype.matchKeyForType=function(t,r,n,i){var a=S.validateAndParseJsonCacheKey(t);if(!a)return null;var s=t.match(r)&&t.match(n),c=!1;switch(i){case d.ACCESS_TOKEN:c=!!t.match(l.scopes);break;case d.ID_TOKEN:c=!t.match(l.scopes);break}return s&&c?a:null},e.prototype.setItem=function(t,r,n){o.prototype.setItem.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&!n&&o.prototype.setItem.call(this,this.generateCacheKey(t,!1),r,n)},e.prototype.getItem=function(t,r){return o.prototype.getItem.call(this,this.generateCacheKey(t,!0),r)},e.prototype.removeItem=function(t){this.temporaryCache.removeItem(this.generateCacheKey(t,!0)),o.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&o.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},e.prototype.setTemporaryItem=function(t,r,n){this.temporaryCache.setItem(this.generateCacheKey(t,!0),r,n)},e.prototype.getTemporaryItem=function(t,r){return this.temporaryCache.getItem(this.generateCacheKey(t,!0),r)},e.prototype.resetCacheItems=function(){var t=window[this.cacheLocation],r;for(r in t)t.hasOwnProperty(r)&&r.indexOf(l.cachePrefix)!==-1&&o.prototype.removeItem.call(this,r)},e.prototype.resetTempCacheItems=function(t){var r=this,n=t&&Q.parseLibraryState(t).id,i=this.tokenRenewalInProgress(t),a=window[this.cacheLocation];n&&!i&&Object.keys(a).forEach(function(s){s.indexOf(n)!==-1&&(r.removeItem(s),o.prototype.clearItemCookie.call(r,s))}),this.setInteractionInProgress(!1),this.removeItem(E.REDIRECT_REQUEST)},e.prototype.setItemCookie=function(t,r,n){o.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&o.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),r,n)},e.prototype.clearItemCookie=function(t){o.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&o.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!1))},e.prototype.getItemCookie=function(t){return o.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},e.prototype.getAllTokensByType=function(t,r,n){var i=this,a=Object.keys(window[this.cacheLocation]).reduce(function(s,c){var u=i.matchKeyForType(c,t,r,n);if(u){var h=i.getItem(c);if(h)try{var m=new vt(u,JSON.parse(h));return s.concat([m])}catch{return s}}return s},[]);return a},e.prototype.getAllAccessTokens=function(t,r){return this.getAllTokensByType(t,r,d.ACCESS_TOKEN)},e.prototype.getAllIdTokens=function(t,r){return this.getAllTokensByType(t,r,d.ID_TOKEN)},e.prototype.getAllTokens=function(t,r){var n=this.getAllAccessTokens(t,r),i=this.getAllIdTokens(t,r);return j(n,i)},e.prototype.isInteractionInProgress=function(t){var r=this.getInteractionInProgress();return t?r===this.clientId:!!r},e.prototype.getInteractionInProgress=function(){return this.getTemporaryItem(this.generateCacheKey(E.INTERACTION_STATUS,!1))},e.prototype.setInteractionInProgress=function(t){if(t){if(this.isInteractionInProgress(!1))throw b.createAcquireTokenInProgressError();this.setTemporaryItem(this.generateCacheKey(E.INTERACTION_STATUS,!1),this.clientId)}else!t&&this.isInteractionInProgress(!0)&&this.removeItem(this.generateCacheKey(E.INTERACTION_STATUS,!1))},e.prototype.tokenRenewalInProgress=function(t){var r=this.getItem(e.generateTemporaryCacheKey(E.RENEW_STATUS,t));return!!(r&&r===l.inProgress)},e.prototype.clearMsalCookie=function(t){var r=this;if(t)this.clearItemCookie(e.generateTemporaryCacheKey(E.NONCE_IDTOKEN,t)),this.clearItemCookie(e.generateTemporaryCacheKey(E.STATE_LOGIN,t)),this.clearItemCookie(e.generateTemporaryCacheKey(E.LOGIN_REQUEST,t)),this.clearItemCookie(e.generateTemporaryCacheKey(E.STATE_ACQ_TOKEN,t));else{var n=document.cookie.split(";");n.forEach(function(i){var a=i.trim().split("=")[0];a.indexOf(l.cachePrefix)>-1&&o.prototype.clearItemCookie.call(r,a)})}},e.generateAcquireTokenAccountKey=function(t,r){var n=Q.parseLibraryState(r).id;return""+E.ACQUIRE_TOKEN_ACCOUNT+l.resourceDelimiter+t+l.resourceDelimiter+n},e.generateAuthorityKey=function(t){return e.generateTemporaryCacheKey(E.AUTHORITY,t)},e.generateTemporaryCacheKey=function(t,r){var n=Q.parseLibraryState(r).id;return""+t+l.resourceDelimiter+n},e}(qe),pe=function(){function o(e,t,r,n,i,a,s){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=n,this.idToken=i,this.idTokenClaims=i,this.sid=a,this.environment=s}return o.createAccount=function(e,t){var r=e.objectId||e.subject,n=t?t.uid:"",i=t?t.utid:"",a;return S.isEmpty(n)||(a=S.isEmpty(i)?_.base64Encode(n):_.base64Encode(n)+"."+_.base64Encode(i)),new o(r,a,e.preferredName,e.name,e.claims,e.sid,e.issuer)},o.compareAccounts=function(e,t){return!e||!t?!1:!!(e.homeAccountIdentifier&&t.homeAccountIdentifier&&e.homeAccountIdentifier===t.homeAccountIdentifier)},o}(),M=function(){function o(){}return o.isInIframe=function(){return window.parent!==window},o.isInPopup=function(){return!!(window.opener&&window.opener!==window)},o.generateFrameName=function(e,t){return""+e+l.resourceDelimiter+t},o.monitorIframeForHash=function(e,t,r,n){return new Promise(function(i,a){var s=ge.relativeNowMs(),c=s+t;n.verbose("monitorWindowForIframe polling started");var u=setInterval(function(){if(ge.relativeNowMs()>c){n.error("monitorIframeForHash unable to find hash in url, timing out"),n.errorPii("monitorIframeForHash polling timed out for url: "+r),clearInterval(u),a(b.createTokenRenewalTimeoutError());return}var h;try{h=e.location.href}catch{}h&&v.urlContainsHash(h)&&(n.verbose("monitorIframeForHash found url in hash"),clearInterval(u),i(e.location.hash))},o.POLLING_INTERVAL_MS)})},o.monitorPopupForHash=function(e,t,r,n){return new Promise(function(i,a){var s=t/o.POLLING_INTERVAL_MS,c=0;n.verbose("monitorWindowForHash polling started");var u=setInterval(function(){if(e.closed){n.error("monitorWindowForHash window closed"),clearInterval(u),a(b.createUserCancelledError());return}var h;try{h=e.location.href}catch{}if(!(!h||h==="about:blank"))if(c++,h&&v.urlContainsHash(h)){n.verbose("monitorPopupForHash found url in hash"),clearInterval(u);var m=e.location.hash;o.clearUrlFragment(e),i(m)}else c>s&&(n.error("monitorPopupForHash unable to find hash in url, timing out"),n.errorPii("monitorPopupForHash polling timed out for url: "+r),clearInterval(u),a(b.createTokenRenewalTimeoutError()))},o.POLLING_INTERVAL_MS)})},o.loadFrame=function(e,t,r,n){var i=this;return n.infoPii("LoadFrame: "+t),new Promise(function(a,s){setTimeout(function(){var c=i.loadFrameSync(e,t,n);if(!c){s("Unable to load iframe with name: "+t);return}a(c)},r)})},o.loadFrameSync=function(e,t,r){var n=o.addHiddenIFrame(t,r);if(n)(n.src===""||n.src==="about:blank")&&(n.src=e,r.infoPii("Frame Name : "+t+" Navigated to: "+e));else return null;return n},o.addHiddenIFrame=function(e,t){if(typeof e>"u")return null;t.info("Add msal iframe to document"),t.infoPii("Add msal frame to document:"+e);var r=document.getElementById(e);if(r)t.verbose("Add msal iframe already exists");else{t.verbose("Add msal iframe does not exist");var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),r=document.getElementsByTagName("body")[0].appendChild(n)}return r},o.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},o.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe"),r=Array.apply(null,Array(t.length)).map(function(n,i){return t.item(i)});return r.filter(function(n){try{return n.contentWindow.location.hash===e}catch{return!1}})[0]},o.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},o.getPopUpWithHash=function(e){return o.getPopups().filter(function(t){try{return t.location.hash===e}catch{return!1}})[0]},o.trackPopup=function(e){o.getPopups().push(e)},o.closePopups=function(){o.getPopups().forEach(function(e){return e.close()})},o.blockReloadInHiddenIframes=function(){if(v.urlContainsHash(window.location.hash)&&o.isInIframe())throw b.createBlockTokenRequestsInHiddenIframeError()},o.checkIfBackButtonIsPressed=function(e){var t=e.getItem(E.REDIRECT_REQUEST);if(t&&!v.urlContainsHash(window.location.hash)){var r=t.split(l.resourceDelimiter);r.shift();var n=r.length>0?r.join(l.resourceDelimiter):null;e.resetTempCacheItems(n)}},o.clearUrlFragment=function(e){e.location.hash="",typeof e.history.replaceState=="function"&&e.history.replaceState(null,null,""+e.location.pathname+e.location.search)},o.POLLING_INTERVAL_MS=50,o}(),Re=function(){function o(){}return o.setResponseIdToken=function(e,t){if(e){if(!t)return e}else return null;var r=Number(t.expiration);return r&&!e.expiresOn&&(e.expiresOn=new Date(r*1e3)),C(C({},e),{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},o.buildAuthResponse=function(e,t,r,n,i,a){switch(r.responseType){case ie.id_token:var s=C(C({},t),{tokenType:d.ID_TOKEN,account:n,scopes:i,accountState:a});return s=o.setResponseIdToken(s,e),s.idToken?s:null;case ie.id_token_token:var c=o.setResponseIdToken(t,e);return c&&c.accessToken&&c.idToken?c:null;case ie.token:var u=o.setResponseIdToken(t,e);return u;default:return null}},o}(),z=function(){function o(){}return o.saveMetadataFromNetwork=function(e,t,r){return oe(this,void 0,void 0,function(){var n;return ne(this,function(i){switch(i.label){case 0:return[4,e.resolveEndpointsAsync(t,r)];case 1:return n=i.sent(),this.metadataMap.set(e.CanonicalAuthority,n),[2,n]}})})},o.getMetadata=function(e){return this.metadataMap.get(e)},o.saveMetadataFromConfig=function(e,t){try{if(t){var r=JSON.parse(t);if(!r.authorization_endpoint||!r.end_session_endpoint||!r.issuer)throw x.createInvalidAuthorityMetadataError();this.metadataMap.set(e,{AuthorizationEndpoint:r.authorization_endpoint,EndSessionEndpoint:r.end_session_endpoint,Issuer:r.issuer})}}catch{throw x.createInvalidAuthorityMetadataError()}},o.CreateInstance=function(e,t,r){return S.isEmpty(e)?null:(r&&this.saveMetadataFromConfig(e,r),new Be(e,t,this.metadataMap.get(e)))},o.metadataMap=new Map,o}(),K;(function(o){o[o.Error=0]="Error",o[o.Warning=1]="Warning",o[o.Info=2]="Info",o[o.Verbose=3]="Verbose"})(K||(K={}));var mt=function(){function o(e,t){t===void 0&&(t={}),this.level=K.Info;var r=t.correlationId,n=r===void 0?"":r,i=t.level,a=i===void 0?K.Info:i,s=t.piiLoggingEnabled,c=s===void 0?!1:s;this.localCallback=e,this.correlationId=n,this.level=a,this.piiLoggingEnabled=c}return o.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var n=new Date().toUTCString(),i;S.isEmpty(this.correlationId)?i=n+":"+Se+"-"+K[e]+(r?"-pii":"")+" "+t:i=n+":"+this.correlationId+"-"+Se+"-"+K[e]+(r?"-pii":"")+" "+t,this.executeCallback(e,i,r)}},o.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},o.prototype.error=function(e){this.logMessage(K.Error,e,!1)},o.prototype.errorPii=function(e){this.logMessage(K.Error,e,!0)},o.prototype.warning=function(e){this.logMessage(K.Warning,e,!1)},o.prototype.warningPii=function(e){this.logMessage(K.Warning,e,!0)},o.prototype.info=function(e){this.logMessage(K.Info,e,!1)},o.prototype.infoPii=function(e){this.logMessage(K.Info,e,!0)},o.prototype.verbose=function(e){this.logMessage(K.Verbose,e,!1)},o.prototype.verbosePii=function(e){this.logMessage(K.Verbose,e,!0)},o.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},o}(),yt=6e3,Et=300,It=500,Tt={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return v.getCurrentUrl()},postLogoutRedirectUri:function(){return v.getCurrentUrl()},navigateToLoginRequestUrl:!0},bt={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},wt={logger:new mt(null),loadFrameTimeout:yt,tokenRenewalOffsetSeconds:Et,navigateFrameWait:It},St={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};function Ct(o){var e=o.auth,t=o.cache,r=t===void 0?{}:t,n=o.system,i=n===void 0?{}:n,a=o.framework,s=a===void 0?{}:a,c={auth:C(C({},Tt),e),cache:C(C({},bt),r),system:C(C({},wt),i),framework:C(C({},St),s)};return c}var _e={serverUnavailable:{code:"server_unavailable",desc:"Server is temporarily unavailable."},unknownServerError:{code:"unknown_server_error"}},Qe=function(o){Z(e,o);function e(t,r){var n=o.call(this,t,r)||this;return n.name="ServerError",Object.setPrototypeOf(n,e.prototype),n}return e.createServerUnavailableError=function(){return new e(_e.serverUnavailable.code,_e.serverUnavailable.desc)},e.createUnknownServerError=function(t){return new e(_e.unknownServerError.code,t)},e}(X),fe={interactionRequired:{code:"interaction_required"},consentRequired:{code:"consent_required"},loginRequired:{code:"login_required"}},Oe=function(o){Z(e,o);function e(t,r){var n=o.call(this,t,r)||this;return n.name="InteractionRequiredAuthError",Object.setPrototypeOf(n,e.prototype),n}return e.isInteractionRequiredError=function(t){var r=[fe.interactionRequired.code,fe.consentRequired.code,fe.loginRequired.code];return t&&r.indexOf(t)>-1},e.createLoginRequiredAuthError=function(t){return new e(fe.loginRequired.code,t)},e.createInteractionRequiredAuthError=function(t){return new e(fe.interactionRequired.code,t)},e.createConsentRequiredAuthError=function(t){return new e(fe.consentRequired.code,t)},e}(Qe);function Te(o){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:o,fromCache:!1}}var kt="msal.",je="event_name",At="start_time",Ge="elapsed_time",ae={MsalCorrelationIdConstStrKey:"Microsoft.MSAL.correlation_id",ApiTelemIdConstStrKey:"msal.api_telem_id",ApiIdConstStrKey:"msal.api_id",BrokerAppConstStrKey:"Microsoft_MSAL_broker_app",CacheEventCountConstStrKey:"Microsoft_MSAL_cache_event_count",HttpEventCountTelemetryBatchKey:"Microsoft_MSAL_http_event_count",IdpConstStrKey:"Microsoft_MSAL_idp",IsSilentTelemetryBatchKey:"",IsSuccessfulConstStrKey:"Microsoft_MSAL_is_successful",ResponseTimeConstStrKey:"Microsoft_MSAL_response_time",TenantIdConstStrKey:"Microsoft_MSAL_tenant_id",UiEventCountTelemetryBatchKey:"Microsoft_MSAL_ui_event_count"},Rt="<tenant>",Me=function(o){var e=v.GetUrlComponents(o);if(Be.isAdfs(o))return o;var t=e.PathSegments;if(t&&t.length>=2){var r=t[1]==="tfp"?2:1;r<t.length&&(t[r]=Rt)}return e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/")},Pe=function(o){return _.base64Encode(o)},f=function(o){return""+kt+(o||"")},Je=function(){return!!(typeof window<"u"&&"performance"in window&&window.performance.mark&&window.performance.measure)},_t=function(o,e,t){Je()&&(window.performance.mark(t),window.performance.measure(o,e,t),window.performance.clearMeasures(o),window.performance.clearMarks(e),window.performance.clearMarks(t))},Ot=function(o){Je()&&window.performance.mark(o)},Pt=function(){function o(e,t,r){var n;this.eventId=_.createNewGuid(),this.label=r,this.event=(n={},n[f(je)]=e,n[f(Ge)]=-1,n[""+ae.MsalCorrelationIdConstStrKey]=t,n)}return o.prototype.setElapsedTime=function(e){this.event[f(Ge)]=e},o.prototype.stop=function(){this.setElapsedTime(+Date.now()-+this.startTimestamp),_t(this.displayName,this.perfStartMark,this.perfEndMark)},o.prototype.start=function(){this.startTimestamp=Date.now(),this.event[f(At)]=this.startTimestamp,Ot(this.perfStartMark)},Object.defineProperty(o.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+ae.MsalCorrelationIdConstStrKey]},set:function(e){this.event[""+ae.MsalCorrelationIdConstStrKey]=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"eventName",{get:function(){return this.event[f(je)]},enumerable:!1,configurable:!0}),o.prototype.get=function(){return C(C({},this.event),{eventId:this.eventId})},Object.defineProperty(o.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!1,configurable:!0}),o}();const xe=Pt;var Nt=function(o){Z(e,o);function e(t,r,n,i){var a=o.call(this,f("default_event"),r,"DefaultEvent")||this;return a.event[f("client_id")]=n,a.event[f("sdk_plaform")]=t.sdk,a.event[f("sdk_version")]=t.sdkVersion,a.event[f("application_name")]=t.applicationName,a.event[f("application_version")]=t.applicationVersion,a.event[f("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,a.event[""+ae.UiEventCountTelemetryBatchKey]=a.getEventCount(f("ui_event"),i),a.event[""+ae.HttpEventCountTelemetryBatchKey]=a.getEventCount(f("http_event"),i),a.event[""+ae.CacheEventCountConstStrKey]=a.getEventCount(f("cache_event"),i),a}return e.prototype.getEventCount=function(t,r){return r[t]?r[t]:0},e}(xe);const Ut=Nt;var te,$={AUTHORITY:f("authority"),AUTHORITY_TYPE:f("authority_type"),PROMPT:f("ui_behavior"),TENANT_ID:f("tenant_id"),USER_ID:f("user_id"),WAS_SUCESSFUL:f("was_successful"),API_ERROR_CODE:f("api_error_code"),LOGIN_HINT:f("login_hint")},re;(function(o){o[o.AcquireTokenRedirect=2001]="AcquireTokenRedirect",o[o.AcquireTokenSilent=2002]="AcquireTokenSilent",o[o.AcquireTokenPopup=2003]="AcquireTokenPopup",o[o.LoginRedirect=2004]="LoginRedirect",o[o.LoginPopup=2005]="LoginPopup",o[o.Logout=2006]="Logout"})(re||(re={}));var V;(function(o){o.AcquireTokenRedirect="AcquireTokenRedirect",o.AcquireTokenSilent="AcquireTokenSilent",o.AcquireTokenPopup="AcquireTokenPopup",o.LoginRedirect="LoginRedirect",o.LoginPopup="LoginPopup",o.Logout="Logout"})(V||(V={}));var Mt=(te={},te[V.AcquireTokenSilent]=re.AcquireTokenSilent,te[V.AcquireTokenPopup]=re.AcquireTokenPopup,te[V.AcquireTokenRedirect]=re.AcquireTokenRedirect,te[V.LoginPopup]=re.LoginPopup,te[V.LoginRedirect]=re.LoginRedirect,te[V.Logout]=re.Logout,te),Lt=function(o){Z(e,o);function e(t,r,n){var i=o.call(this,f("api_event"),t,n)||this;return n&&(i.apiCode=Mt[n],i.apiEventIdentifier=n),i.piiEnabled=r,i}return Object.defineProperty(e.prototype,"apiEventIdentifier",{set:function(t){this.event[ae.ApiTelemIdConstStrKey]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apiCode",{set:function(t){this.event[ae.ApiIdConstStrKey]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authority",{set:function(t){this.event[$.AUTHORITY]=Me(t).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apiErrorCode",{set:function(t){this.event[$.API_ERROR_CODE]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenantId",{set:function(t){this.event[$.TENANT_ID]=this.piiEnabled&&t?Pe(t):null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"accountId",{set:function(t){this.event[$.USER_ID]=this.piiEnabled&&t?Pe(t):null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wasSuccessful",{get:function(){return this.event[$.WAS_SUCESSFUL]===!0},set:function(t){this.event[$.WAS_SUCESSFUL]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loginHint",{set:function(t){this.event[$.LOGIN_HINT]=this.piiEnabled&&t?Pe(t):null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authorityType",{set:function(t){this.event[$.AUTHORITY_TYPE]=t.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"promptType",{set:function(t){this.event[$.PROMPT]=t.toLowerCase()},enumerable:!1,configurable:!0}),e}(xe),W={HTTP_PATH:f("http_path"),USER_AGENT:f("user_agent"),QUERY_PARAMETERS:f("query_parameters"),API_VERSION:f("api_version"),RESPONSE_CODE:f("response_code"),O_AUTH_ERROR_CODE:f("oauth_error_code"),HTTP_METHOD:f("http_method"),REQUEST_ID_HEADER:f("request_id_header"),SPE_INFO:f("spe_info"),SERVER_ERROR_CODE:f("server_error_code"),SERVER_SUB_ERROR_CODE:f("server_sub_error_code"),URL:f("url")},xt=function(o){Z(e,o);function e(t,r){return o.call(this,f("http_event"),t,r)||this}return Object.defineProperty(e.prototype,"url",{set:function(t){var r=Me(t);this.event[W.URL]=r&&r.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"httpPath",{set:function(t){this.event[W.HTTP_PATH]=Me(t).toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userAgent",{set:function(t){this.event[W.USER_AGENT]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"queryParams",{set:function(t){this.event[W.QUERY_PARAMETERS]=se.generateQueryParametersString(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apiVersion",{set:function(t){this.event[W.API_VERSION]=t.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"httpResponseStatus",{set:function(t){this.event[W.RESPONSE_CODE]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oAuthErrorCode",{set:function(t){this.event[W.O_AUTH_ERROR_CODE]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"httpMethod",{set:function(t){this.event[W.HTTP_METHOD]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"requestIdHeader",{set:function(t){this.event[W.REQUEST_ID_HEADER]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"speInfo",{set:function(t){this.event[W.SPE_INFO]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverErrorCode",{set:function(t){this.event[W.SERVER_ERROR_CODE]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverSubErrorCode",{set:function(t){this.event[W.SERVER_SUB_ERROR_CODE]=t},enumerable:!1,configurable:!0}),e}(xe);const Ht=xt;var Dt=function(){function o(e,t,r){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=C({sdk:l.libraryName,sdkVersion:Se,networkInformation:{connectionSpeed:typeof navigator<"u"&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t,this.logger=r}return o.getTelemetrymanagerStub=function(e,t){var r="UnSetStub",n="0.0",i=function(){},a={applicationName:r,applicationVersion:n},s={platform:a,clientId:e};return new this(s,i,t)},o.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},o.prototype.stopEvent=function(e){if(this.logger.verbose("Telemetry Event stopped: "+e.key),!(!this.telemetryEmitter||!this.inProgressEvents[e.key])){e.stop(),this.incrementEventCount(e);var t=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=j(t||[],[e]),delete this.inProgressEvents[e.key]}},o.prototype.flush=function(e){var t=this;if(this.logger.verbose("Flushing telemetry events: "+e),!(!this.telemetryEmitter||!this.completedEvents[e])){var r=this.getOrphanedEvents(e);r.forEach(function(c){return t.incrementEventCount(c)});var n=j(this.completedEvents[e],r);delete this.completedEvents[e];var i=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],!(!n||!n.length)){var a=new Ut(this.telemetryPlatform,e,this.clientId,i),s=j(n,[a]);this.telemetryEmitter(s.map(function(c){return c.get()}))}}},o.prototype.createAndStartApiEvent=function(e,t){var r=new Lt(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(r),r},o.prototype.stopAndFlushApiEvent=function(e,t,r,n){t.wasSuccessful=r,n&&(t.apiErrorCode=n),this.stopEvent(t),this.flush(e)},o.prototype.createAndStartHttpEvent=function(e,t,r,n){var i=new Ht(e,n);return i.url=r,i.httpMethod=t,this.startEvent(i),i},o.prototype.incrementEventCount=function(e){var t,r=e.eventName,n=this.eventCountByCorrelationId[e.telemetryCorrelationId];n?n[r]=n[r]?n[r]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=(t={},t[r]=1,t)},o.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce(function(r,n){if(n.indexOf(e)!==-1){var i=t.inProgressEvents[n];return delete t.inProgressEvents[n],j(r,[i])}return r},[])},o}();const We=Dt;var Ne=function(){function o(){}return o.filterTokenCacheItemsByScope=function(e,t){return e.filter(function(r){var n=r.key.scopes.split(" "),i=G.removeDefaultScopes(t);return i.length===0?G.containsScope(n,t):G.containsScope(n,i)})},o.filterTokenCacheItemsByAuthority=function(e,t){return e.filter(function(r){return v.CanonicalizeUri(r.key.authority)===t})},o.filterTokenCacheItemsByDomain=function(e,t){return e.filter(function(r){var n=v.GetUrlComponents(r.key.authority).HostNameAndPort;return n===t})},o}(),Ft="https://login.microsoftonline.com/common",qt=function(){function o(e){this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=Ct(e),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),be.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),z.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||Ft,this.cacheStorage=new k(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals||(window.activeRenewals={}),window.renewStates||(window.renewStates=[]),window.callbackMappedToRenewStates||(window.callbackMappedToRenewStates={}),window.promiseMappedToRenewStates||(window.promiseMappedToRenewStates={}),window.msal=this;var t=window.location.hash,r=v.urlContainsHash(t);if(M.checkIfBackButtonIsPressed(this.cacheStorage),r&&this.cacheStorage.isInteractionInProgress(!0)){var n=this.getResponseState(t);n.method===l.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(t)}}return Object.defineProperty(o.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=z.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!1,configurable:!0}),o.prototype.getAuthorityInstance=function(){return this.authorityInstance},o.prototype.handleRedirectCallback=function(e,t){if(!e)throw x.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(l.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(l.interactionTypeRedirect,this.redirectResponse)},o.prototype.urlContainsHash=function(e){return this.logger.verbose("UrlContainsHash has been called"),v.urlContainsHash(e)},o.prototype.authResponseHandler=function(e,t,r){if(this.logger.verbose("AuthResponseHandler has been called"),this.cacheStorage.setInteractionInProgress(!1),e===l.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(t)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,t));else if(e===l.interactionTypePopup)this.logger.verbose("Interaction type is popup, resolving"),r(t);else throw b.createInvalidInteractionTypeError()},o.prototype.authErrorHandler=function(e,t,r,n){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.setInteractionInProgress(!1),e===l.interactionTypeRedirect)if(this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback)this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(t,r.accountState);else if(this.authResponseCallback)this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(t,r);else throw this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error"),t;else if(e===l.interactionTypePopup)this.logger.verbose("Interaction type is popup, rejecting"),n(t);else throw b.createInvalidInteractionTypeError()},o.prototype.loginRedirect=function(e){this.logger.verbose("LoginRedirect has been called");var t=Q.validateRequest(e,!0,this.clientId,l.interactionTypeRedirect);this.acquireTokenInteractive(l.interactionTypeRedirect,!0,t,null,null)},o.prototype.acquireTokenRedirect=function(e){this.logger.verbose("AcquireTokenRedirect has been called");var t=Q.validateRequest(e,!1,this.clientId,l.interactionTypeRedirect);this.acquireTokenInteractive(l.interactionTypeRedirect,!1,t,null,null)},o.prototype.loginPopup=function(e){var t=this;this.logger.verbose("LoginPopup has been called");var r=Q.validateRequest(e,!0,this.clientId,l.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,V.LoginPopup);return new Promise(function(i,a){t.acquireTokenInteractive(l.interactionTypePopup,!0,r,i,a)}).then(function(i){return t.logger.verbose("Successfully logged in"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),i}).catch(function(i){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,i.errorCode),i})},o.prototype.acquireTokenPopup=function(e){var t=this;this.logger.verbose("AcquireTokenPopup has been called");var r=Q.validateRequest(e,!1,this.clientId,l.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,V.AcquireTokenPopup);return new Promise(function(i,a){t.acquireTokenInteractive(l.interactionTypePopup,!1,r,i,a)}).then(function(i){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),i}).catch(function(i){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,i.errorCode),i})},o.prototype.acquireTokenInteractive=function(e,t,r,n,i){var a=this;this.logger.verbose("AcquireTokenInteractive has been called"),M.blockReloadInHiddenIframes();try{this.cacheStorage.setInteractionInProgress(!0)}catch{var s=t?b.createLoginInProgressError():b.createAcquireTokenInProgressError(),c=Te(this.getAccountState(r.state));this.cacheStorage.resetTempCacheItems(r.state),this.authErrorHandler(e,s,c,i);return}e===l.interactionTypeRedirect&&this.cacheStorage.setItem(E.REDIRECT_REQUEST,""+l.inProgress+l.resourceDelimiter+r.state);var u;if(r&&r.account&&!t?(u=r.account,this.logger.verbose("Account set from request")):(u=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),!u&&!se.isSSOParam(r))if(t){var h=this.extractADALIdToken();if(h&&!r.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var m=this.buildIDTokenRequest(r);this.silentLogin=!0,this.acquireTokenSilent(m).then(function(y){a.silentLogin=!1,a.logger.info("Unified cache call is successful"),a.authResponseHandler(e,y,n)},function(y){a.silentLogin=!1,a.logger.error("Error occurred during unified cache ATS: "+y),a.acquireTokenHelper(null,e,t,r,n,i)})}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,e,t,r,n,i)}else{this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required");var c=Te(this.getAccountState(r.state));this.cacheStorage.resetTempCacheItems(r.state),this.authErrorHandler(e,b.createUserLoginRequiredError(),c,i);return}else this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(u,e,t,r,n,i)},o.prototype.acquireTokenHelper=function(e,t,r,n,i,a){return oe(this,void 0,void 0,function(){var s,c,u,h,m,y,I,w,O,H,D;return ne(this,function(A){switch(A.label){case 0:this.logger.verbose("AcquireTokenHelper has been called"),this.logger.verbose("Interaction type: "+t+". isLoginCall: "+r),s=n.scopes?n.scopes.join(" ").toLowerCase():l.oidcScopes.join(" "),this.logger.verbosePii("Request signature: "+s),u=n&&n.authority?z.CreateInstance(n.authority,this.config.auth.validateAuthority,n.authorityMetadata):this.authorityInstance,A.label=1;case 1:return A.trys.push([1,11,,12]),u.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,z.saveMetadataFromNetwork(u,this.telemetryManager,n.correlationId)]);case 2:return A.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),A.label=4;case 4:if(m=r?ie.id_token:this.getTokenType(e,n.scopes),y=n.redirectStartPage||window.location.href,c=new se(u,this.clientId,m,this.getRedirectUri(n&&n.redirectUri),n.scopes,n.state,n.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(c,e,r,y),this.logger.verbose("Updating cache entries"),c.populateQueryParams(e,n),this.logger.verbose("Query parameters populated from account"),I=v.createNavigateUrl(c)+l.response_mode_fragment,t===l.interactionTypeRedirect)r?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem(k.generateTemporaryCacheKey(E.STATE_ACQ_TOKEN,n.state),c.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+c.state));else if(t===l.interactionTypePopup)window.renewStates.push(c.state),window.requestType=r?l.login:l.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+c.state),this.registerCallback(c.state,s,i,a);else throw this.logger.verbose("Invalid interaction error. State not cached"),b.createInvalidInteractionTypeError();if(t!==l.interactionTypePopup)return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{h=this.openPopup(I,"msal",l.popUpWidth,l.popUpHeight),M.trackPopup(h)}catch{if(this.logger.info(p.popUpWindowError.code+":"+p.popUpWindowError.desc),this.cacheStorage.setItem(L.ERROR,p.popUpWindowError.code),this.cacheStorage.setItem(L.ERROR_DESC,p.popUpWindowError.desc),a)return a(b.createPopupWindowError()),[2]}if(!h)return[3,8];A.label=5;case 5:return A.trys.push([5,7,,8]),[4,M.monitorPopupForHash(h,this.config.system.loadFrameTimeout,I,this.logger)];case 6:return w=A.sent(),this.handleAuthenticationResponse(w),this.cacheStorage.setInteractionInProgress(!1),this.logger.info("Closing popup window"),this.config.framework.isAngular&&this.broadcast("msal:popUpHashChanged",w),M.closePopups(),[3,8];case 7:return O=A.sent(),a&&a(O),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",O.errorCode+l.resourceDelimiter+O.errorMessage):(this.cacheStorage.setInteractionInProgress(!1),h.close()),[3,8];case 8:return[3,10];case 9:n.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),H=n.onRedirectNavigate(I),H!==!1?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(I)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(I)),A.label=10;case 10:return[3,12];case 11:return D=A.sent(),this.logger.error(D),this.cacheStorage.resetTempCacheItems(n.state),this.authErrorHandler(t,b.createEndpointResolutionError(D.toString),Te(n.state),a),h&&h.close(),[3,12];case 12:return[2]}})})},o.prototype.ssoSilent=function(e){if(this.logger.verbose("ssoSilent has been called"),!e)throw x.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw x.createSsoSilentError();return this.acquireTokenSilent(C(C({},e),{scopes:l.oidcScopes}))},o.prototype.acquireTokenSilent=function(e){var t=this;this.logger.verbose("AcquireTokenSilent has been called");var r=Q.validateRequest(e,!1,this.clientId,l.interactionTypeSilent),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,V.AcquireTokenSilent),i=Q.createRequestSignature(r);return new Promise(function(a,s){return oe(t,void 0,void 0,function(){var c,u,h,m,y,I,w,O,H,D,A;return ne(this,function(F){switch(F.label){case 0:if(M.blockReloadInHiddenIframes(),c=r.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+c),r.account?(u=r.account,this.logger.verbose("Account set from request")):(u=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),h=this.cacheStorage.getItem(l.adalIdToken),!u&&!(r.sid||r.loginHint)&&S.isEmpty(h))return this.logger.info("User login is required"),[2,s(b.createUserLoginRequiredError())];if(m=this.getTokenType(u,r.scopes),this.logger.verbose("Response type: "+m),y=new se(z.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata),this.clientId,m,this.getRedirectUri(r.redirectUri),r.scopes,r.state,r.correlationId),this.logger.verbose("Finished building server authentication request"),se.isSSOParam(r)||u?(y.populateQueryParams(u,r,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):!u&&!S.isEmpty(h)?(I=we.extractIdToken(h),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),y.populateQueryParams(u,null,I,!0)):this.logger.verbose("No additional query parameters added"),w=r.claimsRequest||y.claimsValue,!w&&!r.forceRefresh)try{H=this.getCachedToken(y,u)}catch(le){O=le}return H?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(H.scopes)),a(H),[2,null]):[3,1];case 1:return O?(this.logger.infoPii(O.errorCode+":"+O.errorMessage),s(O),[2,null]):[3,2];case 2:D=void 0,w?D="Skipped cache lookup since claims were given":r.forceRefresh?D="Skipped cache lookup since request.forceRefresh option was set to true":D="No valid token found in cache lookup",this.logger.verbose(D),y.authorityInstance||(y.authorityInstance=r.authority?z.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+y.authority),F.label=3;case 3:return F.trys.push([3,7,,8]),y.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,z.saveMetadataFromNetwork(y.authorityInstance,this.telemetryManager,r.correlationId)]);case 4:return F.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),F.label=6;case 6:return window.activeRenewals[i]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[i],i,a,s)):r.scopes&&G.onlyContainsOidcScopes(r.scopes)?(this.logger.verbose("OpenID Connect scopes only, renewing idToken"),this.silentLogin=!0,this.renewIdToken(i,a,s,u,y)):(this.logger.verbose("Renewing access token"),this.renewToken(i,a,s,u,y)),[3,8];case 7:return A=F.sent(),this.logger.error(A),s(b.createEndpointResolutionError(A.toString())),[2,null];case 8:return[2]}})})}).then(function(a){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),a}).catch(function(a){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,a.errorCode),a})},o.prototype.openPopup=function(e,t,r,n){this.logger.verbose("OpenPopup has been called");try{var i=window.screenLeft?window.screenLeft:window.screenX,a=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,u=s/2-r/2+i,h=c/2-n/2+a,m=window.open(e,t,"width="+r+", height="+n+", top="+h+", left="+u+", scrollbars=yes");if(!m)throw b.createPopupWindowError();return m.focus&&m.focus(),m}catch(y){throw this.cacheStorage.setInteractionInProgress(!1),b.createPopupWindowError(y.toString())}},o.prototype.loadIframeTimeout=function(e,t,r){return oe(this,void 0,void 0,function(){var n,i,a,s,c;return ne(this,function(u){switch(u.label){case 0:return n=window.activeRenewals[r],this.logger.verbosePii("Set loading state to pending for: "+r+":"+n),this.cacheStorage.setItem(k.generateTemporaryCacheKey(E.RENEW_STATUS,n),l.inProgress),this.config.system.navigateFrameWait?[4,M.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return a=u.sent(),[3,3];case 2:a=M.loadFrameSync(e,t,this.logger),u.label=3;case 3:i=a,u.label=4;case 4:return u.trys.push([4,6,,7]),[4,M.monitorIframeForHash(i.contentWindow,this.config.system.loadFrameTimeout,e,this.logger)];case 5:return s=u.sent(),s&&this.handleAuthenticationResponse(s),[3,7];case 6:throw c=u.sent(),this.cacheStorage.getItem(k.generateTemporaryCacheKey(E.RENEW_STATUS,n))===l.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+r+":"+n),n&&window.callbackMappedToRenewStates[n]&&window.callbackMappedToRenewStates[n](null,c),this.cacheStorage.removeItem(k.generateTemporaryCacheKey(E.RENEW_STATUS,n))),M.removeHiddenIframe(i),c;case 7:return M.removeHiddenIframe(i),[2]}})})},o.prototype.navigateWindow=function(e,t){if(e&&!S.isEmpty(e)){var r=t||window,n=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(n),r.location.assign(e)}else throw this.logger.info("Navigate url is empty"),X.createUnexpectedError("Navigate url is empty")},o.prototype.registerCallback=function(e,t,r,n){var i=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:n}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(a,s){delete window.activeRenewals[t];for(var c=0;c<window.promiseMappedToRenewStates[e].length;++c)try{if(s)window.promiseMappedToRenewStates[e][c].reject(s);else if(a)window.promiseMappedToRenewStates[e][c].resolve(a);else throw i.cacheStorage.resetTempCacheItems(e),X.createUnexpectedError("Error and response are both null")}catch(u){i.logger.warning(u)}delete window.promiseMappedToRenewStates[e],delete window.callbackMappedToRenewStates[e]})},o.prototype.logout=function(e){this.logger.verbose("Logout has been called"),this.logoutAsync(e)},o.prototype.logoutAsync=function(e){return oe(this,void 0,void 0,function(){var t,r,n,i,a,s;return ne(this,function(c){switch(c.label){case 0:t=e||_.createNewGuid(),r=this.telemetryManager.createAndStartApiEvent(t,V.Logout),this.clearCache(),this.account=null,c.label=1;case 1:return c.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,z.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,e)]);case 2:return c.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),c.label=4;case 4:return n="client-request-id="+t,i=void 0,this.getPostLogoutRedirectUri()?(i="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(i="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),a=void 0,this.authorityInstance.EndSessionEndpoint?(a=this.authorityInstance.EndSessionEndpoint+"?"+n+i,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(a=this.authority+"oauth2/v2.0/logout?"+n+i,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(t,r,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(a),[3,6];case 5:return s=c.sent(),this.telemetryManager.stopAndFlushApiEvent(t,r,!1,s.errorCode),[3,6];case 6:return[2]}})})},o.prototype.clearCache=function(){this.logger.verbose("Clearing cache"),window.renewStates=[];for(var e=this.cacheStorage.getAllTokens(l.clientId,l.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie(),this.logger.verbose("Cache cleared")},o.prototype.clearCacheForScope=function(e){this.logger.verbose("Clearing access token from cache");for(var t=this.cacheStorage.getAllAccessTokens(l.clientId,l.homeAccountIdentifier),r=0;r<t.length;r++){var n=t[r];n.value.accessToken===e&&(this.cacheStorage.removeItem(JSON.stringify(n.key)),this.logger.verbosePii("Access token removed: "+n.key))}},o.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),v.urlContainsHash(e)},o.prototype.processCallBack=function(e,t,r){this.logger.info("ProcessCallBack has been called. Processing callback from redirect response");var n=t;n||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),n=this.getResponseState(e));var i,a;try{i=this.saveTokenFromHash(e,n)}catch(c){a=c}try{this.cacheStorage.clearMsalCookie(n.state);var s=this.getAccountState(n.state);if(i){if(n.requestType===l.renewToken||i.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+d.ACCESS_TOKEN),i.tokenType=d.ACCESS_TOKEN):n.requestType===l.login&&(this.logger.verbose("Response tokenType set to "+d.ID_TOKEN),i.tokenType=d.ID_TOKEN),!r){this.logger.verbose("Setting redirectResponse"),this.redirectResponse=i;return}}else if(!r){this.logger.verbose("Response is null, setting redirectResponse with state"),this.redirectResponse=Te(s),this.redirectError=a,this.cacheStorage.resetTempCacheItems(n.state);return}this.logger.verbose("Calling callback provided to processCallback"),r(i,a)}catch(c){throw this.logger.error("Error occurred in token received callback function: "+c),b.createErrorInCallbackFunction(c.toString())}},o.prototype.handleAuthenticationResponse=function(e){this.logger.verbose("HandleAuthenticationResponse has been called");var t=e||window.location.hash,r=this.getResponseState(t);this.logger.verbose("Obtained state from response");var n=window.callbackMappedToRenewStates[r.state];this.processCallBack(t,r,n)},o.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),M.clearUrlFragment(window),this.logger.verbose("Window.location.hash cleared");var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");var r=this.cacheStorage.getItem(k.generateTemporaryCacheKey(E.LOGIN_REQUEST,t.state),this.inCookie);if(!r||r==="null"){this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),window.location.assign("/");return}else{this.logger.verbose("Valid login request url obtained from cache");var n=v.removeHashFromUrl(window.location.href),i=v.removeHashFromUrl(r);if(n!==i){this.logger.verbose("Current url is not login request url, navigating"),this.logger.verbosePii("CurrentUrl: "+n+", finalRedirectUrl: "+i),window.location.assign(""+i+e);return}else{this.logger.verbose("Current url matches login request url");var a=v.GetUrlComponents(r);a.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=a.Hash)}}}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(e,t,null)},o.prototype.getResponseState=function(e){this.logger.verbose("GetResponseState has been called");var t=v.deserializeHash(e),r;if(!t)throw X.createUnexpectedError("Hash was not parsed correctly.");if(t.hasOwnProperty(d.STATE)){this.logger.verbose("Hash contains state. Creating stateInfo object");var n=Q.parseLibraryState(t.state);r={requestType:l.unknown,state:t.state,timestamp:n.ts,method:n.method,stateMatch:!1}}else throw X.createUnexpectedError("Hash does not contain state.");if(r.state===this.cacheStorage.getItem(k.generateTemporaryCacheKey(E.STATE_LOGIN,r.state),this.inCookie)||r.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),r.requestType=l.login,r.stateMatch=!0,r;if(r.state===this.cacheStorage.getItem(k.generateTemporaryCacheKey(E.STATE_ACQ_TOKEN,r.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),r.requestType=l.renewToken,r.stateMatch=!0,r;if(!r.stateMatch){this.logger.verbose("State does not match cached state, setting requestType to type from window"),r.requestType=window.requestType;for(var i=window.renewStates,a=0;a<i.length;a++)if(i[a]===r.state){this.logger.verbose("Matching state found for request"),r.stateMatch=!0;break}r.stateMatch||this.logger.verbose("Matching state not found for request")}return r},o.prototype.getCachedToken=function(e,t){this.logger.verbose("GetCachedToken has been called");var r=e.scopes,n=this.getCachedIdToken(e,t),i=this.getCachedAccessToken(e,t,r),a=this.getAccountState(e.state);return Re.buildAuthResponse(n,i,e,t,r,a)},o.prototype.getTokenCacheItemByAuthority=function(e,t,r,n){var i=this,a;return v.isCommonAuthority(e)||v.isOrganizationsAuthority(e)||v.isConsumersAuthority(e)?a=Ne.filterTokenCacheItemsByDomain(t,v.GetUrlComponents(e).HostNameAndPort):a=Ne.filterTokenCacheItemsByAuthority(t,e),a.length===1?a[0]:a.length>1?(this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token."),a.forEach(function(s){i.cacheStorage.removeItem(JSON.stringify(s.key))}),null):(this.logger.verbose("No matching tokens of type "+n+" found"),null)},o.prototype.getCachedIdToken=function(e,t){this.logger.verbose("Getting all cached tokens of type ID Token");var r=this.cacheStorage.getAllIdTokens(this.clientId,t?t.homeAccountIdentifier:null),n=e.authority||this.authority,i=this.getTokenCacheItemByAuthority(n,r,null,d.ID_TOKEN);if(i){this.logger.verbose("Evaluating ID token found");var a=this.evaluateTokenExpiration(i);if(a){this.logger.verbose("ID token expiration is within offset, using ID token found in cache");var s=i.value;return s?this.logger.verbose("ID Token found in cache is valid and unexpired"):this.logger.verbose("ID Token found in cache is invalid"),s?new ce(s.idToken):null}else return this.logger.verbose("Cached ID token is expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(i.key)),null}else return this.logger.verbose("No tokens found"),null},o.prototype.getCachedAccessToken=function(e,t,r){this.logger.verbose("Getting all cached tokens of type Access Token");var n=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null),i=Ne.filterTokenCacheItemsByScope(n,r),a=e.authority||this.authority,s=this.getTokenCacheItemByAuthority(a,i,r,d.ACCESS_TOKEN);if(s){e.authorityInstance=z.CreateInstance(s.key.authority,this.config.auth.validateAuthority),this.logger.verbose("Evaluating access token found");var c=this.evaluateTokenExpiration(s);if(c){this.logger.verbose("Access token expiration is within offset, using access token found in cache");var u=t||this.getAccount();if(!u)throw X.createUnexpectedError("Account should not be null here.");var h=this.getAccountState(e.state),m={uniqueId:"",tenantId:"",tokenType:d.ACCESS_TOKEN,idToken:null,idTokenClaims:null,accessToken:s.value.accessToken,scopes:s.key.scopes.split(" "),expiresOn:new Date(Number(s.value.expiresIn)*1e3),account:u,accountState:h,fromCache:!0};return m}else return this.logger.verbose("Access token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(s.key)),null}else return this.logger.verbose("No matching token found when filtering by scope and authority"),null},o.prototype.evaluateTokenExpiration=function(e){var t=Number(e.value.expiresIn);return we.validateExpirationIsWithinOffset(t,this.config.system.tokenRenewalOffsetSeconds)},o.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var e=this.cacheStorage.getItem(l.adalIdToken);return S.isEmpty(e)?null:we.extractIdToken(e)},o.prototype.renewToken=function(e,t,r,n,i){this.logger.verbose("RenewToken has been called"),this.logger.verbosePii("RenewToken scope and authority: "+e);var a=M.generateFrameName(Ke.TOKEN_FRAME,e);M.addHiddenIFrame(a,this.logger),this.updateCacheEntries(i,n,!1),this.logger.verbosePii("RenewToken expected state: "+i.state);var s=v.urlRemoveQueryStringParameter(v.createNavigateUrl(i),l.prompt)+l.prompt_none+l.response_mode_fragment;window.renewStates.push(i.state),window.requestType=l.renewToken,this.logger.verbose("Set window.renewState and requestType"),this.registerCallback(i.state,e,t,r),this.logger.infoPii("Navigate to: "+s),this.loadIframeTimeout(s,a,e).catch(function(c){return r(c)})},o.prototype.renewIdToken=function(e,t,r,n,i){this.logger.info("RenewIdToken has been called");var a=M.generateFrameName(Ke.ID_TOKEN_FRAME,e);M.addHiddenIFrame(a,this.logger),this.updateCacheEntries(i,n,!1),this.logger.verbose("RenewIdToken expected state: "+i.state);var s=v.urlRemoveQueryStringParameter(v.createNavigateUrl(i),l.prompt)+l.prompt_none+l.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=l.login,this.silentAuthenticationState=i.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=l.renewToken,window.renewStates.push(i.state)),this.registerCallback(i.state,e,t,r),this.logger.infoPii('Navigate to:" '+s),this.loadIframeTimeout(s,a,e).catch(function(c){return r(c)})},o.prototype.saveToken=function(e,t,r,n,i){var a=new ft(t,this.clientId,r,n.uid,n.utid),s=new gt(e.accessToken,e.idToken.rawIdToken,i.toString(),n.encodeClientInfo());return this.cacheStorage.setItem(JSON.stringify(a),JSON.stringify(s)),i?(this.logger.verbose("New expiration set for token"),e.expiresOn=new Date(i*1e3)):this.logger.error("Could not parse expiresIn parameter for access token"),e},o.prototype.saveIdToken=function(e,t,r,n,i){this.logger.verbose("SaveIdToken has been called");var a=C({},e),s;a.scopes=l.oidcScopes,a.accessToken=r[d.ID_TOKEN];var c=Number(i.expiration);return this.logger.verbose("Saving ID token to cache"),this.saveToken(a,t,s,n,c)},o.prototype.saveAccessToken=function(e,t,r,n){this.logger.verbose("SaveAccessToken has been called");var i=C({},e),a=r[d.SCOPE],s=a.split(" "),c=this.cacheStorage.getAllAccessTokens(this.clientId,t);this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");for(var u=0;u<c.length;u++){var h=c[u];if(h.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var m=h.key.scopes.split(" ");G.isIntersectingScopes(m,s)&&this.cacheStorage.removeItem(JSON.stringify(h.key))}}i.accessToken=r[d.ACCESS_TOKEN],i.scopes=s;var y=ge.parseExpiresIn(r[d.EXPIRES_IN]),I=Q.parseLibraryState(r[d.STATE]),w=I.ts+y;return this.logger.verbose("Saving access token to cache"),this.saveToken(i,t,a,n,w)},o.prototype.saveTokenFromHash=function(e,t){this.logger.verbose("SaveTokenFromHash has been called"),this.logger.info("State status: "+t.stateMatch+"; Request type: "+t.requestType);var r={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},n,i=v.deserializeHash(e),a="",s="",c=null;if(i.hasOwnProperty(d.ERROR_DESCRIPTION)||i.hasOwnProperty(d.ERROR)){if(this.logger.verbose("Server returned an error"),this.logger.infoPii("Error : "+i[d.ERROR]+"; Error description: "+i[d.ERROR_DESCRIPTION]),this.cacheStorage.setItem(L.ERROR,i[d.ERROR]),this.cacheStorage.setItem(L.ERROR_DESC,i[d.ERROR_DESCRIPTION]),t.requestType===l.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem(L.LOGIN_ERROR,i[d.ERROR_DESCRIPTION]+":"+i[d.ERROR]),a=k.generateAuthorityKey(t.state)),t.requestType===l.renewToken){this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),a=k.generateAuthorityKey(t.state);var u=this.getAccount(),h=void 0;u&&!S.isEmpty(u.homeAccountIdentifier)?(h=u.homeAccountIdentifier,this.logger.verbose("AccountId is set")):(h=l.no_account,this.logger.verbose("AccountId is set as no_account")),s=k.generateAcquireTokenAccountKey(h,t.state)}var m=i[d.ERROR],y=i[d.ERROR_DESCRIPTION];Oe.isInteractionRequiredError(m)||Oe.isInteractionRequiredError(y)?n=new Oe(i[d.ERROR],i[d.ERROR_DESCRIPTION]):n=new Qe(i[d.ERROR],i[d.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),t.stateMatch){this.logger.info("State is right"),i.hasOwnProperty(d.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem(k.generateTemporaryCacheKey(E.SESSION_STATE,t.state),i[d.SESSION_STATE])),r.accountState=this.getAccountState(t.state);var I=void 0;if(i.hasOwnProperty(d.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),r.accessToken=i[d.ACCESS_TOKEN],i.hasOwnProperty(d.SCOPE)&&(r.scopes=i[d.SCOPE].split(" ")),i.hasOwnProperty(d.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),c=new ce(i[d.ID_TOKEN])):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),c=new ce(this.cacheStorage.getItem(J.IDTOKEN))),r=Re.setResponseIdToken(r,c);var w=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,c);this.logger.verbose("Got authority from cache"),i.hasOwnProperty(d.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),I=new de(i[d.CLIENT_INFO],w)):this.authorityInstance.AuthorityType===ue.Adfs?I=de.createClientInfoFromIdToken(c,w):this.logger.warning("ClientInfo not received in the response from AAD"),r.account=pe.createAccount(c,I),this.logger.verbose("Account object created from response");var O=void 0;r.account&&!S.isEmpty(r.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),O=r.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),O=l.no_account),s=k.generateAcquireTokenAccountKey(O,t.state);var H=k.generateAcquireTokenAccountKey(l.no_account,t.state);this.logger.verbose("AcquireTokenAccountKey generated");var D=this.cacheStorage.getItem(s),A=void 0;S.isEmpty(D)?S.isEmpty(this.cacheStorage.getItem(H))||(this.logger.verbose("No acquireToken account retrieved from cache"),r=this.saveAccessToken(r,w,i,I)):(A=JSON.parse(D),this.logger.verbose("AcquireToken request account retrieved from cache"),r.account&&A&&pe.compareAccounts(r.account,A)?(r=this.saveAccessToken(r,w,i,I),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(i.hasOwnProperty(d.ID_TOKEN)){this.logger.info("Fragment has idToken"),c=new ce(i[d.ID_TOKEN]);var w=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,c);if(r=Re.setResponseIdToken(r,c),i.hasOwnProperty(d.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),I=new de(i[d.CLIENT_INFO],w)):this.authorityInstance.AuthorityType===ue.Adfs?I=de.createClientInfoFromIdToken(c,w):this.logger.warning("ClientInfo not received in the response from AAD"),this.account=pe.createAccount(c,I),r.account=this.account,this.logger.verbose("Account object created from response"),c&&c.nonce){this.logger.verbose("IdToken has nonce");var F=this.cacheStorage.getItem(k.generateTemporaryCacheKey(E.NONCE_IDTOKEN,t.state),this.inCookie);c.nonce!==F?(this.account=null,this.cacheStorage.setItem(L.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+F+",Actual Nonce: "+c.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+F+", Actual Nonce: "+c.nonce),n=b.createNonceMismatchError(F,c.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem(J.IDTOKEN,i[d.ID_TOKEN],this.inCookie),this.cacheStorage.setItem(J.CLIENT_INFO,I.encodeClientInfo(),this.inCookie),this.saveIdToken(r,w,i,I,c))}else this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),a=t.state,s=t.state,this.logger.error("Invalid id_token received in the response"),n=b.createInvalidIdTokenError(c),this.cacheStorage.setItem(L.ERROR,n.errorCode),this.cacheStorage.setItem(L.ERROR_DESC,n.errorMessage)}}else{this.logger.verbose("State mismatch"),a=t.state,s=t.state;var le=this.cacheStorage.getItem(k.generateTemporaryCacheKey(E.STATE_LOGIN,t.state),this.inCookie);this.logger.error("State Mismatch. Expected State: "+le+", Actual State: "+t.state),n=b.createInvalidStateError(t.state,le),this.cacheStorage.setItem(L.ERROR,n.errorCode),this.cacheStorage.setItem(L.ERROR_DESC,n.errorMessage)}if(this.cacheStorage.removeItem(k.generateTemporaryCacheKey(E.RENEW_STATUS,t.state)),this.cacheStorage.resetTempCacheItems(t.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(a,"",-1),this.cacheStorage.clearMsalCookie(t.state)),n)throw n;if(!r)throw X.createUnexpectedError("Response is null");return r},o.prototype.populateAuthority=function(e,t,r,n){this.logger.verbose("PopulateAuthority has been called");var i=k.generateAuthorityKey(e),a=r.getItem(i,t);return S.isEmpty(a)?a:v.replaceTenantPath(a,n.tenantId)},o.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(J.IDTOKEN,this.inCookie),t=this.cacheStorage.getItem(J.CLIENT_INFO,this.inCookie);if(!S.isEmpty(e)&&!S.isEmpty(t)){var r=new ce(e),n=new de(t,"");return this.account=pe.createAccount(r,n),this.account}return null},o.prototype.getAccountState=function(e){if(e){var t=e.indexOf(l.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},o.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(l.clientId,l.homeAccountIdentifier),r=0;r<t.length;r++){var n=new ce(t[r].value.idToken),i=new de(t[r].value.homeAccountIdentifier,""),a=pe.createAccount(n,i);e.push(a)}return this.getUniqueAccounts(e)},o.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],n=0;n<e.length;++n)e[n].homeAccountIdentifier&&t.indexOf(e[n].homeAccountIdentifier)===-1&&(t.push(e[n].homeAccountIdentifier),r.push(e[n]));return r},o.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},o.prototype.getCachedTokenInternal=function(e,t,r,n){var i=t||this.getAccount();if(!i)return null;var a=this.authorityInstance?this.authorityInstance:z.CreateInstance(this.authority,this.config.auth.validateAuthority),s=this.getTokenType(i,e),c=new se(a,this.clientId,s,this.getRedirectUri(),e,r,n);return this.getCachedToken(c,t)},o.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0){for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null}if(this.config.framework.protectedResourceMap.size>0)for(var r=0,n=Array.from(this.config.framework.protectedResourceMap.keys());r<n.length;r++){var i=n[r];if(e.indexOf(i)>-1)return this.config.framework.protectedResourceMap.get(i)}if(e.indexOf("http://")>-1||e.indexOf("https://")>-1){if(v.getHostFromUri(e)===v.getHostFromUri(this.getRedirectUri()))return new Array(this.clientId)}else return new Array(this.clientId);return null},o.prototype.getLoginInProgress=function(){return this.cacheStorage.isInteractionInProgress(!0)},o.prototype.setInteractionInProgress=function(e){this.cacheStorage.setInteractionInProgress(e)},o.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},o.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.isInteractionInProgress(!0)},o.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},o.prototype.getLogger=function(){return this.logger},o.prototype.setLogger=function(e){this.logger=e},o.prototype.getRedirectUri=function(e){return e||(typeof this.config.auth.redirectUri=="function"?this.config.auth.redirectUri():this.config.auth.redirectUri)},o.prototype.getPostLogoutRedirectUri=function(){return typeof this.config.auth.postLogoutRedirectUri=="function"?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},o.prototype.getCurrentConfiguration=function(){if(!this.config)throw x.createNoSetConfigurationError();return this.config},o.prototype.getTokenType=function(e,t){var r=pe.compareAccounts(e,this.getAccount());return se.determineResponseType(r,t)},o.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):l.no_account,n=k.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(n,JSON.stringify(e))},o.prototype.setAuthorityCache=function(e,t){var r=k.generateAuthorityKey(e);this.cacheStorage.setItem(r,v.CanonicalizeUri(t),this.inCookie)},o.prototype.updateCacheEntries=function(e,t,r,n){n&&this.cacheStorage.setItem(k.generateTemporaryCacheKey(E.LOGIN_REQUEST,e.state),n,this.inCookie),r?this.cacheStorage.setItem(k.generateTemporaryCacheKey(E.STATE_LOGIN,e.state),e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(k.generateTemporaryCacheKey(E.NONCE_IDTOKEN,e.state),e.nonce,this.inCookie)},o.prototype.getAccountId=function(e){var t;return S.isEmpty(e.homeAccountIdentifier)?t=l.no_account:t=e.homeAccountIdentifier,t},o.prototype.buildIDTokenRequest=function(e){var t={scopes:l.oidcScopes,authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId};return t},o.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return We.getTelemetrymanagerStub(t,this.logger);var r=e.applicationName,n=e.applicationVersion,i=e.telemetryEmitter;if(!r||!n||!i)throw x.createTelemetryConfigError(e);var a={applicationName:r,applicationVersion:n},s={platform:a,clientId:t};return new We(s,i,this.logger)},o}();const jt=at("outlookMailStore",()=>{const o=q(!1),e=q(!1),t=q(!1),r=q(!1),n=q(!1),i=q(!1),a=st(),s=ct(),c=ut();De(s);const{getCollection:u}=De(c),{fetchModule:h}=c,m=q(),y=q([]),I=q({}),w=q([]),O=q({}),H=q(0),D=q(null),A=ee(()=>H.value),F=ee(()=>D.value),le=ee(()=>m.value),ze=ee(()=>y.value),Ye=ee(()=>I.value),$e=ee(()=>w.value),Xe=ee(()=>O.value),ve=ee(()=>P=>{const R=P.method,N=P.endpoint,U=P.token,Y=P.body;var B=new Headers,he="Bearer "+U;B.append("Authorization",he),B.append("Content-Type","application/json");var Ce={method:R,headers:B,body:Y},ke="https://graph.microsoft.com/v1.0/",me=`${ke}${N}`;console.log(me),console.log(Y);let ye=null;return Y?ye=fetch(me,Ce):ye=fetch(me,Ce).then(Ae=>Ae.text()).then(Ae=>JSON.parse(Ae)),ye}),Ze=async P=>{o.value=!0;const R={method:"GET",endpoint:"me",token:P},N=await ve.value(R);console.log(N),m.value=N,o.value=!1},et=async P=>{e.value=!0;const R={method:"GET",endpoint:"me/mailFolders",token:P},N=await ve.value(R);y.value=N.value,e.value=!1},tt=async(P,R)=>{t.value=!0;const N={method:"GET",endpoint:`me/mailFolders/${R}`,token:P},U=await ve.value(N);U&&(I.value=U,t.value=!1)},rt=async(P,R)=>{r.value=!0;const N={method:"GET",endpoint:`me/mailFolders/${R.id}/messages`,token:P},U=await ve.value(N);if(U.value){const Y=await He(U.value);U.value=Y,w.value=U,r.value=!1,H.value=0}},ot=async P=>{n.value=!0;const R=w.value.find(N=>N.id===P);O.value=R,n.value=!1},nt=async(P,R,N)=>{i.value=!0;const U={message:{toRecipients:R.toRecipients},comment:N},Y={method:"POST",endpoint:`me/mailFolders/${R.parentFolderId}/messages/${R.id}/reply`,token:P,body:JSON.stringify(U)};(await ve.value(Y)).status===202&&(a.add({severity:"success",summary:"Success",detail:"Reply sent!",life:3e3}),i.value=!1)},it=async(P,R)=>{t.value=!0;var N=new Headers,U="Bearer "+P;N.append("Authorization",U),N.append("Content-Type","application/json");var Y={method:"GET",headers:N};let B=null;if(B=await fetch(R,Y).then(he=>he.text()).then(he=>JSON.parse(he)),B){D.value=R;let ke=R.split("24").find(ye=>ye.toLowerCase().indexOf("skip=")>-1).split("=")[1];H.value=ke;const me=await He(B.value);B.value=me,console.log(B),w.value=B,t.value=!1}},He=async P=>{await h("inquiries");const R=u.value.data.map(U=>U.email_id);return P.map(U=>R.includes(U.id)?{...U,convertedToInquiry:!0}:U)};return{profileLoading:o,mailFoldersLoading:e,mailFolderLoading:t,mailFolderMessagesLoading:r,mailFolderMessagesMessageLoading:n,folderMessageReplyLoading:i,getSkipValue:A,getPreviousLink:F,getProfile:le,getMailFolders:ze,getMailFolder:Ye,getMailFolderMessages:$e,getMailFolderMessagesMessage:Xe,fetchProfile:Ze,fetchMailFolder:tt,fetchMailFolders:et,fetchMailFolderMessages:rt,fetchMailFolderMessagesMessage:ot,replyToMailFolderMessagesMessage:nt,folderMailMessagesNavigate:it}});export{qt as U,jt as u};
