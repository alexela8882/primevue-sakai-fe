import{r as p,J,s as H,A as $,z as K,c as f,o as _,j as k,e,t as d,f as n,w as b,d as Q,i,g as W,k as X,n as L,F as Y,C as Z,_ as ee}from"./index-6b199555.js";import{u as te,U as le}from"./index-ecc1839f.js";const se={key:0,class:"flex justify-content-center",style:{height:"60vh !important"}},oe={class:"flex flex-column align-items-center justify-content-center text-center mt-n6"},ne={key:1,class:"flex justify-content-center",style:{height:"60vh !important"}},ae={class:"flex flex-column align-items-center justify-content-center text-center mt-n6"},ie=e("div",null,"Please wait...",-1),re={class:"flex flex-column gap-3 m-3"},ce={class:"flex align-items-center justify-content-between"},de={class:"flex align-items-center gap-1"},ue=e("div",{class:"text-2xl text-primary font-bold"},"Mailbox",-1),ve={class:"font-bold"},pe={class:"p-input-icon-left w-full"},fe=e("i",{class:"pi pi-search"},null,-1),_e={class:"flex align-items-center gap-3 m-3"},me=["onClick"],ge={class:"flex align-items-start justify-content-between gap-6"},he={class:"flex flex-column gap-1"},xe={class:"font-bold"},ke={class:"flex flex-column gap-2"},be={key:1,class:"p-4 white-space-nowrap overflow-hidden text-overflow-ellipsis"},we={class:"flex align-items-center gap-3 m-3"},Se={__name:"folder",setup(ye){const j=Z(()=>ee(()=>import("./MailboxMessage-4ca278e6.js"),["assets/MailboxMessage-4ca278e6.js","assets/index-6b199555.js","assets/index-86c8a9da.css","assets/index-ecc1839f.js"])),u=p(),m=p(),y=p(),v=p(),g=p(),r=p(),B=J(),S=te(),{mailFolderLoading:F,getSkipValue:w,getPreviousLink:M,getMailFolder:h,getMailFolderMessages:c}=H(S),{fetchMailFolder:N,fetchMailFolderMessages:O,folderMailMessagesNavigate:T}=S,V={auth:{clientId:"393bd73e-ac09-4f31-a723-f4e981a027ce"}},x=new le(V);x.handleRedirectCallback((l,t)=>{});const z=async()=>{u.value="Trying to sign you in";var l={scopes:["user.read","mail.send"]};await x.loginPopup(l).then(t=>{C()}).catch(t=>{m.value=t})},E=l=>{console.log(l),g.value=l},C=async()=>{if(u.value="Retrieving your messages",x.getAccount()){var l={scopes:["user.read","mail.send"]};await x.acquireTokenSilent(l).then(t=>{r.value=t.accessToken,P(),u.value=null,m.value=null}).catch(t=>{if(t.name==="InteractionRequiredAuthError")return x.acquireTokenPopup(l).then(s=>{r.value=s.accessToken}).catch(s=>{m.value=s})})}},P=async()=>{u.value="Retrieving your messages",await N(r.value,B.params.id),await O(r.value,h.value),v.value=c.value.value,u.value=null},A=()=>{console.log(c.value["@odata.nextLink"]),T(r.value,c.value["@odata.nextLink"])},U=()=>{if(console.log(w.value),w.value){console.log(M.value);let t=M.value.split("24").find(a=>a.toLowerCase().indexOf("skip=")>-1),s=M.value.replace(t,`skip=${w.value-10}`);T(r.value,s)}};return $(()=>y.value,(l,t)=>{if(l){let s=c.value.value.filter(a=>{if(a.subject.toLowerCase().indexOf(l)>-1||a.from.emailAddress.name.toLowerCase().indexOf(l)>-1||a.from.emailAddress.address.toLowerCase().indexOf(l)>-1)return a});v.value=s}else v.value=c.value.value}),$(()=>c.value,(l,t)=>{v.value=l.value,l.value.map((s,a)=>{a===0&&(g.value=s)})}),K(async()=>{await C(),r.value||await z(),P()}),(l,t)=>{const s=f("Button"),a=f("ProgressSpinner"),q=f("InputText"),I=f("SplitterPanel"),D=f("Splitter"),G=f("BlockUI");return m.value?(_(),k("div",se,[e("div",oe,[e("div",null,d(m.value),1),e("div",null,[n(s,{link:""},{default:b(()=>[W("Refresh page to retry")]),_:1})])])])):u.value?(_(),k("div",ne,[e("div",ae,[n(a),e("div",null,d(u.value),1),ie])])):(_(),Q(G,{key:2,blocked:i(F)},{default:b(()=>[n(D,{class:"mb-5"},{default:b(()=>[n(I,{class:"flex",size:5},{default:b(()=>[e("div",null,[e("div",null,[e("div",re,[e("div",ce,[e("div",de,[ue,e("div",ve,"("+d(i(h).displayName)+")",1)]),e("div",null,[e("i",{onClick:t[0]||(t[0]=o=>C()),class:"cursor-pointer pi pi-refresh"})])]),e("div",null,[e("div",null,[e("span",pe,[fe,n(q,{modelValue:y.value,"onUpdate:modelValue":t[1]||(t[1]=o=>y.value=o),placeholder:"Search",class:"w-full"},null,8,["modelValue"])])])])]),e("div",_e,[e("div",null,"1 - 10 of ("+d(i(h).totalItemCount)+")",1),e("div",null,[n(s,{onClick:t[2]||(t[2]=o=>U()),disabled:i(w)==0,icon:"pi pi-chevron-left",text:"",rounded:""},null,8,["disabled"]),n(s,{onClick:t[3]||(t[3]=o=>A()),disabled:!i(c)["@odata.nextLink"],icon:"pi pi-chevron-right",text:"",rounded:""},null,8,["disabled"])])]),e("div",null,[v.value&&v.value.length>0?(_(!0),k(Y,{key:0},X(v.value,(o,R)=>(_(),k("div",{key:R,onClick:Me=>E(o),class:L(["p-4 cursor-pointer border-1 border-300 border-x-none white-space-nowrap overflow-hidden text-overflow-ellipsis",`${R!==0&&"border-top-none"} ${o.id===(g.value&&g.value.id)&&"bg-primary-100"}`])},[e("div",ge,[e("div",he,[e("div",xe,d(o.from.emailAddress.name),1),e("div",{class:L(["text-overflow-ellipsis w-14rem overflow-hidden",`${!o.isRead&&"font-bold"}`])},d(o.subject),3)]),e("div",ke,[e("div",{class:L(["text-xs text-700",`${!o.isRead&&"font-bold"}`])},d(o.receivedDateTime),3)])])],10,me))),128)):(_(),k("div",be," No messages found "))]),e("div",we,[e("div",null,"1 - 10 of ("+d(i(h).totalItemCount)+")",1),e("div",null,[n(s,{disabled:!i(h).previousLink,icon:"pi pi-chevron-left",text:"",rounded:""},null,8,["disabled"]),n(s,{onClick:t[4]||(t[4]=o=>A()),disabled:!i(c)["@odata.nextLink"],icon:"pi pi-chevron-right",text:"",rounded:""},null,8,["disabled"])])])])])]),_:1}),n(I,{class:"flex",size:75},{default:b(()=>[n(i(j),{token:r.value,message:g.value},null,8,["token","message"])]),_:1})]),_:1})]),_:1},8,["blocked"]))}}};export{Se as default};
