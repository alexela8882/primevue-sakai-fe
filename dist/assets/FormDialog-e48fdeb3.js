import{u as L,r as o,a as z,b as O,s as A,c as _,o as n,d as y,w as h,e as r,f as B,g as E,h as G,i as v,j as c,F as U,k as I,n as H,t as x,l as J,m as F,p as Q,q as W}from"./index-65928da5.js";import{u as X}from"./user-26d0e2b6.js";import{u as Y}from"./branch-59cec1e1.js";const Z={key:0},ee={class:"capitalize"},ae={class:"text-12px italic"},te={key:2},le={class:"mb2 mt1 text-red-600 dark:text-red-500"},oe={class:"flex items-center justify-end"},ve={__name:"FormDialog",setup(se){const S=L(),w=o(),k=o(),i=o(),s=o(),d=o(!1),V=o(),C=z(),b=o(),l=o(),m=o(),D=O(),{toastTimer:ue,toastOpen:ne,formModalOpen:p,formModalData:t}=A(D),M=X(),R=Y(),g=o({});g.value=new FormData;const q=u=>{if(u.target&&u.dataTransfer){if(!(u.target.files||u.dataTransfer.files).length)return;g.value.append("image",u.target.files[0]),console.log(g.value)}},T=async()=>{console.log(t.value),d.value=!0,i.value=t.value.data.store.name,s.value=t.value.data.store.action,w.value=t.value.data.api.uri,k.value=t.value.data.api.method;const u=o({});t.value.data.fields.map(e=>{u.value[e.name]=e.value,g.value[e.name]=e.value,g.value.append([e.name],e.value),e.error=null}),await W({url:w.value,method:k.value,data:u.value}).then(e=>{b.value=e.status,l.value=e.data}).catch(e=>{b.value=e.response.status,m.value=e.response}),b.value===200?(console.log(b.value),i.value==="roleStore"?(s.value==="addRole"&&S.push(`/roles/edit/${l.value.data._token}`),roleStore[s.value](l.value.data)):i.value==="userStore"?M[s.value](l.value.data):i.value==="branchStore"?R[s.value](l.value.data):i.value==="albumStore"?(s.value==="addPhoto"&&(V.value=new URLSearchParams(window.location.search),S.push(`/albums/${l.value.data.album._token}/${l.value.data._token}?${V.value}`)),albumStore[s.value](l.value.data)):i.value==="tagStore"?tagStore[s.value](l.value.data):i.value==="subdomainStore"&&subdomainStore[s.value](l.value.data),p.value=!1,C.add({severity:"success",summary:"Success",detail:l.value.message,life:3e3})):(console.log(m),t.value.data.fields.map(e=>{e.error=m.value.data}),m.value.status!==422&&(d.value=!1,C.add({severity:"error",summary:"Forbidden",detail:m.value,life:3e3}))),d.value=!1};return(u,e)=>{const N=_("Dropdown"),P=_("InputText"),$=_("Button"),j=_("Dialog");return n(),y(j,{visible:v(p),"onUpdate:visible":e[2]||(e[2]=a=>Q(p)?p.value=a:null),modal:"",header:v(D).formModalData.title,style:{width:"30vw"},breakpoints:{"960px":"75vw","641px":"95vw"}},{footer:h(()=>[r("span",oe,[B($,{disabled:d.value,onClick:e[1]||(e[1]=a=>p.value=!1),class:"reddot-button-secondary"},{default:h(()=>[E(" Cancel ")]),_:1},8,["disabled"]),B($,{disabled:d.value,loading:d.value,onClick:T,severity:"primary",label:d.value?"Saving...":"Save"},null,8,["disabled","loading","label"])])]),default:h(()=>[r("div",null,[r("div",null,[r("form",{class:"space-y-6",onSubmit:e[0]||(e[0]=G(()=>{},["prevent"]))},[v(t).data?(n(),c("div",Z,[(n(!0),c(U,null,I(v(t).data.fields,(a,K)=>(n(),c("span",null,[r("label",{class:H([`${K!==0?"mt-5":""}`,"block mb-2 text-sm font-medium text-gray-900 dark:text-white"])},[r("strong",ee,x(a.label?a.label:a.name),1),r("span",ae,"Â "+x(a.instruction?`(${a.instruction})`:null),1)],2),a.type=="select"?(n(),y(N,{key:0,modelValue:a.value,"onUpdate:modelValue":f=>a.value=f,filter:"",removable:"",showClear:"",options:a.items,optionLabel:"name",optionValue:"_id",class:"w-full text-sm"},null,8,["modelValue","onUpdate:modelValue","options"])):(n(),y(P,{key:1,onChange:q,onKeyup:J(T,["enter"]),disabled:a.disabled&&v(t).data.fields[a.requiringIndex]&&(v(t).data.fields[a.requiringIndex].value===null||v(t).data.fields[a.requiringIndex].value===""),type:a.type,modelValue:a.value,"onUpdate:modelValue":f=>a.value=f,accept:`${a.type=="file"&&"image/png, image/gif, image/jpeg"}`,class:"w-full"},null,8,["onKeyup","disabled","type","modelValue","onUpdate:modelValue","accept"])),a.error?(n(),c("span",te,[(n(!0),c(U,null,I(a.error[a.name],f=>(n(),c("p",le,[r("small",null,x(f),1)]))),256))])):F("",!0)]))),256))])):F("",!0)],32)])])]),_:1},8,["visible","header"])}}};export{ve as default};
