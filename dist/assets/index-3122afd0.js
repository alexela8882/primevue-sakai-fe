import{u as g,r as i,s as v,z as y,c as k,o as x,j as T,e as r,f as w,t as P,C as A,_ as M}from"./index-52a3749d.js";import{u as R,U as S}from"./index-12eff001.js";const b={class:"flex justify-content-center",style:{height:"60vh !important"}},C={class:"flex flex-column align-items-center justify-content-center text-center mt-n6"},I=r("div",null,"Please wait...",-1),F={__name:"index",setup(E){A(()=>M(()=>import("./mailbox-7c23c65b.js"),["assets/mailbox-7c23c65b.js","assets/index-52a3749d.js","assets/index-86c8a9da.css","assets/index-12eff001.js"]));const d=g(),o=i();i();const s=i(),c=R(),{getMailFolders:p,mailFoldersLoading:j}=v(c),{fetchProfile:m,fetchMailFolders:_}=c,f={auth:{clientId:"1528f72b-9149-440c-9803-3a181a8197b1"}},a=new S(f);a.handleRedirectCallback((e,t)=>{});const h=async()=>{s.value="Trying to sign you in";var e={scopes:["user.read","mail.send"]};await a.loginPopup(e).then(t=>{l()}).catch(t=>{})},l=async()=>{if(a.getAccount()){var e={scopes:["user.read","mail.send"]};await a.acquireTokenSilent(e).then(t=>{o.value=t.accessToken,console.log(t.accessToken),u()}).catch(t=>{if(t.name==="InteractionRequiredAuthError")return a.acquireTokenPopup(e).then(n=>{o.value=n.accessToken}).catch(n=>{})})}},u=async()=>{s.value="Redirecting to your inbox",await m(o.value),await _(o.value),p.value.map(e=>{e.displayName==="Inbox"&&d.push(`/outlook-mail/folder/${e.id}`)})};return y(async()=>{await l(),o.value||await h(),u()}),(e,t)=>{const n=k("ProgressSpinner");return x(),T("div",b,[r("div",C,[w(n),r("div",null,P(s.value),1),I])])}}};export{F as default};
