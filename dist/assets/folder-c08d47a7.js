import{r as m,J as U,s as E,A as T,z as V,c as _,o as x,d as q,w as h,i as a,f as n,e,t as v,j as b,k as D,n as w,F as G,C as J,_ as H}from"./index-e7be2f3c.js";import{u as K,U as Q}from"./index-4cfacb5f.js";const W={class:"flex flex-column gap-3 m-3"},X={class:"flex align-items-center justify-content-between"},Y={class:"flex align-items-center gap-1"},Z=e("div",{class:"text-2xl text-primary font-bold"},"Mailbox",-1),ee={class:"font-bold"},te={class:"p-input-icon-left w-full"},le=e("i",{class:"pi pi-search"},null,-1),oe={class:"flex align-items-center gap-3 m-3"},se=["onClick"],ae={class:"flex align-items-start justify-content-between gap-6"},ne={class:"flex flex-column gap-1"},ie={class:"font-bold"},de={class:"flex flex-column gap-2"},re={key:1,class:"p-4 white-space-nowrap overflow-hidden text-overflow-ellipsis"},ce={class:"flex align-items-center gap-3 m-3"},_e={__name:"folder",setup(ue){const I=J(()=>H(()=>import("./MailboxMessage-9e6d4d46.js"),["assets/MailboxMessage-9e6d4d46.js","assets/index-e7be2f3c.js","assets/index-86c8a9da.css","assets/index-4cfacb5f.js"])),g=m(),r=m(),p=m(),c=m(),S=U(),M=K(),{mailFolderLoading:B,getMailFolder:u,getMailFolderMessages:i}=E(M),{fetchMailFolder:F,fetchMailFolderMessages:$,folderMailMessagesNavigate:R}=M,P={auth:{clientId:"393bd73e-ac09-4f31-a723-f4e981a027ce"}},f=new Q(P);f.handleRedirectCallback((l,t)=>{});const j=async()=>{var l={scopes:["user.read","mail.send"]};await f.loginPopup(l).then(t=>{k()}).catch(t=>{})},z=l=>{console.log(l),p.value=l},k=async()=>{if(f.getAccount()){var l={scopes:["user.read","mail.send"]};await f.acquireTokenSilent(l).then(t=>{c.value=t.accessToken,console.log(t.accessToken),C()}).catch(t=>{if(t.name==="InteractionRequiredAuthError")return f.acquireTokenPopup(l).then(d=>{c.value=d.accessToken}).catch(d=>{})})}},C=async()=>{await F(c.value,S.params.id),await $(c.value,u.value),r.value=i.value.value},y=()=>{console.log(i.value["@odata.nextLink"]),R(c.value,i.value["@odata.nextLink"])};return T(()=>g.value,(l,t)=>{if(l){let d=i.value.value.filter(s=>{if(s.subject.toLowerCase().indexOf(l)>-1||s.from.emailAddress.name.toLowerCase().indexOf(l)>-1||s.from.emailAddress.address.toLowerCase().indexOf(l)>-1)return s});r.value=d}else r.value=i.value.value}),T(()=>i.value,(l,t)=>{r.value=l.value,l.value.map((d,s)=>{s===0&&(p.value=d)})}),V(async()=>{await k(),c.value||await j(),C()}),(l,t)=>{const d=_("InputText"),s=_("Button"),L=_("SplitterPanel"),N=_("Splitter"),O=_("BlockUI");return x(),q(O,{blocked:a(B)},{default:h(()=>[n(N,{class:"mb-5"},{default:h(()=>[n(L,{class:"flex",size:5},{default:h(()=>[e("div",null,[e("div",null,[e("div",W,[e("div",X,[e("div",Y,[Z,e("div",ee,"("+v(a(u).displayName)+")",1)]),e("div",null,[e("i",{onClick:t[0]||(t[0]=o=>k()),class:"cursor-pointer pi pi-refresh"})])]),e("div",null,[e("div",null,[e("span",te,[le,n(d,{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=o=>g.value=o),placeholder:"Search",class:"w-full"},null,8,["modelValue"])])])])]),e("div",oe,[e("div",null,"1 - 10 of ("+v(a(u).totalItemCount)+")",1),e("div",null,[n(s,{disabled:!a(u).previousLink,icon:"pi pi-chevron-left",text:"",rounded:""},null,8,["disabled"]),n(s,{onClick:t[2]||(t[2]=o=>y()),disabled:!a(i)["@odata.nextLink"],icon:"pi pi-chevron-right",text:"",rounded:""},null,8,["disabled"])])]),e("div",null,[r.value&&r.value.length>0?(x(!0),b(G,{key:0},D(r.value,(o,A)=>(x(),b("div",{key:A,onClick:ve=>z(o),class:w(["p-4 cursor-pointer border-1 border-300 border-x-none white-space-nowrap overflow-hidden text-overflow-ellipsis",`${A!==0&&"border-top-none"} ${o.id===(p.value&&p.value.id)&&"bg-primary-100"}`])},[e("div",ae,[e("div",ne,[e("div",ie,v(o.from.emailAddress.name),1),e("div",{class:w(["text-overflow-ellipsis w-14rem overflow-hidden",`${!o.isRead&&"font-bold"}`])},v(o.subject),3)]),e("div",de,[e("div",{class:w(["text-xs text-700",`${!o.isRead&&"font-bold"}`])},v(o.receivedDateTime),3)])])],10,se))),128)):(x(),b("div",re," No messages found "))]),e("div",ce,[e("div",null,"1 - 10 of ("+v(a(u).totalItemCount)+")",1),e("div",null,[n(s,{disabled:!a(u).previousLink,icon:"pi pi-chevron-left",text:"",rounded:""},null,8,["disabled"]),n(s,{onClick:t[3]||(t[3]=o=>y()),disabled:!a(i)["@odata.nextLink"],icon:"pi pi-chevron-right",text:"",rounded:""},null,8,["disabled"])])])])])]),_:1}),n(L,{class:"flex",size:75},{default:h(()=>[n(a(I),{token:c.value,message:p.value},null,8,["token","message"])]),_:1})]),_:1})]),_:1},8,["blocked"])}}};export{_e as default};
