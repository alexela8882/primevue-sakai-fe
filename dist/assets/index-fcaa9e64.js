import{u as M,r as i,s as P,E as A,c as g,o as r,j as u,e as n,f as m,t as h,w as R,g as E,I,J as S}from"./index-2e9b86cc.js";import{u as B,U as C}from"./index-44269701.js";const b={class:"flex justify-content-center",style:{height:"60vh !important"}},N={class:"flex flex-column align-items-center justify-content-center text-center mt-n6"},V={key:0},j=n("div",null,"Please wait...",-1),q={key:1},U={__name:"index",setup(F){I(()=>S(()=>import("./mailbox-12282161.js"),["assets/mailbox-12282161.js","assets/index-2e9b86cc.js","assets/index-cb49da02.css","assets/index-44269701.js"]));const v=M(),t=i();i();const c=i(),l=i(),d=B(),{getMailFolders:f,mailFoldersLoading:L}=P(d),{fetchProfile:y,fetchMailFolders:k}=d,x={auth:{clientId:"393bd73e-ac09-4f31-a723-f4e981a027ce"}},a=new C(x);a.handleRedirectCallback((o,e)=>{});const w=async()=>{c.value="Trying to sign you in";var o={scopes:["user.read","mail.read","mail.send"]};await a.loginPopup(o).then(e=>{p()}).catch(e=>{console.log(e),l.value=e})},p=async()=>{if(a.getAccount()){var o={scopes:["user.read","mail.read","mail.send"]};await a.acquireTokenSilent(o).then(e=>{t.value=e.accessToken,console.log(e.accessToken),_()}).catch(e=>{if(e.name==="InteractionRequiredAuthError")return a.acquireTokenPopup(o).then(s=>{t.value=s.accessToken}).catch(s=>{console.log(s)});console.log(e)})}},_=async()=>{c.value="Redirecting to your inbox",await y(t.value),await k(t.value),f.value.map(o=>{o.displayName==="Inbox"&&v.push(`/outlook-mail/folder/${o.id}`)})};return A(async()=>{await p(),t.value||await w(),_()}),(o,e)=>{const s=g("ProgressSpinner"),T=g("Button");return r(),u("div",b,[n("div",N,[l.value?(r(),u("div",q,[n("div",null,h(l.value),1),n("div",null,[m(T,{link:""},{default:R(()=>[E("Refresh page to retry")]),_:1})])])):(r(),u("div",V,[m(s),n("div",null,h(c.value),1),j]))])])}}};export{U as default};
