import{u as M,r as c,s as P,z as A,c as g,o as r,j as u,e as a,f as h,t as m,w as R,g as S,C,_ as B}from"./index-f5812723.js";import{u as E,U as I}from"./index-32a44eed.js";const N={class:"flex justify-content-center",style:{height:"60vh !important"}},V={class:"flex flex-column align-items-center justify-content-center text-center mt-n6"},b={key:0},j=a("div",null,"Please wait...",-1),q={key:1},O={__name:"index",setup(F){C(()=>B(()=>import("./mailbox-b9e3870b.js"),["assets/mailbox-b9e3870b.js","assets/index-f5812723.js","assets/index-86c8a9da.css","assets/index-32a44eed.js"]));const v=M(),o=c();c();const i=c(),l=c(),d=E(),{getMailFolders:f,mailFoldersLoading:L}=P(d),{fetchProfile:y,fetchMailFolders:k}=d,w={auth:{clientId:"393bd73e-ac09-4f31-a723-f4e981a027ce"}},s=new I(w);s.handleRedirectCallback((t,e)=>{});const x=async()=>{i.value="Trying to sign you in";var t={scopes:["user.read","mail.send"]};await s.loginPopup(t).then(e=>{p()}).catch(e=>{console.log(e),l.value=e})},p=async()=>{if(s.getAccount()){var t={scopes:["user.read","mail.send"]};await s.acquireTokenSilent(t).then(e=>{o.value=e.accessToken,console.log(e.accessToken),_()}).catch(e=>{if(e.name==="InteractionRequiredAuthError")return s.acquireTokenPopup(t).then(n=>{o.value=n.accessToken}).catch(n=>{console.log(n)});console.log(e)})}},_=async()=>{i.value="Redirecting to your inbox",await y(o.value),await k(o.value),f.value.map(t=>{t.displayName==="Sent Items"&&v.push(`/outlook-mail/folder/${t.id}`)})};return A(async()=>{await p(),o.value||await x(),_()}),(t,e)=>{const n=g("ProgressSpinner"),T=g("Button");return r(),u("div",N,[a("div",V,[l.value?(r(),u("div",q,[a("div",null,m(l.value),1),a("div",null,[h(T,{link:""},{default:R(()=>[S("Refresh page to retry")]),_:1})])])):(r(),u("div",b,[h(n),a("div",null,m(i.value),1),j]))])])}}};export{O as default};
