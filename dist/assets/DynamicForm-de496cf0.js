import{r as u,E as x,G as C,c as _,o as k,j as I,e as r,f as c,i as s,F as O,I as w,J as A}from"./index-62853e10.js";import{u as D,c as g,a as M}from"./index.esm-985f6cec.js";const q={class:"relative h-full px-3"},z={class:"sticky bottom-0 right-0 py-2 surface-50"},N={class:"flex justify-content-end gap-2 px-3 py-1"},H={__name:"DynamicForm",props:{form:Object,loading:Boolean,response:String},emits:["save-action"],setup(t,{emit:b}){const p=w(()=>A(()=>import("./DynamicFields-de913336.js"),["assets/DynamicFields-de913336.js","assets/index-62853e10.js","assets/index-40ff91a8.css"])),o=t,V=b,d=u({}),i=u({});u([]);const{values:m,errors:y,setErrors:P,setFieldError:E,ErrorBag:R,defineComponentBinds:F,isSubmitting:G,setFieldValue:S,handleSubmit:B,resetForm:v,meta:$}=D({}),h=async()=>{if((await f()).inner)console.log("error");else{let e={};o.form.prevalue?e={...m,...o.form.prevalue}:e=m;let n=Object.assign({},{be_nec:o.form.be_nec,fields:e});V("save-action",n)}},f=B((a,e)=>{Object.keys(i.value).forEach((n,l)=>{i.value[n].modelValue!==null&&E(n,null)});try{return d.value.validateSync(a,{abortEarly:!1}),a}catch(n){return n.inner.map(l=>{l.path+"",l.message,e.setFieldError(l.path,l.message)}),n}}),j=async()=>{o.form.data.fields.map(e=>Object.assign(e,{...e,data:{value:null}}));const a={};o.form.data.fields.map(e=>{e.rules&&e.rules.required?a[e.name]=g().label(e.label).required():a[e.name]=g().label(e.label).nullable(),i.value[e.name]=F(`${e.name}`),S(`${e.name}`,null)}),d.value=a,d.value=M(a)};return x(async()=>{await j()}),C(()=>o.response,(a,e)=>{a&&v()}),(a,e)=>{const n=_("Button");return k(),I(O,null,[r("div",q,[r("div",null,[c(s(p),{fields:t.form.data.fields,moduleValidationInputs:i.value,moduleValidationErrors:s(y),moduleValidationMeta:s($),loading:t.loading,onValidateSyncFunc:e[0]||(e[0]=l=>s(f)())},null,8,["fields","moduleValidationInputs","moduleValidationErrors","moduleValidationMeta","loading"])])]),r("div",z,[r("div",N,[c(n,{onClick:e[1]||(e[1]=l=>s(v)()),label:"Reset",disabled:t.loading,outlined:""},null,8,["disabled"]),c(n,{onClick:e[2]||(e[2]=l=>h()),disabled:t.loading,loading:t.loading,label:`${t.loading?"Saving...":"Save"}`,size:"large"},null,8,["disabled","loading","label"])])])],64)}}};export{H as default};
