import{H as N,a as M,r as n,K as w,v as B,s as p,I as a,q as f}from"./index-640f128e.js";const P=N("moduleDetailStore",()=>{M();const c=n(!0),u=n(!0),L=w(),b=B(),{jsonDbUrl:m}=p(L),{getBaseModule:C,getModule:O}=p(b),r=n({}),o=n([]),i=n([]),_=a(()=>r.value),y=a(()=>{const s=O.value.panels,e=s.map((t,g)=>Object.assign({},{_id:t._id,controllerMethod:t.controllerMethod,entityName:t.entityName,highlight:t.highlight,label:t.label,mutable:t.mutable,panelName:t.panelName,sections:[],tabKey:t.tabKey}));return s.map((t,g)=>{t.sections.filter((l,G)=>{if(l.sectionLabel){let d=Object.assign({},{sectionLabel:l.sectionLabel,row:l.row,field_ids:l.field_ids,additional_fields:[]});e[g].sections.push(d)}else{const d=e[g].sections.slice(-1).pop();if(d){let $=Object.assign({},{ids:l.field_ids});d.additional_fields.push($)}}})}),console.log(e),e}),R=a(()=>s=>r.value[s]),h=a(()=>o.value),j=a(()=>o.value.sort((e,t)=>e.panelOrder-t.panelOrder)),I=a(()=>s=>h.value.find(t=>t.cname===s)),v=a(()=>i.value),S=a(()=>i.value.sort((e,t)=>e.panelOrder-t.panelOrder)),T=a(()=>s=>v.value.find(t=>t.cname===s));return{itemLoading:c,relatedListLoading:u,item:r,getItem:_,_getRelatedLists:h,_getRelatedOrderedLists:j,_getRelatedListsByCname:I,getRelatedLists:v,getRelatedOrderedLists:S,getRelatedListsByCname:T,getItemPanels:y,getItemValueByName:R,fetchItem:async s=>{c.value=!0;const e=await f(`${m.value}/${s.name}-item?_id=${s.pageid}`,{method:"GET",headers:{"Content-Type":"application/json"}});e.status===200&&(r.value=e.data&&e.data.length>0?e.data[0]:e.data),c.value=!1},fetchItemRelatedList:async s=>{const e=await f(`${m.value}/${s.moduleName}-related?cname=${s.panelName}`,{method:"GET",headers:{"Content-Type":"application/json"}}).catch(t=>{console.log(t)});e&&e.status===200?e.data&&i.value.push(e.data[0]):i.value=[]},fetchItemRelatedLists:async s=>{u.value=!0;const e=await f(`${m.value}/${s.name}-related`,{method:"GET",headers:{"Content-Type":"application/json"}}).catch(t=>{console.log(t)});e&&e.status===200?o.value=e.data:(console.log("err"),o.value=[]),console.log(o.value),u.value=!1}}});export{P as u};
