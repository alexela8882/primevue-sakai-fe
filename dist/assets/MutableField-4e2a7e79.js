import{I as U,J as $,a3 as R,s as J,a5 as H,r as w,aY as K,E as Q,a7 as i,c as r,o as t,j as m,f as x,i as l,n as f,F as g,k as s,t as o,m as I,d as c,w as v,e as M}from"./index-c093ce25.js";import{v as W}from"./Validate-aa9d6bb0.js";import"./Editor-d83f0cdf.js";const X=["for"],Z={key:4,class:"fieldInput flex flex-column"},h=["for"],p=["for"],_={class:"fieldInputSelection"},ee=M("svg",{class:"circular",viewBox:"0 0 50 50"},[M("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})],-1),le=["for"],ue={__name:"MutableField",props:{config:Object,type:String,keyName:String,inline:Boolean,module:String,entity:String,mutableIndex:Number},emits:["changeValue"],setup(e,{emit:L}){const b=e,B=U(()=>$(()=>import("./LookupField-d83d1ed4.js"),["assets/LookupField-d83d1ed4.js","assets/index-c093ce25.js","assets/index-cb49da02.css","assets/LookupField-09bee035.css"])),G=U(()=>$(()=>import("./FormulaField-9ebd5d6d.js"),["assets/FormulaField-9ebd5d6d.js","assets/index-c093ce25.js","assets/index-cb49da02.css"])),Y=R(),{fetchPicklist:P,fetchLookup:ne}=Y,{getPicklistByListName:E,getLookupOptions:N}=J(Y),{checkFieldIfMultipleSelect:V}=H(),{validateField:T}=W();w();const a=K("form");w(!1);const S=w(!1),y=k=>{b.inline||(a.value.errors[b.keyName][k.name]=T(a.value.values[b.keyName],k,a.value.fields)),L("changeValue",k.name,b.mutableIndex)};return Q(async()=>{if(b.inline&&b.config.field_type.name=="picklist"){S.value=!0;let k=E.value(b.config.listName);i.isEmpty(k)&&await P([b.config.listName]),S.value=!1}}),(k,u)=>{const C=r("InputText"),F=r("InputNumber"),z=r("el-date-picker"),O=r("InputSwitch"),j=r("Checkbox"),D=r("el-option"),q=r("el-select"),A=r("el-option-group");return e.config.field_type.name=="text"?(t(),m("div",{key:0,class:f(["fieldInput flex flex-column",{required:l(i).get(e.config.rules,"required",!1)}])},[x(C,{modelValue:l(a).values[e.keyName][e.mutableIndex][e.config.name],"onUpdate:modelValue":u[0]||(u[0]=n=>l(a).values[e.keyName][e.mutableIndex][e.config.name]=n),id:e.config.name,class:f({"p-invalid":!l(i).isEmpty(l(i).get(l(a).errors[e.keyName][e.mutableIndex],e.config.name,[]))}),disabled:l(a).formSaving,onChange:u[1]||(u[1]=n=>y(e.config))},null,8,["modelValue","id","class","disabled"]),(t(!0),m(g,null,s(l(i).get(l(a).errors[e.keyName][e.mutableIndex],e.config.name,[]),(n,d)=>(t(),m("small",{class:"errMsg",key:d},o(n),1))),128))],2)):e.config.field_type.name=="number"||e.config.field_type.name=="percentage"?(t(),m("div",{key:1,class:f(["fieldInput flex flex-column",{required:l(i).get(e.config.rules,"required",!1)}])},[x(F,{modelValue:l(a).values[e.keyName][e.mutableIndex][e.config.name],"onUpdate:modelValue":[u[2]||(u[2]=n=>l(a).values[e.keyName][e.mutableIndex][e.config.name]=n),u[3]||(u[3]=n=>y(e.config))],inputId:"config.name",mode:"decimal",class:f({invalid:!l(i).isEmpty(l(i).get(l(a).errors[e.keyName][e.mutableIndex],e.config.name,[]))}),useGrouping:l(i).get(e.config.rules,"comma_separated",!1),suffix:e.config.field_type.name=="percentage"?"%":"",minFractionDigits:l(i).get(e.config.rules,"decimal",null),maxFractionDigits:l(i).get(e.config.rules,"decimal",null)},null,8,["modelValue","class","useGrouping","suffix","minFractionDigits","maxFractionDigits"]),(t(!0),m(g,null,s(l(i).get(l(a).errors[e.keyName][e.mutableIndex],e.config.name,[]),(n,d)=>(t(),m("small",{class:"errMsg",key:d},o(n),1))),128))],2)):e.config.field_type.name=="currency"?(t(),m("div",{key:2,class:f(["fieldInput flex flex-column",{required:l(i).get(e.config.rules,"required",!1)}])},[e.type!="tableForm"?(t(),m("label",{key:0,for:e.config.name},o(e.config.label),9,X)):I("",!0),l(i).get(l(a).values[e.keyName][e.mutableIndex],e.config.currencySource.field+".code","")==""?(t(),c(F,{key:1,disabled:l(a).formSaving,modelValue:l(a).values[e.keyName][e.mutableIndex][e.config.name],"onUpdate:modelValue":[u[4]||(u[4]=n=>l(a).values[e.keyName][e.mutableIndex][e.config.name]=n),u[5]||(u[5]=n=>y(e.config))],inputId:"config.name",mode:"decimal",class:f({invalid:!l(i).isEmpty(l(i).get(l(a).errors[e.keyName][e.mutableIndex],e.config.name,[]))}),useGrouping:l(i).get(e.config.rules,"comma_separated",!1),minFractionDigits:l(i).get(e.config.rules,"decimal",null),maxFractionDigits:l(i).get(e.config.rules,"decimal",null)},null,8,["disabled","modelValue","class","useGrouping","minFractionDigits","maxFractionDigits"])):(t(),c(F,{key:2,modelValue:l(a).values[e.keyName][e.mutableIndex][e.config.name],"onUpdate:modelValue":[u[6]||(u[6]=n=>l(a).values[e.keyName][e.mutableIndex][e.config.name]=n),u[7]||(u[7]=n=>y(e.config))],disabled:l(a).formSaving,inputId:"config.name",mode:"currency",class:f({invalid:!l(i).isEmpty(l(i).get(l(a).errors[e.keyName][e.mutableIndex],e.config.name,[]))}),useGrouping:l(i).get(e.config.rules,"comma_separated",!1),currency:e.config.field_type.name=="currency"?l(i).get(l(a).values[e.keyName][e.mutableIndex],e.config.currencySource.field+".code",""):"",currencyDisplay:l(i).get(e.config,"currencySource.concat",""),minFractionDigits:l(i).get(e.config.rules,"decimal",null),maxFractionDigits:l(i).get(e.config.rules,"decimal",null)},null,8,["modelValue","disabled","class","useGrouping","currency","currencyDisplay","minFractionDigits","maxFractionDigits"])),(t(!0),m(g,null,s(l(i).get(l(a).errors[e.keyName][e.mutableIndex],e.config.name,[]),(n,d)=>(t(),m("small",{class:"errMsg",key:d},o(n),1))),128))],2)):e.config.field_type.name=="formula"?(t(),c(l(G),{key:3,field:e.config,keyName:e.keyName,mutableIndex:e.mutableIndex,module:e.module,entity:e.entity},null,8,["field","keyName","mutableIndex","module","entity"])):e.config.field_type.name=="date"?(t(),m("div",Z,[e.type!="tableForm"?(t(),m("label",{key:0,for:e.config.name},o(e.config.label),9,h)):I("",!0),x(z,{class:f(["w-full",{invalid:!l(i).isEmpty(l(i).get(l(a).errors[e.keyName][e.mutableIndex],e.config.name,[])),required:l(i).get(e.config.rules,"required",!1)}]),disabled:l(a).formSaving,modelValue:l(a).values[e.keyName][e.mutableIndex][e.config.name],"onUpdate:modelValue":u[8]||(u[8]=n=>l(a).values[e.keyName][e.mutableIndex][e.config.name]=n),clearable:"",type:l(i).get(e.config.rules,"date_selection","date"),format:l(i).get(e.config.rules,"date_selection","date")=="month"?"MMM YYYY":l(i).get(e.config.rules,"date_selection","date")=="week"?"YYYY [w]ww":"MM/DD/YYYY","value-format":"YYYY-MM-DD",onChange:u[9]||(u[9]=n=>y(e.config))},null,8,["disabled","modelValue","class","type","format"]),(t(!0),m(g,null,s(l(i).get(l(a).errors[e.keyName][e.mutableIndex],e.config.name,[]),(n,d)=>(t(),m("small",{class:"errMsg",key:d},o(n),1))),128))])):e.config.field_type.name=="boolean"?(t(),m("div",{key:5,class:f(["fieldInput checkbox",{required:l(i).get(e.config.rules,"required",!1)}])},[l(i).get(e.config.rules,"switch",!1)?(t(),c(O,{key:0,modelValue:l(a).values[e.keyName][e.mutableIndex][e.config.name],"onUpdate:modelValue":u[10]||(u[10]=n=>l(a).values[e.keyName][e.mutableIndex][e.config.name]=n),disabled:l(a).formSaving,inputId:e.config.name},null,8,["modelValue","disabled","inputId"])):(t(),c(j,{key:1,inputId:e.config.name,modelValue:l(a).values[e.keyName][e.mutableIndex][e.config.name],"onUpdate:modelValue":u[11]||(u[11]=n=>l(a).values[e.keyName][e.mutableIndex][e.config.name]=n),binary:!0,disabled:l(a).formSaving},null,8,["inputId","modelValue","disabled"])),e.type!="tableForm"?(t(),m("label",{key:2,for:e.config.name},o(e.config.label),9,p)):I("",!0)],2)):e.config.field_type.name=="picklist"?(t(),m("div",{key:6,class:f(["fieldInput flex flex-column",{required:l(i).get(e.config.rules,"required",!1)}])},[x(q,{modelValue:l(a).values[e.keyName][e.mutableIndex][e.config.name],"onUpdate:modelValue":u[12]||(u[12]=n=>l(a).values[e.keyName][e.mutableIndex][e.config.name]=n),class:f([{invalid:!l(i).isEmpty(l(i).get(l(a).errors[e.keyName][e.mutableIndex],e.config.name,[]))},"w-full"]),multiple:l(V)(e.config.rules),"collapse-tags":l(V)(e.config.rules),"collapse-tags-tooltip":l(V)(e.config.rules),placeholder:"Select",clearable:"",filterable:"",disabled:l(a).formSaving,loading:S.value,size:"small",onChange:u[13]||(u[13]=n=>y(e.config))},{loading:v(()=>[ee]),default:v(()=>[(t(!0),m(g,null,s(l(E)(e.config.listName),n=>(t(),c(D,{key:n._id,label:n.value,value:n},{default:v(()=>[M("span",_,o(n.value),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","class","multiple","collapse-tags","collapse-tags-tooltip","disabled","loading"]),(t(!0),m(g,null,s(l(i).get(l(a).errors[e.keyName][e.mutableIndex],e.config.name,[]),(n,d)=>(t(),m("small",{class:"errMsg mt-1",key:d},o(n),1))),128))],2)):e.config.field_type.name=="lookupModel"?(t(),m("div",{key:7,class:f(["fieldInput flex flex-column",{required:l(i).get(e.config.rules,"required",!1)}])},[l(i).get(e.config.rules,"ss_dropdown",!1)||l(i).get(e.config.rules,"ms_dropdown",!1)?(t(),m(g,{key:0},[l(N)(e.config.uniqueName,"group")?(t(),c(q,{key:0,modelValue:l(a).values[e.keyName][e.mutableIndex][e.config.name],"onUpdate:modelValue":u[15]||(u[15]=n=>l(a).values[e.keyName][e.mutableIndex][e.config.name]=n),disabled:l(a).formSaving,size:"small",class:f([{invalid:!l(i).isEmpty(l(i).get(l(a).errors[e.keyName][e.mutableIndex],e.config.name,[]))},"w-full"]),placeholder:"Select",clearable:"",filterable:""},{default:v(()=>[(t(!0),m(g,null,s(l(N)(e.config.uniqueName,"options"),n=>(t(),c(A,{key:n.label,label:n.label,onChange:u[14]||(u[14]=d=>y(e.config))},{default:v(()=>[(t(!0),m(g,null,s(n.options,d=>(t(),c(D,{key:d._id,label:d.value,value:d},null,8,["label","value"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","disabled","class"])):(t(),c(q,{key:1,modelValue:l(a).values[e.keyName][e.mutableIndex][e.config.name],"onUpdate:modelValue":u[16]||(u[16]=n=>l(a).values[e.keyName][e.mutableIndex][e.config.name]=n),disabled:l(a).formSaving,size:"small",class:f(["w-full",{invalid:!l(i).isEmpty(l(i).get(l(a).errors[e.keyName][e.mutableIndex],e.config.name,[]))}]),placeholder:"Select",clearable:"",filterable:"",onChange:u[17]||(u[17]=n=>y(e.config))},{default:v(()=>[(t(!0),m(g,null,s(l(N)(e.config.uniqueName,"options"),n=>(t(),c(D,{key:n._id,label:n.value,value:n},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled","class"]))],64)):(t(),c(l(B),{key:1,field:e.config,keyName:e.keyName,inline:e.inline,module:e.module,entity:e.entity,onChangeValue:u[18]||(u[18]=n=>y(e.config))},null,8,["field","keyName","inline","module","entity"])),(t(!0),m(g,null,s(l(i).get(l(a).errors[e.keyName][e.mutableIndex],e.config.name,[]),(n,d)=>(t(),m("small",{class:"errMsg",key:d},o(n),1))),128))],2)):(t(),m("div",{key:8,class:f(["fieldInput flex flex-column",{required:l(i).get(e.config.rules,"required",!1)}])},[e.type!="tableForm"?(t(),m("label",{key:0,for:e.config.name},o(e.config.label),9,le)):I("",!0),x(C,{id:e.config.name,modelValue:l(a).values[e.keyName][e.mutableIndex][e.config.name],"onUpdate:modelValue":u[19]||(u[19]=n=>l(a).values[e.keyName][e.mutableIndex][e.config.name]=n)},null,8,["id","modelValue"])],2))}}};export{ue as default};
