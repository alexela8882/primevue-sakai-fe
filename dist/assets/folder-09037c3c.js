import{r as m,J as Q,s as W,I as N,A as B,z as X,c as _,o as g,j as b,e,t as n,f as a,w,d as Y,i as r,g as Z,k as ee,n as L,F as te,C as le,_ as se}from"./index-2d626d96.js";import{u as oe,U as ne}from"./index-26458f06.js";const ae={key:0,class:"flex justify-content-center",style:{height:"60vh !important"}},ie={class:"flex flex-column align-items-center justify-content-center text-center mt-n6"},re={key:1,class:"flex justify-content-center",style:{height:"60vh !important"}},ce={class:"flex flex-column align-items-center justify-content-center text-center mt-n6"},ue=e("div",null,"Please wait...",-1),de={class:"flex flex-column gap-3 m-3"},ve={class:"flex align-items-center justify-content-between"},pe={class:"flex align-items-center gap-1"},fe=e("div",{class:"text-2xl text-primary font-bold"},"Mailbox",-1),me={class:"font-bold"},_e={class:"p-input-icon-left w-full"},ge=e("i",{class:"pi pi-search"},null,-1),he={class:"flex align-items-center gap-3 m-3"},xe=["onClick"],ke={class:"flex align-items-start justify-content-between gap-6"},be={class:"flex flex-column gap-1"},we={class:"font-bold"},ye={class:"flex flex-column gap-2"},Ce={key:1,class:"p-4 white-space-nowrap overflow-hidden text-overflow-ellipsis"},Me={class:"flex align-items-center gap-3 m-3"},Te={__name:"folder",setup(Le){const F=le(()=>se(()=>import("./MailboxMessage-0027420f.js"),["assets/MailboxMessage-0027420f.js","assets/index-2d626d96.js","assets/index-86c8a9da.css","assets/index-26458f06.js"])),d=m(),h=m(),y=m(),v=m(),x=m(),c=m(),O=Q(),P=oe(),{mailFolderLoading:V,getSkipValue:p,getPreviousLink:C,getMailFolder:f,getMailFolderMessages:u}=W(P),{fetchMailFolder:z,fetchMailFolderMessages:E,folderMailMessagesNavigate:I}=P,U={auth:{clientId:"393bd73e-ac09-4f31-a723-f4e981a027ce"}},k=new ne(U);k.handleRedirectCallback((l,t)=>{});const S=N(()=>Number(p.value)+1),T=N(()=>{const l=Number(p.value)+10;return l>f.value.totalItemCount?f.value.totalItemCount:l}),q=async()=>{d.value="Trying to sign you in";var l={scopes:["user.read","mail.send"]};await k.loginPopup(l).then(t=>{M()}).catch(t=>{h.value=t})},D=l=>{console.log(l),x.value=l},M=async()=>{if(d.value="Retrieving your messages",k.getAccount()){var l={scopes:["user.read","mail.send"]};await k.acquireTokenSilent(l).then(t=>{c.value=t.accessToken,A(),d.value=null,h.value=null}).catch(t=>{if(t.name==="InteractionRequiredAuthError")return k.acquireTokenPopup(l).then(s=>{c.value=s.accessToken}).catch(s=>{h.value=s})})}},A=async()=>{d.value="Retrieving your messages",await z(c.value,O.params.id),await E(c.value,f.value),v.value=u.value.value,d.value=null},R=()=>{console.log(u.value["@odata.nextLink"]),I(c.value,u.value["@odata.nextLink"])},G=()=>{if(console.log(p.value),p.value){console.log(C.value);let t=C.value.split("24").find(i=>i.toLowerCase().indexOf("skip=")>-1),s=C.value.replace(t,`skip=${p.value-10}`);I(c.value,s)}};return B(()=>y.value,(l,t)=>{if(l){let s=u.value.value.filter(i=>{if(i.subject.toLowerCase().indexOf(l)>-1||i.from.emailAddress.name.toLowerCase().indexOf(l)>-1||i.from.emailAddress.address.toLowerCase().indexOf(l)>-1)return i});v.value=s}else v.value=u.value.value}),B(()=>u.value,(l,t)=>{v.value=l.value,l.value.map((s,i)=>{i===0&&(x.value=s)})}),X(async()=>{await M(),c.value||await q(),A()}),(l,t)=>{const s=_("Button"),i=_("ProgressSpinner"),J=_("InputText"),$=_("SplitterPanel"),H=_("Splitter"),K=_("BlockUI");return h.value?(g(),b("div",ae,[e("div",ie,[e("div",null,n(h.value),1),e("div",null,[a(s,{link:""},{default:w(()=>[Z("Refresh page to retry")]),_:1})])])])):d.value?(g(),b("div",re,[e("div",ce,[a(i),e("div",null,n(d.value),1),ue])])):(g(),Y(K,{key:2,blocked:r(V)},{default:w(()=>[a(H,{class:"mb-5"},{default:w(()=>[a($,{class:"flex",size:5},{default:w(()=>[e("div",null,[e("div",null,[e("div",de,[e("div",ve,[e("div",pe,[fe,e("div",me,"("+n(r(f).displayName)+")",1)]),e("div",null,[e("i",{onClick:t[0]||(t[0]=o=>M()),class:"cursor-pointer pi pi-refresh"})])]),e("div",null,[e("div",null,[e("span",_e,[ge,a(J,{modelValue:y.value,"onUpdate:modelValue":t[1]||(t[1]=o=>y.value=o),placeholder:"Search",class:"w-full"},null,8,["modelValue"])])])])]),e("div",he,[e("div",null,n(S.value)+" - "+n(T.value)+" of ("+n(r(f).totalItemCount)+")",1),e("div",null,[a(s,{onClick:t[2]||(t[2]=o=>G()),disabled:r(p)==0,icon:"pi pi-chevron-left",text:"",rounded:""},null,8,["disabled"]),a(s,{onClick:t[3]||(t[3]=o=>R()),disabled:!r(u)["@odata.nextLink"],icon:"pi pi-chevron-right",text:"",rounded:""},null,8,["disabled"])])]),e("div",null,[v.value&&v.value.length>0?(g(!0),b(te,{key:0},ee(v.value,(o,j)=>(g(),b("div",{key:j,onClick:Pe=>D(o),class:L(["p-4 cursor-pointer border-1 border-300 border-x-none white-space-nowrap overflow-hidden text-overflow-ellipsis",`${j!==0&&"border-top-none"} ${o.id===(x.value&&x.value.id)&&"bg-primary-100"}`])},[e("div",ke,[e("div",be,[e("div",we,n(o.from.emailAddress.name),1),e("div",{class:L(["text-overflow-ellipsis w-14rem overflow-hidden",`${!o.isRead&&"font-bold"}`])},n(o.subject),3)]),e("div",ye,[e("div",{class:L(["text-xs text-700",`${!o.isRead&&"font-bold"}`])},n(o.receivedDateTime),3)])])],10,xe))),128)):(g(),b("div",Ce," No messages found "))]),e("div",Me,[e("div",null,n(S.value)+" - "+n(T.value)+" - "+n(Number(r(p))+10)+" of ("+n(r(f).totalItemCount)+")",1),e("div",null,[a(s,{disabled:!r(f).previousLink,icon:"pi pi-chevron-left",text:"",rounded:""},null,8,["disabled"]),a(s,{onClick:t[4]||(t[4]=o=>R()),disabled:!r(u)["@odata.nextLink"],icon:"pi pi-chevron-right",text:"",rounded:""},null,8,["disabled"])])])])])]),_:1}),a($,{class:"flex",size:75},{default:w(()=>[a(r(F),{token:c.value,message:x.value},null,8,["token","message"])]),_:1})]),_:1})]),_:1},8,["blocked"]))}}};export{Te as default};
