import{u as S,r as k,s as T,z as A,c as F,o as n,j as c,e as s,i as r,F as v,k as R,f as i,d as I,w as P,S as B,t as E,C as N,_ as q}from"./index-9e27fc45.js";import{u as L,U as V}from"./index-c9933dcb.js";const $=s("div",null,"Redirecting to inbox...",-1),z={class:"hidden"},D=s("div",{class:"mb-5"},[s("h1",null,"Mailbox")],-1),O={class:"flex gap-6"},U={style:{position:"relative !important"}},j={key:0,class:"white-space-nowrap",style:{position:"sticky !important",top:"100px !important"}},G=["onClick"],H={key:1},J={class:"w-full"},Y={__name:"index",setup(K){const f=N(()=>q(()=>import("./mailbox-650b401f.js"),["assets/mailbox-650b401f.js","assets/index-9e27fc45.js","assets/index-86c8a9da.css","assets/index-c9933dcb.js"])),d=S(),a=k(),g=k(),u=L(),{getMailFolders:p,mailFoldersLoading:w}=T(u),{fetchProfile:y,fetchMailFolders:b}=u,x={auth:{clientId:"393bd73e-ac09-4f31-a723-f4e981a027ce"}},l=new V(x);l.handleRedirectCallback((e,t)=>{});const C=async()=>{var e={scopes:["user.read","mail.send"]};await l.loginPopup(e).then(t=>{_()}).catch(t=>{})},_=async()=>{if(l.getAccount()){var e={scopes:["user.read","mail.send"]};await l.acquireTokenSilent(e).then(t=>{a.value=t.accessToken,console.log(t.accessToken),h()}).catch(t=>{if(t.name==="InteractionRequiredAuthError")return l.acquireTokenPopup(e).then(o=>{a.value=o.accessToken}).catch(o=>{})})}},h=async()=>{await y(a.value),await b(a.value),p.value.map(e=>{e.displayName==="Inbox"&&d.push(`/outlook-mail/folder/${e.id}`)})};return A(async()=>{await _(),a.value||await C(),h()}),(e,t)=>{const o=F("Skeleton");return n(),c(v,null,[$,s("div",z,[D,s("div",O,[s("div",U,[r(w)?(n(),c("div",H,[i(o,{class:"mb-2"}),i(o,{width:"10rem",class:"mb-2"}),i(o,{width:"5rem",class:"mb-2"}),i(o,{height:"2rem",class:"mb-2"}),i(o,{width:"10rem",height:"4rem"})])):(n(),c("div",j,[s("div",null,[(n(!0),c(v,null,R(r(p),(m,M)=>(n(),c("div",{key:M,class:"my-3 cursor-pointer",onClick:Q=>r(d).push(`/outlook-mail/folder/${m.id}`)},E(m.displayName),9,G))),128))])]))]),s("div",J,[(n(),I(B,null,{default:P(()=>[i(r(f),{token:a.value,folder:g.value},null,8,["token","folder"])]),_:1}))])])])],64)}}};export{Y as default};
