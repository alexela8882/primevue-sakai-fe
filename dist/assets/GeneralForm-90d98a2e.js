import{I as W,J as X,r as m,B as Y,s as B,E as Z,c as $,o as l,j as t,e as o,F as y,k as g,f as v,aa as ee,i as a,t as F,m as p,n as C,d as T,w as V,S as j}from"./index-b308c080.js";import{u as le,c as h,a as L}from"./index.esm-bea0fbfa.js";import{u as te}from"./index-c7a740f8.js";import{T as O}from"./TwoColumnList-cb2a6777.js";const ae={class:"relative mt-4"},oe=o("div",{class:"text-l text-700 font-bold bg-primary-50 p-2 mb-4"},"All required fields",-1),se={class:"grid"},ne={class:"p-float-label"},ie={key:0,class:"text-red-600"},ue=o("h5",null,"Detailed add",-1),de={key:0},re={class:"text-l text-700 font-bold bg-primary-50 p-2"},ce={class:"flex flex-column mt-4"},me={key:0},ve={key:1},ke={__name:"GeneralForm",props:{tabStyle:String,name:String,module:Object},emits:["update-timeout"],setup(E,{emit:D}){const I=E,M=W(()=>X(()=>import("./SectionFields-f6994300.js"),["assets/SectionFields-f6994300.js","assets/index-b308c080.js","assets/index-cb49da02.css","assets/index-c7a740f8.js"])),A=m(!0),b=m({}),r=m({}),q=m([]),N=m([]),c=m([]),{values:pe,errors:_,setErrors:_e,setFieldError:P,ErrorBag:be,defineComponentBinds:R,isSubmitting:fe,setFieldValue:z,handleSubmit:G,meta:S}=le({}),J=Y(),U=te();B(J),B(U);const H=async()=>{(await f()).inner?console.log("error"):console.log("passed")},K=async()=>{c.value=I.module.fields,c.value.map(e=>Object.assign(e,{...e,data:{value:null}}));const s={};c.value.map(e=>{if(e.rules&&e.rules.required){s[e.uniqueName]=h().label(e.label).required();let n=Object.assign({},{[e.uniqueName]:h().label(e.label).required()});console.log(n)}else s[e.uniqueName]=h().label(e.label).nullable();r.value[e.uniqueName]=R(`${e.uniqueName}`),z(`${e.uniqueName}`,null)}),b.value=s,b.value=L(s),console.log(b.value),N.value=c.value.filter(e=>e.rules&&e.rules.required),L().shape({field_1:h().label("Field 1").required()}),q.value=I.module.panels.filter(e=>e.controllerMethod.includes("@index")),setTimeout(()=>{A.value=!1,D("update-timeout")},100)},f=G((s,e)=>{Object.keys(r.value).forEach((n,d)=>{r.value[n].modelValue!==null&&P(n,null)});try{return b.value.validateSync(s,{abortEarly:!1}),s}catch(n){return n.inner.map(d=>{d.path+"",d.message,e.setFieldError(d.path,d.message)}),n}});return Z(async()=>{await K()}),(s,e)=>{const n=$("InputText"),d=$("Button");return l(),t("div",ae,[o("div",null,[oe,o("div",se,[(l(!0),t(y,null,g(N.value,(i,k)=>(l(),t("div",{key:k,class:"col-6"},[o("span",ne,[v(n,ee({"onUpdate:modelValue":e[0]||(e[0]=u=>a(f)())},r.value[i.uniqueName],{class:["w-full border-left-3",`${!a(_)[i.uniqueName]&&a(S).touched?"border-green-600":"border-red-600"}`]}),null,16,["class"]),o("label",null,F(i.label),1)]),a(_)[i.uniqueName]?(l(),t("small",ie,F(a(_)[i.uniqueName]),1)):p("",!0)]))),128))])]),ue,(l(!0),t(y,null,g(q.value,(i,k)=>(l(),t("div",{key:k,class:"flex flex-column gap-1"},[(l(!0),t(y,null,g(i.sections,(u,w)=>(l(),t("div",{key:w,class:C(`${w!==0&&"mt-4"}`)},[o("div",null,[o("div",null,[u.sectionLabel?(l(),t("div",de,[o("div",re,F(u.sectionLabel),1)])):p("",!0)]),o("div",ce,[i.controllerMethod.indexOf("@index")>-1?(l(),t("div",me,[u.field_ids.length>0?(l(),T(j,{key:0},{fallback:V(()=>[v(O)]),default:V(()=>[v(a(M),{mode:"edit",source:"Form",fieldIds:u.field_ids,newModuleFields:c.value,moduleValidationInputs:r.value,moduleValidationErrors:a(_),moduleValidationMeta:a(S),onValidateSyncFunc:e[1]||(e[1]=x=>a(f)())},null,8,["fieldIds","newModuleFields","moduleValidationInputs","moduleValidationErrors","moduleValidationMeta"])]),_:2},1024)):p("",!0),u.additional_fields&&u.additional_fields.length>0?(l(),t("div",ve,[(l(!0),t(y,null,g(u.additional_fields,(x,Q)=>(l(),t("div",{key:Q},[x.ids.length>0?(l(),T(j,{key:0},{fallback:V(()=>[v(O)]),default:V(()=>[v(a(M),{mode:"edit",source:"Form",fieldIds:x.ids,newModuleFields:c.value,moduleValidationInputs:r.value,moduleValidationErrors:a(_),moduleValidationMeta:a(S),onValidateSyncFunc:e[2]||(e[2]=ye=>a(f)())},null,8,["fieldIds","newModuleFields","moduleValidationInputs","moduleValidationErrors","moduleValidationMeta"])]),_:2},1024)):p("",!0)]))),128))])):p("",!0)])):p("",!0)])])],2))),128))]))),128)),o("div",{class:C(["sticky bottom-0 right-0 py-2",`${E.tabStyle==="tab"?"mb-7 pb-7 surface-50":"surface-0"}`])},[v(d,{onClick:H,label:"Save"})],2)])}}};export{ke as default};
