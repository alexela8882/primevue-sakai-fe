import{u as g,r as c,s as v,z as y,c as k,o as x,j as T,e as i,f as w,t as P,C as A,_ as M}from"./index-abf1872b.js";import{u as R,U as S}from"./index-212fdf0b.js";const C={class:"flex justify-content-center",style:{height:"60vh !important"}},I={class:"flex flex-column align-items-center justify-content-center text-center mt-n6"},b=i("div",null,"Please wait...",-1),F={__name:"index",setup(E){A(()=>M(()=>import("./mailbox-60cc6751.js"),["assets/mailbox-60cc6751.js","assets/index-abf1872b.js","assets/index-86c8a9da.css","assets/index-212fdf0b.js"]));const d=g(),o=c();c();const s=c(),r=R(),{getMailFolders:p,mailFoldersLoading:j}=v(r),{fetchProfile:m,fetchMailFolders:_}=r,f={auth:{clientId:"393bd73e-ac09-4f31-a723-f4e981a027ce"}},a=new S(f);a.handleRedirectCallback((e,t)=>{});const h=async()=>{s.value="Trying to sign you in";var e={scopes:["user.read","mail.send"]};await a.loginPopup(e).then(t=>{l()}).catch(t=>{})},l=async()=>{if(a.getAccount()){var e={scopes:["user.read","mail.send"]};await a.acquireTokenSilent(e).then(t=>{o.value=t.accessToken,console.log(t.accessToken),u()}).catch(t=>{if(t.name==="InteractionRequiredAuthError")return a.acquireTokenPopup(e).then(n=>{o.value=n.accessToken}).catch(n=>{})})}},u=async()=>{s.value="Redirecting to your inbox",await m(o.value),await _(o.value),p.value.map(e=>{e.displayName==="Inbox"&&d.push(`/outlook-mail/folder/${e.id}`)})};return y(async()=>{await l(),o.value||await h(),u()}),(e,t)=>{const n=k("ProgressSpinner");return x(),T("div",C,[i("div",I,[w(n),i("div",null,P(s.value),1),b])])}}};export{F as default};
