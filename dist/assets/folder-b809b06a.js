import{r as m,J as z,s as O,A as U,z as E,c as v,o as h,d as N,w as x,i as a,f as n,e,t as u,j as k,k as V,n as w,F as q,C as D,_ as G}from"./index-8acd3cd4.js";import{u as J,U as H}from"./index-43ce902f.js";const K={class:"flex flex-column gap-3 m-3"},Q={class:"flex align-items-center justify-content-between"},W={class:"flex align-items-center gap-1"},X=e("div",{class:"text-2xl text-primary font-bold"},"Mailbox",-1),Y={class:"font-bold"},Z={class:"p-input-icon-left w-full"},ee=e("i",{class:"pi pi-search"},null,-1),te={class:"flex align-items-center gap-3 m-3"},se=["onClick"],oe={class:"flex align-items-start justify-content-between gap-6"},le={class:"flex flex-column gap-1"},ae={class:"font-bold"},ne={class:"flex flex-column gap-2"},ie={key:1,class:"p-4 white-space-nowrap overflow-hidden text-overflow-ellipsis"},ce={class:"flex align-items-center gap-3 m-3"},ve={__name:"folder",setup(de){const T=D(()=>G(()=>import("./MailboxMessage-aa250b48.js"),["assets/MailboxMessage-aa250b48.js","assets/index-8acd3cd4.js","assets/index-86c8a9da.css","assets/index-43ce902f.js"])),g=m(),c=m(),f=m(),d=m(),I=z(),M=J(),{mailFolderLoading:L,getMailFolder:i,getMailFolderMessages:_}=O(M),{fetchMailFolder:S,fetchMailFolderMessages:B}=M,F={auth:{clientId:"393bd73e-ac09-4f31-a723-f4e981a027ce"}},p=new H(F);p.handleRedirectCallback((t,s)=>{});const R=async()=>{var t={scopes:["user.read","mail.send"]};await p.loginPopup(t).then(s=>{b()}).catch(s=>{})},P=t=>{console.log(t),f.value=t},b=async()=>{if(p.getAccount()){var t={scopes:["user.read","mail.send"]};await p.acquireTokenSilent(t).then(s=>{d.value=s.accessToken,console.log(s.accessToken),C()}).catch(s=>{if(s.name==="InteractionRequiredAuthError")return p.acquireTokenPopup(t).then(r=>{d.value=r.accessToken}).catch(r=>{})})}},C=async()=>{await S(d.value,I.params.id),await B(d.value,i.value),_.value.value.map((t,s)=>{s===0&&(f.value=t)}),c.value=_.value.value};return U(()=>g.value,(t,s)=>{if(t){let r=_.value.value.filter(l=>{if(l.subject.toLowerCase().indexOf(t)>-1||l.from.emailAddress.name.toLowerCase().indexOf(t)>-1||l.from.emailAddress.address.toLowerCase().indexOf(t)>-1)return l});c.value=r}else c.value=_.value.value}),E(async()=>{await b(),d.value||await R(),C()}),(t,s)=>{const r=v("InputText"),l=v("Button"),y=v("SplitterPanel"),$=v("Splitter"),j=v("BlockUI");return h(),N(j,{blocked:a(L)},{default:x(()=>[n($,{class:"mb-5"},{default:x(()=>[n(y,{class:"flex",size:5},{default:x(()=>[e("div",null,[e("div",null,[e("div",K,[e("div",Q,[e("div",W,[X,e("div",Y,"("+u(a(i).displayName)+")",1)]),e("div",null,[e("i",{onClick:s[0]||(s[0]=o=>b()),class:"cursor-pointer pi pi-refresh"})])]),e("div",null,[e("div",null,[e("span",Z,[ee,n(r,{modelValue:g.value,"onUpdate:modelValue":s[1]||(s[1]=o=>g.value=o),placeholder:"Search",class:"w-full"},null,8,["modelValue"])])])])]),e("div",te,[e("div",null,"1 - 10 of ("+u(a(i).totalItemCount)+")",1),e("div",null,[n(l,{disabled:!a(i).previousLink,icon:"pi pi-chevron-left",text:"",rounded:""},null,8,["disabled"]),n(l,{disabled:!a(i).nextLink,icon:"pi pi-chevron-right",text:"",rounded:""},null,8,["disabled"])])]),e("div",null,[c.value&&c.value.length>0?(h(!0),k(q,{key:0},V(c.value,(o,A)=>(h(),k("div",{key:A,onClick:re=>P(o),class:w(["p-4 cursor-pointer border-1 border-300 border-x-none white-space-nowrap overflow-hidden text-overflow-ellipsis",`${A!==0&&"border-top-none"} ${o.id===f.value.id&&"bg-primary-100"}`])},[e("div",oe,[e("div",le,[e("div",ae,u(o.from.emailAddress.name),1),e("div",{class:w(`${!o.isRead&&"font-bold"}`)},u(o.subject),3)]),e("div",ne,[e("div",{class:w(["text-xs text-700",`${!o.isRead&&"font-bold"}`])},u(o.receivedDateTime),3)])])],10,se))),128)):(h(),k("div",ie," No messages found "))]),e("div",ce,[e("div",null,"1 - 10 of ("+u(a(i).totalItemCount)+")",1),e("div",null,[n(l,{disabled:!a(i).previousLink,icon:"pi pi-chevron-left",text:"",rounded:""},null,8,["disabled"]),n(l,{disabled:!a(i).nextLink,icon:"pi pi-chevron-right",text:"",rounded:""},null,8,["disabled"])])])])])]),_:1}),n(y,{class:"flex",size:75},{default:x(()=>[n(a(T),{token:d.value,message:f.value},null,8,["token","message"])]),_:1})]),_:1})]),_:1},8,["blocked"])}}};export{ve as default};
