import{r as V,v as U,s as E,z as G,A as N,c as x,o as $,j as K,e,f as m,Z as h,i as l,t as u,m as R,n as J,w as k,g as Q,d as I,p as ee}from"./index-65928da5.js";import{u as W,c as X,a as B,b as le}from"./index.esm-1467ba17.js";const te={class:"flex flex-column gap-4"},se={class:"mt-4 flex justify-content-between"},oe={class:"p-float-label"},ie=e("label",null,"Filter name *",-1),ae={class:"p-error text-sm my-2"},ne={key:0,class:"hidden"},re={class:"p-float-label"},de=e("label",null,"View filters",-1),ce={class:"flex align-items-center justify-content-between"},ue={class:"flex align-items-center gap-2"},me={class:"p-float-label"},pe=e("label",null,"Sort field *",-1),be={class:"p-error text-sm my-2"},ve={class:"p-float-label"},ge=e("label",null,"Sort order *",-1),fe={class:"p-error text-sm my-2"},_e={class:"p-float-label"},we=e("label",null,"Items per page *",-1),Ve={class:"p-error text-sm my-2"},ye={class:"flex flex-wrap p-2 align-items-center gap-3"},Fe={class:"flex-1 flex flex-column gap-2"},Se={class:"font-bold"},he={__name:"TableSettings",props:{mode:String,module:Object,selectedViewFilter:String,saveTrigger:Number},setup(t){const i=t,v=V(!1),p=V(null),{values:g,errors:s,defineComponentBinds:r,isSubmitting:L,setFieldValue:f,handleSubmit:D}=W({validationSchema:X({filterName:B().label("Filter name").required(),sortField:B().label("Sort field").required(),sortOrder:B().label("Sort order").required(),perPage:B().label("Items per page").required(),pickList:le().label("Pick list fields").min(1,"Please add at least 1 field").required()})}),d=V(null),a=r("filterName"),y=r("sortField"),T=r("sortOrder"),w=r("perPage");r("pickList");const j=U(),{viewFiltersDialogLoading:M,viewFiltersDialog:Z,viewFilterData:C,perPageItems:q,getBaseModule:H,getDefaultViewFilter:A,getViewFilters:P,getReconstructedViewFilter:n}=E(j),{addViewFilter:z}=j,F=D(o=>{console.log(o),Z.value=!1,z(o)}),O=o=>{f("filterName",o.filterName),f("sortField",o.sortField),f("sortOrder",o.sortOrder);const c=i.module.fields.filter(b=>!o.fields.some(_=>_._id===b._id));p.value=[c,o.fields],f("pickList",o.fields)};return G(()=>{M.value=!1,console.log(i.module.fields),d.value=i.selectedViewFilter,i.mode==="new"?p.value=[i.module.fields,[]]:i.mode==="edit-table"&&O(A.value)}),N(p,(o,c)=>{C.value.data.fields=o[1].map(b=>b._id),v.value&&f("pickList",o[1].map(b=>b._id))}),N(d,(o,c)=>{if(i.mode==="edit-table"){const b=P.value.find(_=>_._id===o);O(n.value(b))}}),N(()=>i.saveTrigger,(o,c)=>{F()}),(o,c)=>{const b=x("InputText"),_=x("Dropdown"),Y=x("PickList");return $(),K("form",te,[e("div",se,[e("div",null,[e("span",oe,[m(b,h(l(a),{class:`${l(s).filterName?"p-invalid":"border-primary"}`,style:{"min-width":"50vh"}}),null,16,["class"]),ie]),e("div",ae,u(l(s).filterName||" "),1)]),t.mode==="edit-table"?($(),K("div",ne,[e("span",re,[m(_,{modelValue:d.value,"onUpdate:modelValue":c[0]||(c[0]=S=>d.value=S),options:l(P),optionLabel:"filterName",optionValue:"_id",class:"w-full md:w-16rem mr-2"},null,8,["modelValue","options"]),de])])):R("",!0)]),e("div",ce,[e("div",ue,[e("div",null,[e("span",me,[m(_,h(l(y),{options:t.module.fields,optionLabel:"label",optionValue:"name",dataKey:"_id",filter:"",placeholder:"Select Field *",class:["w-full md:w-12rem mr-2",`${l(s).sortField?"p-invalid":"border-primary"}`]}),null,16,["options","class"]),pe]),e("div",be,u(l(s).sortField||" "),1)]),e("div",null,[e("span",ve,[m(_,h(l(T),{options:[{label:"Ascending",value:"ASC"},{label:"Descending",value:"DESC"}],optionLabel:"label",optionValue:"value",class:["w-full md:w-12rem mr-2",`${l(s).sortOrder?"p-invalid":"border-primary"}`]}),null,16,["class"]),ge]),e("div",fe,u(l(s).sortOrder||" "),1)])]),e("div",null,[e("span",_e,[m(_,h(l(w),{options:l(q),optionLabel:"label",optionValue:"value",class:["w-full md:w-12rem mr-2",`${l(s).perPage?"p-invalid":"border-primary"}`]}),null,16,["options","class"]),we]),e("div",Ve,u(l(s).perPage||" "),1)])]),e("div",{class:J(["border-1 border-round-md p-4",`${l(s).pickList?"border-red-600":"border-primary"}`])},[e("div",{class:J(["text-sm mb-4",{"p-error":l(s).pickList}])},u(l(s).pickList||"View filter fields"),3),m(Y,{modelValue:p.value,"onUpdate:modelValue":c[1]||(c[1]=S=>p.value=S),onSelectionChange:c[2]||(c[2]=S=>v.value=!0),responsive:"",listStyle:"height:342px",dataKey:"_id"},{sourceheader:k(()=>[Q(" Available Fields ")]),targetheader:k(()=>[Q(" Visible Fields ")]),item:k(S=>[e("div",ye,[e("div",Fe,[e("span",Se,u(S.item.label),1)])])]),_:1},8,["modelValue"])],2)])}}},xe={class:"flex flex-column gap-4"},$e={class:"flex flex-column gap-4 mx-auto mt-6"},ke={class:"p-float-label"},Le=e("label",null,"Summarize By",-1),De={class:"p-error text-sm my-2"},Te={class:"p-float-label"},Be=e("label",null,"Group By *",-1),Ne={class:"p-error text-sm my-2"},Ce={__name:"KanbanSettings",props:{mode:String,module:Object,selectedViewFilter:String,saveTrigger:Number},setup(t){const i=t,v=V(null),{values:p,errors:g,defineComponentBinds:s,isSubmitting:r,setFieldValue:L,handleSubmit:f}=W({validationSchema:X({group_by:B().label("Group By").required()})}),D=s("summarize_by"),d=s("group_by"),a=U(),{viewFiltersDialogLoading:y,viewFiltersDialog:T,viewFilterData:w,perPageItems:j,getBaseModule:M,getDefaultViewFilter:Z,getViewFilters:C,getReconstructedViewFilter:q}=E(a),{addViewFilter:H}=a,A=f(n=>{console.log(n),T.value=!1,H(n)}),P=n=>{console.log(n),L("summarize_by",n.summarize_by),L("group_by",n.group_by)};return G(()=>{y.value=!1,console.log(C.value),v.value=i.selectedViewFilter,console.log(M.value.fields)}),N(v,(n,z)=>{const F=C.value.find(O=>O._id===n);P(q.value(F))}),N(()=>i.saveTrigger,(n,z)=>{A()}),(n,z)=>{const F=x("Dropdown");return $(),K("div",xe,[e("div",$e,[e("div",null,[e("span",ke,[m(F,h(l(D),{options:t.module.fields,optionLabel:"label",optionValue:"name",filter:"",class:["w-full md:w-22rem mr-2",`${l(g).summarize_by?"p-invalid":"border-primary"}`]}),null,16,["options","class"]),Le]),e("div",De,u(l(g).summarize_by||" "),1)]),e("div",null,[e("span",Te,[m(F,h(l(d),{options:t.module.fields,optionLabel:"label",optionValue:"_id",filter:"",class:["w-full md:w-22rem mr-2",`${l(g).group_by?"p-invalid":"border-primary"}`]}),null,16,["options","class"]),Be]),e("div",Ne,u(l(g).group_by||" "),1)])])])}}};const Pe={class:"flex align-items-center text-2xl"},ze={class:"material-icons mr-2"},Oe={class:"flex align-items-center justify-content-end my-2"},qe={__name:"ViewFiltersDialogMain",props:{mode:String,selectedViewFilter:String,module:Object},setup(t){const i=t,v=V(0),p=V(0),g=V(!1),s=U(),{viewFiltersDialog:r,getBaseModule:L,getViewFilters:f}=E(s),D=()=>{i.mode==="new"||i.mode==="edit-table"?v.value++:i.mode==="edit-kanban"&&p.value++};return G(()=>{}),(d,a)=>{const y=x("Button"),T=x("Dialog");return $(),I(T,{visible:l(r),"onUpdate:visible":a[3]||(a[3]=w=>ee(r)?r.value=w:null),modal:"",maximizable:"",style:{width:"70vw"},class:"view-filter-dialog"},{header:k(()=>[e("div",Pe,[e("div",ze,u(t.mode==="edit-table"?"table_chart":"view_kanban"),1),e("div",null,u(t.mode==="edit-table"?"Table":"Kanban")+" Settings — "+u(l(L).label),1)])]),footer:k(()=>[e("div",Oe,[m(y,{onClick:a[2]||(a[2]=w=>r.value=!1),outlined:"",disabled:g.value,label:"Cancel",class:"border-round-3xl py-2 px-4 border-color-primary",size:"small"},null,8,["disabled"]),m(y,{onClick:D,loading:g.value,label:"Save",class:"reddot-primary border-round-3xl py-2 px-4 text-surface-50"},null,8,["loading"])])]),default:k(()=>[t.mode==="new"||t.mode==="edit-table"?($(),I(he,{key:0,mode:t.mode,module:t.module,selectedViewFilter:t.selectedViewFilter,saveTrigger:v.value,onSaveLoading:a[0]||(a[0]=w=>d.saveLoad(d.payload))},null,8,["mode","module","selectedViewFilter","saveTrigger"])):R("",!0),t.mode==="edit-kanban"?($(),I(Ce,{key:1,mode:t.mode,module:t.module,selectedViewFilter:t.selectedViewFilter,saveTrigger:p.value,onSaveLoading:a[1]||(a[1]=w=>d.saveLoad(d.payload))},null,8,["mode","module","selectedViewFilter","saveTrigger"])):R("",!0)]),_:1},8,["visible"])}}};export{qe as default};
