import{_ as Ee,c as h,o as v,j as w,f as a,e as t,I as N,J as $,r,N as Ne,B as $e,K as je,a3 as Ce,U as Be,s as le,E as Oe,G as j,i,t as S,l as Ke,w as m,d as x,m as K,S as C,F as Pe,v as Ae}from"./index-650769bc.js";import{L as ae}from"./ListViewLoader-e7a3e1fc.js";import{D as Re}from"./DataTableLoader-0d735c22.js";const ze={},Ue={class:"flex gap-2"},We={class:"flex flex-column gap-2 w-full"},qe={class:"flex flex-column gap-2 w-full"},Ge={class:"flex flex-column gap-2 w-full"},Je={class:"flex flex-column gap-2 w-full"},He={class:"flex flex-column gap-2 w-full"};function Qe(te,P){const c=h("Skeleton");return v(),w("div",null,[a(c,{height:"3rem",class:"mb-2"}),t("div",Ue,[t("div",We,[a(c,{height:"10rem"}),a(c,{height:"10rem"}),a(c,{height:"10rem"})]),t("div",qe,[a(c,{height:"10rem"})]),t("div",Ge,[a(c,{height:"10rem"}),a(c,{height:"10rem"})]),t("div",Je,[a(c,{height:"10rem"}),a(c,{height:"10rem"}),a(c,{height:"10rem"}),a(c,{height:"10rem"})]),t("div",He,[a(c,{height:"10rem"}),a(c,{height:"10rem"})])])])}const Xe=Ee(ze,[["render",Qe]]),Ye={class:"mt-3"},Ze={key:0,class:"flex align-items-center justify-content-center",style:{height:"60vh !important"}},el={key:1},ll={class:"text-primary-700"},al={key:0,class:"my-4"},tl={class:"flex flex-column md:flex-row justify-content-between mt-3 gap-2"},il={class:"flex align-items-center gap-2"},ol={class:"flex align-items-center gap-2"},sl={key:1,class:"mt-2 mb-4"},nl={class:"md:flex justify-content-between"},ul={class:"w-7"},dl={class:"p-input-icon-right w-full ml-1 md:w-6"},rl=t("i",{class:"pi pi-search"},null,-1),cl={class:"md:flex align-items-center"},ml={class:"p-inputgroup flex-1 mb-2 md:mb-0"},vl={class:"material-icons"},pl=t("div",{class:"text-color-secondary p-2"},"VIEW SETTINGS",-1),_l={class:"flex align-items-center text-color-secondary p-2 cursor-pointer"},bl={class:"material-icons mr-2"},gl=t("div",{class:"text-color-secondary p-2"},"LIST VIEW CONTROLS",-1),fl={class:"flex align-items-center text-color-secondary p-2 cursor-pointer"},hl={class:"material-icons mr-2"},wl={key:0,class:"flex align-items-center justify-content-center",style:{height:"60vh !important"}},yl={key:1},$l={__name:"Show",setup(te){const P=N(()=>$(()=>import("./ViewFiltersDialogMain-59ad0f82.js"),["assets/ViewFiltersDialogMain-59ad0f82.js","assets/index-650769bc.js","assets/index-cb49da02.css","assets/index.esm-285f6695.js","assets/ViewFiltersDialogMain-bbe8a5f0.css"])),c=N(()=>$(()=>import("./ListViewFilterContent-d9b4e274.js"),["assets/ListViewFilterContent-d9b4e274.js","assets/index-650769bc.js","assets/index-cb49da02.css"])),ie=N(()=>$(()=>import("./DynamicDataTableMain-200f1dab.js"),["assets/DynamicDataTableMain-200f1dab.js","assets/index-650769bc.js","assets/index-cb49da02.css","assets/Validate-af95fe20.js","assets/DynamicDataTableMain-5df8962c.css"])),oe=N(()=>$(()=>import("./DynamicKanban-4dd8341e.js"),["assets/DynamicKanban-4dd8341e.js","assets/index-650769bc.js","assets/index-cb49da02.css","assets/DynamicKanban-13545c00.css"])),A=r(0),I=r(null),b=r(!1),F=r(!1),o=r(),g=r("new"),f=r(!1),k=r(0),se=Ne(),u=r({}),y=r(),p=r(),B=r(),R=r(),V=r(),z=$e(),U=je(),ne=Ce(),ue=Be(),{listViewFilterOverlay:xl,viewFiltersDialogLoading:L,viewFiltersDialogSwitch:M,viewFiltersDialog:T,moduleLoading:de,collectionLoading:re,getModule:Fl,getModules:ce,getBaseModule:d,getCollection:Vl,_getViewFilters:me,getViewFilters:Sl,_getDefaultViewFilter:ve,getDefaultViewFilter:kl,_getViewFilterIds:pe,__getViewFilter:W,getViewFilter:Ll,_getSearchFields:_e,_getSearchKeyFieldIds:be}=le(z),{searchModule:ge,_fetchModule:q,fetchModule:Ml,fetchModules:Dl,fetchBaseModule:fe}=z,{getTabs:D}=le(U),{addTab:he,toggleWindows:G,maximizeTab:Il}=U,{setFormReset:we}=ne,J=r(!1),H=r(!1),ye=r([{label:"New",icon:"add",command:e=>{console.log(e),g.value="new",k.value+=1,L.value=!0,M.value=!0,T.value=!0}},{label:"Edit table settings",icon:"table_chart",command:e=>{console.log(e),g.value="edit-table",k.value+=1,L.value=!0,M.value=!0,T.value=!0}},{label:"Edit kanban settings",icon:"view_kanban",command:e=>{console.log(e),g.value="edit-kanban",k.value+=1,L.value=!0,M.value=!0,T.value=!0}}]),xe=r([{label:"Table view",icon:"table_chart",command:e=>{console.log(e),u.value.currentDisplay="table"}},{label:"Kanban view",icon:"view_kanban",disabled:!1,command:e=>{console.log(e),u.value.group_by!==null?u.value.currentDisplay="kanban":(g.value="edit-kanban",k.value+=1,L.value=!0,M.value=!0,T.value=!0)}},{label:"Split view",icon:"vertical_split",disabled:!0,command:e=>{console.log(e)}}]),Q=async e=>{b.value=!0;let l=1;e.jump?l=o.meta&&o.meta.pagination:l=e.event.page+1;let s=Object.assign({},{moduleName:d.value.name,viewFilter:p.value,page:l>1?l:null,limit:e.per_page,search:I.value,searchFields:Y(),reuse:!0});o.value=await q(s),b.value=!1},Fe=async e=>{const l=e.value;await Q({event:e,jump:!0,per_page:l})},Ve=async e=>{let l=Object.assign({},{type:"module-form",style:"window",name:`${e.name}-window-create-form`,label:`${e.label} Form`,_module:e.name,expanded:!1,opened:!1,mode:"modal",opened_order:null});D.value.findIndex((_,Z)=>_.name===l.name)==-1?await he(l,!0):Se(e)},Se=(e,l)=>{ue.require({group:"templating",header:"Unsaved "+e.mainEntity+" Alert",message:e.mainEntity,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-outlined",rejectLabel:"Continue",acceptLabel:"Create New "+e.mainEntity,accept:()=>{let s=D.value.findIndex(_=>_.name===`${e.name}-window-create-form`);we(`${e.name}-window-create-form`),G(D.value[s])},reject:()=>{let s=D.value.findIndex(_=>_.name===`${e.name}-window-create-form`);G(D.value[s])}})},O=async e=>{F.value=!0,b.value=!0,await fe(se.params.id);let l=Object.assign({},{moduleName:d.value.name,viewFilter:p.value&&p.value,page:null,limit:y.value&&y.value.pageSize,reuse:!0});const s=await q(l);o.value=s,A.value=o.value.viewFilters.length,e?u.value=W.value(e,o.value):u.value=ve.value(o.value),y.value=u.value&&u.value,p.value=y.value._id,B.value=Ae(()=>pe.value(o.value)),R.value=_e.value(o.value),V.value=be.value(o.value),F.value=!1,b.value=!1},ke=e=>e.find(s=>s._id===d.value._id),X=()=>{const e=d.value.viewFilters.find(l=>l._id===p.value);y.value=e,p.value=e&&e._id},Le=async()=>{F.value=!0;let e=Object.assign({},{module:d.value.name,search:I.value,viewFilter:p.value,searchFields:Y()});const l=await ge(e);l&&(o.value=l),F.value=!1},Y=()=>{let e=[];return V.value.map(l=>{let s=Object.assign({},{"searchFields[]":l});e.push(s)}),e};return Oe(async()=>{await O(null)}),j(p,async(e,l)=>{X(),await O(e)}),j(B,(e,l)=>{e&&(B.value=e.value)}),j(()=>ce.value,async(e,l)=>{if(A.value!==0){let s=ke(e);g.value==="new"&&(y.value=s.viewFilters[s.viewFilters.length-1],p.value=y.value._id),u.value=W.value(p.value,s)}g.value=null},{deep:!0}),j(()=>g.value,async(e,l)=>{X(),e===null&&await O(p.value)}),(e,l)=>{const s=h("ProgressSpinner"),_=h("Skeleton"),Z=h("Dropdown"),Me=h("MultiSelect"),De=h("InputText"),E=h("Button"),ee=h("Menu");return v(),w(Pe,null,[t("div",Ye,[i(de)?(v(),w("div",Ze,[a(s)])):(v(),w("div",el,[t("h4",ll,S(i(d).label),1),t("div",null,[i(re)?(v(),w("div",al,[t("div",tl,[t("div",il,[a(_,{width:"10rem",height:"2.5rem"}),a(_,{width:"10rem",height:"2.5rem"})]),t("div",ol,[a(_,{width:"10rem",height:"2.5rem"}),a(_,{width:"3rem",height:"2.5rem"}),a(_,{width:"3rem",height:"2.5rem"}),a(_,{width:"3rem",height:"2.5rem"}),a(_,{width:"8rem",height:"2.5rem"})])])])):(v(),w("div",sl,[t("div",nl,[t("div",ul,[a(Z,{modelValue:p.value,"onUpdate:modelValue":l[0]||(l[0]=n=>p.value=n),options:i(me)(o.value),disabled:b.value,optionLabel:"filterName",optionValue:"_id",placeholder:"Select View Filters",class:"border-round-xl border-primary w-full md:w-12rem mr-2 mb-2 md:mb-0"},null,8,["modelValue","options","disabled"]),a(Me,{modelValue:V.value,"onUpdate:modelValue":l[1]||(l[1]=n=>V.value=n),options:R.value,disabled:b.value,filter:"",showToggleAll:!1,optionLabel:"label",optionValue:"_id",dataKey:"_id",placeholder:"Select Fields",class:"border-round-left-xl border-primary w-full md:w-12rem mb-2 md:mb-0"},null,8,["modelValue","options","disabled"]),t("div",dl,[rl,a(De,{onKeypress:l[2]||(l[2]=Ke(n=>Le(),["enter"])),modelValue:I.value,"onUpdate:modelValue":l[3]||(l[3]=n=>I.value=n),type:"text",disabled:b.value||V.value&&V.value.length<=0,class:"border-round-right-xl border-primary w-full mb-2 md:mb-0",placeholder:"Search The List..."},null,8,["modelValue","disabled"])])]),t("div",cl,[t("div",ml,[a(E,{onClick:l[4]||(l[4]=n=>H.value.toggle(n)),disabled:b.value,type:"button","aria-haspopup":"true","aria-controls":"tbl_overlay_menu2",class:"material-icon border-round-md mr-2"},{icon:m(()=>[t("div",vl,S(u.value.currentDisplay===null||u.value.currentDisplay==="table"?"table_chart":"view_kanban"),1)]),_:1},8,["disabled"]),a(ee,{ref_key:"tblMenu2",ref:H,id:"tbl_overlay_menu2",class:"mt-2",model:xe.value,popup:!0},{start:m(()=>[pl]),item:m(({item:n,label:Ie,props:Te})=>[t("div",_l,[t("div",bl,S(n.icon),1),t("div",null,S(n.label),1)])]),_:1},8,["model"]),a(E,{onClick:l[5]||(l[5]=n=>J.value.toggle(n)),loading:i(L),disabled:b.value,type:"button",icon:"pi pi-cog","aria-haspopup":"true","aria-controls":"tbl_overlay_menu",class:"border-round-md mr-2"},null,8,["loading","disabled"]),a(ee,{ref_key:"tblMenu",ref:J,id:"tbl_overlay_menu",class:"mt-2",model:ye.value,popup:!0},{start:m(()=>[gl]),item:m(({item:n,label:Ie,props:Te})=>[t("div",fl,[t("div",hl,S(n.icon),1),t("div",null,S(n.label),1)])]),_:1},8,["model"]),a(E,{onClick:l[6]||(l[6]=n=>f.value=!0),disabled:f.value||b.value,icon:"pi pi-filter","aria-label":"Submit",class:"list-view-filter-btn border-round-md mr-2"},null,8,["disabled"]),i(d).name!="salesquotes"?(v(),x(E,{key:0,class:"border-round-md mr-2",disabled:b.value,icon:"pi pi-plus",onClick:l[7]||(l[7]=n=>Ve(i(d))),label:`New ${i(d).label}`},null,8,["disabled","label"])):K("",!0)])])])]))]),F.value?(v(),w("div",wl,[a(s)])):(v(),w("div",yl,[u.value.currentDisplay===null||u.value.currentDisplay==="table"?(v(),x(C,{key:0},{fallback:m(()=>[a(Re)]),default:m(()=>[(v(),x(i(ie),{key:i(d)._id,mode:"edit",moduleId:i(d)._id,moduleEntityName:i(d).mainEntity,moduleName:i(d).name,moduleLabel:i(d).label,viewFilter:u.value,fields:u.value.fields,data:o.value.data,pagination:o.value.meta&&o.value.meta.pagination,collectionLoading:b.value,sidebar:f.value,onToggleSidebar:l[8]||(l[8]=n=>f.value=!f.value),onPaginate:Q,onLimitPage:Fe},{"list-view-filter":m(()=>[(v(),x(C,null,{fallback:m(()=>[a(ae)]),default:m(()=>[a(i(c),{baseModule:i(d),module:o.value},null,8,["baseModule","module"])]),_:1}))]),_:1},8,["moduleId","moduleEntityName","moduleName","moduleLabel","viewFilter","fields","data","pagination","collectionLoading","sidebar"]))]),_:1})):u.value.currentDisplay==="kanban"?(v(),x(C,{key:1},{fallback:m(()=>[a(Xe)]),default:m(()=>[a(i(oe),{viewFilterId:u.value._id,groupBy:u.value.group_by,summarizeBy:u.value.summarize_by,moduleName:i(d).name,moduleLabel:i(d).label,fields:u.value.fields,module:o.value,data:o.value.data,collectionLoading:F.value,sidebar:f.value,onToggleSidebar:l[9]||(l[9]=n=>f.value=!f.value)},{"list-view-filter":m(()=>[(v(),x(C,null,{fallback:m(()=>[a(ae)]),default:m(()=>[a(i(c),{baseModule:i(d),module:o.value},null,8,["baseModule","module"])]),_:1}))]),_:1},8,["viewFilterId","groupBy","summarizeBy","moduleName","moduleLabel","fields","module","data","collectionLoading","sidebar"])]),_:1})):K("",!0)]))]))]),i(M)?(v(),x(i(P),{key:k.value,mode:g.value,selectedViewFilter:p.value,module:o.value},null,8,["mode","selectedViewFilter","module"])):K("",!0)],64)}}};export{$l as default};
