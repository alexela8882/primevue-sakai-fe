import{r as x,v as O,s as y,A as m,z as S,c as r,o as M,j as w,e as o,f as u,w as I,t as a,i as p,m as R}from"./index-f25c6ab6.js";import{u as q}from"./index-678329c4.js";const E={class:"flex flex-column gap-3 m-4"},T={class:"flex align-items-center"},$=o("label",{class:"ml-2"},"Choose existing",-1),z={class:"flex align-items-center"},U={key:0},F={class:"flex flex-column gap-3 m-4"},L={class:"flex align-items-center"},A=o("label",{class:"ml-2"},"Create new",-1),G={class:"m-4"},H={class:"flex align-items-center justify-content-end my-2 gap-2"},P={__name:"ConvertMailboxMessage",props:{convertModule:Object,mailboxMessage:Object},setup(V){const i=V,l=x(null),s=x(),_=O(),C=q(),{getEntityByName:g,getCollection:D,convertMailboxLoading:c}=y(_),{getMailFolderMessages:k}=y(C),{fetchModule:B,convertMailboxToInquiry:N}=_,f=async()=>{c.value=!1,B(i.convertModule.name)},h=async()=>{const n=g.value(i.convertModule.name);if(s.value==1){const e=Object.assign({},{source_id:"Email",dateRequested:Date.now(),dateResponded:Date.now(),dateResponded:Date.now(),assigned_to_id:l.value.owner_id,description:`This is a test - ${Date.now()}`,type:n.mainEntity,link_id:l.value._id,email_id:i.mailboxMessage.id,conversation_id:i.mailboxMessage.conversationId});await N(e),k.value.value.find(d=>{if(d.id===e.email_id){let v={...d,convertedToInquiry:!0};Object.assign(d,v)}})}};return m(()=>s.value,(n,e)=>{n==2&&(l.value=null)}),m(()=>l.value,(n,e)=>{n&&(s.value=1)}),m(()=>i.convertModule,(n,e)=>{console.log(n),f()}),S(()=>{f(),console.log(g.value(i.convertModule.name))}),(n,e)=>{const d=r("RadioButton"),v=r("Dropdown"),j=r("Divider"),b=r("Button");return M(),w("div",null,[o("div",E,[o("div",T,[u(d,{modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=t=>s.value=t),inputId:"ingredient1",name:"1",value:1,disabled:""},null,8,["modelValue"]),$]),u(v,{modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=t=>l.value=t),options:p(D).data,optionLabel:"owner_id.email",optionvalue:"_id",filter:"",placeholder:"Select",class:"w-full"},{option:I(t=>[o("div",z,[o("div",null,a(t.option.owner_id.email)+" ("+a(t.option.company)+")",1)])]),_:1},8,["modelValue","options"]),l.value?(M(),w("div",U,[o("div",null,a(l.value.firstName)+" "+a(l.value.lastName),1),o("div",null," Owner: "+a(l.value.owner_id.firstName)+" "+a(l.value.owner_id.lastName),1),o("div",null,"Company: "+a(l.value.company),1),o("div",null,"Status: "+a(l.value.status_id),1),o("div",null,"Country: "+a(l.value.country_id.name),1)])):R("",!0)]),u(j),o("div",F,[o("div",L,[u(d,{modelValue:s.value,"onUpdate:modelValue":e[2]||(e[2]=t=>s.value=t),inputId:"ingredient1",name:"2",value:2},null,8,["modelValue"]),A])]),o("div",G,[o("div",H,[u(b,{onClick:e[3]||(e[3]=t=>n.$emit("trigger-dialog")),disabled:p(c),outlined:"",label:"Cancel",class:"border-round-3xl py-2 px-4 border-color-primary",size:"small"},null,8,["disabled"]),u(b,{onClick:e[4]||(e[4]=t=>h()),disabled:!s.value||p(c),label:"Proceed",class:"border-round-3xl py-2 px-4"},null,8,["disabled"])])])])}}};export{P as default};
